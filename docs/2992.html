<html>
<head>
<title>Image Classification with high-level API of Tensorflow 2.x</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">åˆ©ç”¨ Tensorflow 2.x çš„é«˜çº§ API è¿›è¡Œå½±åƒåˆ†ç±»</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/hackernoon/image-classification-with-tensorflow-2-0-d5a98bcffce1#2019-05-12">https://medium.com/hackernoon/image-classification-with-tensorflow-2-0-d5a98bcffce1#2019-05-12</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="ffb2" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">ä¸ä¹‹å‰çš„ç‰ˆæœ¬ä¸åŒï¼Œ<a class="jj jk gr" href="https://medium.com/u/b1d410cb9700# tensorflow implementation of keras</em><br/>import matplotlib.pyplot as plt</span><span id="f15b" class="mi lc hu mx b fv nf nc l nd ne"><em class="kl"># Download dataset with Keras utility function</em></span><span id="857c" class="mi lc hu mx b fv nf nc l nd ne">fashion_mnist = keras.datasets.fashion_mnist<br/>(X_train_full, y_train_full), (X_test, y_test) = fashion_mnist.load_data()</span><span id="1e28" class="mi lc hu mx b fv nf nc l nd ne">print(X_train_full.shape)<br/>(60000, 28, 28)</span></pre><p id="7ece" class="pw-post-body-paragraph jl jm hu jn b jo jp iv jq jr js iy jt ju jv jw jx jy jz ka kb kc kd ke kf kg hn dt translated">å°†æ•°æ®é›†åˆ†æˆè®­ç»ƒé›†ã€éªŒè¯é›†å’Œæµ‹è¯•é›†å§‹ç»ˆæ˜¯ä¸€ä¸ªå¥½çš„åšæ³•ã€‚å› ä¸ºæˆ‘ä»¬å·²ç»æœ‰äº†æµ‹è¯•é›†ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªéªŒè¯é›†ã€‚æˆ‘ä»¬å¯ä»¥å°†æ•°æ®çš„åƒç´ å¼ºåº¦é™¤ä»¥ 255.0ï¼Œä»è€Œå°†å…¶è°ƒæ•´åˆ° 0â€“1 çš„èŒƒå›´å†…ã€‚ç¼©æ”¾å¯¼è‡´æ›´å¥½çš„æ¢¯åº¦æ›´æ–°ã€‚</p><pre class="kq kr ks kt fq mw mx my mz aw na dt"><span id="94ef" class="mi lc hu mx b fv nb nc l nd ne">X_valid, X_train = X_train_full[:5000] / 255.0, X_train_full[5000:] / 255.0</span><span id="d7a6" class="mi lc hu mx b fv nf nc l nd ne">y_valid, y_train = y_train_full[:5000], y_train_full[5000:]</span></pre><p id="cd3e" class="pw-post-body-paragraph jl jm hu jn b jo jp iv jq jr js iy jt ju jv jw jx jy jz ka kb kc kd ke kf kg hn dt translated">æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ matplotlib æŸ¥çœ‹ä»»ä½•ç…§ç‰‡ã€‚</p><pre class="kq kr ks kt fq mw mx my mz aw na dt"><span id="2f7c" class="mi lc hu mx b fv nb nc l nd ne">plt.imshow(X_train[5])</span></pre><figure class="kq kr ks kt fq ku fe ff paragraph-image"><div class="fe ff ng"><img src="../Images/1f01deec51610849ffa91cc3f08b52b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:510/format:webp/1*TWIU4HAXLrYTTFRGUa3DKw.png"/></div></figure><h2 id="439e" class="mi lc hu bd ld mj nh ml lh mm ni mo ll ju nj mq ln jy nk ms lp kc nl mu lr mv dt translated">ä½¿ç”¨ Keras é¡ºåº API åˆ›å»ºæ¨¡å‹</h2><p id="cd95" class="pw-post-body-paragraph jl jm hu jn b jo lt iv jq jr lu iy jt ju lv jw jx jy lw ka kb kc lx ke kf kg hn dt translated">ç°åœ¨æ˜¯æ—¶å€™å»ºç«‹æˆ‘ä»¬ç®€å•çš„å›¾åƒåˆ†ç±»äººå·¥ç¥ç»ç½‘ç»œäº†ã€‚</p><pre class="kq kr ks kt fq mw mx my mz aw na dt"><span id="b7c3" class="mi lc hu mx b fv nb nc l nd ne">model = keras.models.Sequential()<br/>model.add(keras.layers.Flatten(input_shape=[28, 28]))<br/>model.add(keras.layers.Dense(300, activation="relu"))<br/>model.add(keras.layers.Dense(100, activation="relu"))<br/>model.add(keras.layers.Dense(10, activation="softmax"))</span></pre><p id="a694" class="pw-post-body-paragraph jl jm hu jn b jo jp iv jq jr js iy jt ju jv jw jx jy jz ka kb kc kd ke kf kg hn dt translated">å¦‚æœä½ æ²¡æœ‰å¾—åˆ°å®ƒï¼Œé‚£ä¹ˆä¸è¦æ‹…å¿ƒï¼Œè®©æˆ‘ä¸€è¡Œä¸€è¡Œåœ°è§£é‡Šä»£ç ã€‚</p><p id="92b5" class="pw-post-body-paragraph jl jm hu jn b jo jp iv jq jr js iy jt ju jv jw jx jy jz ka kb kc kd ke kf kg hn dt translated"><strong class="jn hv">é¡ºåº</strong>æ¨¡å‹æ˜¯å±‚çš„çº¿æ€§å †æ ˆï¼ŒæŒ‰é¡ºåºè¿æ¥ã€‚</p><p id="ee7a" class="pw-post-body-paragraph jl jm hu jn b jo jp iv jq jr js iy jt ju jv jw jx jy jz ka kb kc kd ke kf kg hn dt translated">ä¸‹ä¸€å±‚ï¼Œå³<strong class="jn hv"> Flatten </strong>åªæ˜¯å°† 28x28 ç»´æ•°ç»„è½¬æ¢æˆ 1D æ•°ç»„ã€‚å¦‚æœå®ƒæ¥æ”¶è¾“å…¥æ•°æ® Xï¼Œé‚£ä¹ˆå®ƒè®¡ç®— X . shape(-1ï¼Œ1)ã€‚å®ƒéœ€è¦ä¸€ä¸ª<strong class="jn hv"> input_shape </strong>å‚æ•°æ¥æŒ‡å®šè¾“å…¥æ•°æ®çš„å¤§å°ã€‚ä½†æ˜¯ï¼ŒKeras å¯ä»¥è‡ªåŠ¨æ£€æµ‹åˆ° input_shapeã€‚</p><p id="53bd" class="pw-post-body-paragraph jl jm hu jn b jo jp iv jq jr js iy jt ju jv jw jx jy jz ka kb kc kd ke kf kg hn dt translated"><strong class="jn hv">å¯†é›†</strong>å±‚æ˜¯ç¥ç»ç½‘ç»œä¸­å…¨è¿æ¥çš„ç¥ç»å…ƒã€‚è¿™é‡Œæœ‰ä¸¤ä¸ªéšå±‚ï¼Œç¬¬ä¸€ä¸ªéšå±‚æœ‰ 300 ä¸ªç¥ç»å…ƒï¼Œç¬¬äºŒä¸ªéšå±‚æœ‰ 100 ä¸ªç¥ç»å…ƒã€‚</p><p id="cd7d" class="pw-post-body-paragraph jl jm hu jn b jo jp iv jq jr js iy jt ju jv jw jx jy jz ka kb kc kd ke kf kg hn dt translated">æœ€åä¸€ä¸ªè‡´å¯†å±‚ç”±è¾“å‡ºå±‚ä¸­çš„ 10 ä¸ªç¥ç»å…ƒç»„æˆã€‚å®ƒè´Ÿè´£è®¡ç®—æŸå¤±å’Œé¢„æµ‹ã€‚</p><h2 id="dd33" class="mi lc hu bd ld mj nh ml lh mm ni mo ll ju nj mq ln jy nk ms lp kc nl mu lr mv dt translated">ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦ç¼–è¯‘æˆ‘ä»¬çš„æ¨¡å‹</h2><p id="5397" class="pw-post-body-paragraph jl jm hu jn b jo lt iv jq jr lu iy jt ju lv jw jx jy lw ka kb kc lx ke kf kg hn dt translated">Keras æœ‰ä¸€ä¸ª compile()æ–¹æ³•ï¼Œå®ƒæŒ‡å®šè¦ä½¿ç”¨çš„æŸå¤±å‡½æ•°ã€ä¼˜åŒ–å™¨å’Œåº¦é‡ã€‚</p><pre class="kq kr ks kt fq mw mx my mz aw na dt"><span id="fa2a" class="mi lc hu mx b fv nb nc l nd ne">model.compile(loss=keras.losses.sparse_categorical_crossentropy,<br/>optimizer="sgd", metrics=["accuracy"])</span></pre><h2 id="1ca3" class="mi lc hu bd ld mj nh ml lh mm ni mo ll ju nj mq ln jy nk ms lp kc nl mu lr mv dt translated">åŸ¹è®­å’Œè¯„ä¼°</h2><p id="bfb7" class="pw-post-body-paragraph jl jm hu jn b jo lt iv jq jr lu iy jt ju lv jw jx jy lw ka kb kc lx ke kf kg hn dt translated">æ¨¡å‹ç¼–è¯‘åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æŒ‡å®šå†å…ƒã€æ‰¹é‡å¤§å°ç­‰æ¥æ‹Ÿåˆ()æ–¹æ³•ã€‚</p><pre class="kq kr ks kt fq mw mx my mz aw na dt"><span id="99bb" class="mi lc hu mx b fv nb nc l nd ne"><em class="kl"># Training model for 30 epochs</em></span><span id="4c10" class="mi lc hu mx b fv nf nc l nd ne">history = model.fit(X_train, y_train,<br/>epochs=30, validation_data=(X_valid, y_valid<em class="kl">))</em></span></pre><p id="7c6e" class="pw-post-body-paragraph jl jm hu jn b jo jp iv jq jr js iy jt ju jv jw jx jy jz ka kb kc kd ke kf kg hn dt translated">è¯¥æ–¹æ³•å°†è®­ç»ƒ 30 ä¸ªæ—¶æœŸçš„æ¨¡å‹ã€‚è®­ç»ƒä¸¢å¤±ã€éªŒè¯ä¸¢å¤±å’Œè®­ç»ƒç²¾åº¦ã€éªŒè¯ç²¾åº¦å¯åœ¨<strong class="jn hv">å†å²ä¸­æ‰¾åˆ°ã€‚</strong></p><p id="41a3" class="pw-post-body-paragraph jl jm hu jn b jo jp iv jq jr js iy jt ju jv jw jx jy jz ka kb kc kd ke kf kg hn dt translated">æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<strong class="jn hv">å†å²</strong>åˆ›å»ºå­¦ä¹ æ›²çº¿çš„å¯è§†åŒ–ã€‚</p><pre class="kq kr ks kt fq mw mx my mz aw na dt"><span id="469c" class="mi lc hu mx b fv nb nc l nd ne">import pandas as pd<br/>pd.DataFrame(history.history).plot(figsize=(8, 5))<br/>plt.grid(True)<br/>plt.gca().set_ylim(0, 1) <em class="kl"># set the vertical range to [0-1]</em><br/>plt.show()</span></pre><figure class="kq kr ks kt fq ku fe ff paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="fe ff nm"><img src="../Images/8d3e19874971acdb1bb5b32ee3f4ab01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CLrZIrYpxK8SIsOqDMBncg.png"/></div></div><figcaption class="nn no fg fe ff np nq bd b be z ek">Source: â€œHands-on Machine Learning with Scikit-Learn, Keras, and TensorFlowâ€</figcaption></figure><p id="1540" class="pw-post-body-paragraph jl jm hu jn b jo jp iv jq jr js iy jt ju jv jw jx jy jz ka kb kc kd ke kf kg hn dt translated">æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒéªŒè¯æ›²çº¿å’Œè®­ç»ƒæ›²çº¿ä¹‹é—´çš„ç©ºé—´å¾ˆå°ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ²¡æœ‰è¿‡åº¦æ‹Ÿåˆçš„é—®é¢˜ã€‚</p><p id="ad6a" class="pw-post-body-paragraph jl jm hu jn b jo jp iv jq jr js iy jt ju jv jw jx jy jz ka kb kc kd ke kf kg hn dt translated">ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•ä¸åŒçš„è¶…å‚æ•°æ¥æé«˜æ•°æ®é›†çš„å‡†ç¡®æ€§ã€‚</p><p id="411b" class="pw-post-body-paragraph jl jm hu jn b jo jp iv jq jr js iy jt ju jv jw jx jy jz ka kb kc kd ke kf kg hn dt translated">å¦‚æœæ‚¨å¯¹è®­ç»ƒå’ŒéªŒè¯çš„å‡†ç¡®æ€§æ„Ÿåˆ°æ»¡æ„ï¼Œé‚£ä¹ˆå°±åœ¨æµ‹è¯•é›†ä¸Šå¯¹å…¶è¿›è¡Œè¯„ä¼°ã€‚</p><pre class="kq kr ks kt fq mw mx my mz aw na dt"><span id="27ec" class="mi lc hu mx b fv nb nc l nd ne">model.evaluate(X_test, Y_test)</span></pre><blockquote class="ki kj kk"><p id="d50d" class="jl jm kl jn b jo jp iv jq jr js iy jt km jv jw jx kn jz ka kb ko kd ke kf kg hn dt translated"><em class="hu">æµ‹è¯•é›†çš„ç²¾åº¦å¯èƒ½ä½äºéªŒè¯é›†ï¼Œå› ä¸ºè¶…å‚æ•°æ˜¯ä¸ºéªŒè¯é›†è°ƒæ•´çš„ã€‚</em></p></blockquote><h2 id="a1af" class="mi lc hu bd ld mj nh ml lh mm ni mo ll ju nj mq ln jy nk ms lp kc nl mu lr mv dt translated">ä¿å­˜è®­ç»ƒå¥½çš„æ¨¡å‹</h2><p id="2729" class="pw-post-body-paragraph jl jm hu jn b jo lt iv jq jr lu iy jt ju lv jw jx jy lw ka kb kc lx ke kf kg hn dt translated">å½“ä½ åœ¨æµ‹è¯•é›†ä¸Šè®­ç»ƒå’Œè¯„ä¼°äº†ä½ çš„ç¥ç»ç½‘ç»œæ¨¡å‹åï¼Œä½ å¯ä»¥ä½¿ç”¨ Keras save()æ–¹æ³•ä¸‹è½½ä½ çš„æ¨¡å‹ï¼Œç„¶åå¯ä»¥éšæ—¶åŠ è½½å®ƒè¿›è¡Œæ¨ç†ã€‚</p><pre class="kq kr ks kt fq mw mx my mz aw na dt"><span id="e7f9" class="mi lc hu mx b fv nb nc l nd ne"># save your model as HDF5 format<br/>model.save("my_keras_model.h5")</span></pre><p id="72fc" class="pw-post-body-paragraph jl jm hu jn b jo jp iv jq jr js iy jt ju jv jw jx jy jz ka kb kc kd ke kf kg hn dt translated">å®ƒä¿å­˜æ¨¡å‹çš„æ¶æ„å’Œæ¯ä¸ªå±‚çš„æ‰€æœ‰æ¨¡å‹å‚æ•°çš„å€¼(æ‰€æœ‰è®­ç»ƒçš„æƒé‡å’Œåå·®)ã€‚</p><p id="bcd2" class="pw-post-body-paragraph jl jm hu jn b jo jp iv jq jr js iy jt ju jv jw jx jy jz ka kb kc kd ke kf kg hn dt translated">å¦‚æœæ‚¨æƒ³ä½¿ç”¨æ‚¨çš„è®­ç»ƒæ¨¡å‹è¿›è¡Œæ¨ç†ï¼Œåªéœ€åŠ è½½å®ƒ:</p><pre class="kq kr ks kt fq mw mx my mz aw na dt"><span id="848f" class="mi lc hu mx b fv nb nc l nd ne">model = keras.models.load_model("my_keras_model.h5")</span></pre><p id="be3f" class="pw-post-body-paragraph jl jm hu jn b jo jp iv jq jr js iy jt ju jv jw jx jy jz ka kb kc kd ke kf kg hn dt translated">ç°åœ¨ï¼Œæ˜¯æ—¶å€™è‡ªå·±è®­ç»ƒä¸åŒçš„æ•°æ®é›†äº†ã€‚ç¥ä½ å¥½è¿ğŸ˜„ï¼</p><p id="d879" class="pw-post-body-paragraph jl jm hu jn b jo jp iv jq jr js iy jt ju jv jw jx jy jz ka kb kc kd ke kf kg hn dt translated"><strong class="jn hv">æ¨è:</strong></p><ol class=""><li id="8483" class="nr ns hu jn b jo jp jr js ju nt jy nu kc nv kg nw nx ny nz dt translated">æ·±åº¦å­¦ä¹ ä¸“ä¸šåŒ–(Coursera)</li><li id="6fe4" class="nr ns hu jn b jo oa jr ob ju oc jy od kc oe kg nw nx ny nz dt translated">ã€Šç”¨ Scikit-Learn å’Œ TensorFlow è¿›è¡Œæœºå™¨å®è·µå­¦ä¹ ã€‹ä½œè€…<a class="jj jk gr" href="https://medium.com/u/c939be75faee?source=post_page-----d5a98bcffce1--------------------------------" rel="noopener" target="_blank"> AurÃ©lien GÃ©ron </a>(ä½œè€… O'Reilly)</li></ol></div><div class="ab cl of og hc oh" role="separator"><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok"/></div><div class="hn ho hp hq hr"><p id="3e5d" class="pw-post-body-paragraph jl jm hu jn b jo jp iv jq jr js iy jt ju jv jw jx jy jz ka kb kc kd ke kf kg hn dt translated"><strong class="jn hv">ä½ å¯ä»¥é€šè¿‡</strong><a class="ae kh" href="http://twitter.com/iamaniketmaurya" rel="noopener ugc nofollow" target="_blank"><strong class="jn hv">ã€twitter.com/aniketmauryaã€‘</strong></a><strong class="jn hv">è”ç³»æˆ‘æˆ–è€…ç•™è¨€å®‰ğŸ“§åœ¨</strong><a class="ae kh" href="http://aniketmaurya@outlook.com" rel="noopener ugc nofollow" target="_blank"><strong class="jn hv">aniketmaurya@outlook.com</strong></a></p></div></div>    
</body>
</html>