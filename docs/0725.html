<html>
<head>
<title>Enforcing Code Quality for Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¼ºåˆ¶ Node.js çš„ä»£ç è´¨é‡</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/hackernoon/enforcing-code-quality-for-node-js-c3b837d7ae17#2019-01-30">https://medium.com/hackernoon/enforcing-code-quality-for-node-js-c3b837d7ae17#2019-01-30</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><div class=""><h2 id="1ad2" class="pw-subtitle-paragraph ir ht hu bd b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji ek translated">ä½¿ç”¨æ—æŒºã€æ ¼å¼åŒ–å’Œå¸¦æœ‰ä»£ç è¦†ç›–çš„å•å…ƒæµ‹è¯•æ¥å®æ–½è´¨é‡æ ‡å‡†</h2></div><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff jj"><img src="../Images/5ff4d2d9fc4b422293c68ff85c8f8090.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5XEyjWDxYydmg7p56n0uqg.png"/></div></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">Licensed from Adobe Stock Photo</figcaption></figure><p id="fdba" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">å¦‚æœä½ è¦ç¼–å†™ä»£ç å¹¶äº¤ä»˜ç”Ÿäº§ï¼Œä»£ç çš„é«˜è´¨é‡æ˜¯å¾ˆé‡è¦çš„ã€‚</p><p id="bc3a" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">åœ¨æˆ‘çš„ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å‘æ‚¨å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ docker-compose æ¥åˆ©ç”¨æ ‡å‡†åŒ–çš„ã€å·²ç»å­˜åœ¨çš„ docker æ–‡ä»¶è¿›è¡Œå¼€å‘ã€‚è®©æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸ºéƒ¨ç½²åšå¥½å‡†å¤‡çš„ä¸‹ä¸€æ­¥æ˜¯ç”Ÿäº§å®ƒã€‚</p><p id="d626" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">æˆ‘å°†ç»§ç»­ä½¿ç”¨æˆ‘ä¹‹å‰æ•™ç¨‹ä¸­çš„ React/Parcel ç¤ºä¾‹:<a class="ae kv" href="https://hackernoon.com/move-over-next-js-and-webpack-ba367f07545" rel="noopener ugc nofollow" target="_blank">ç§»åˆ° Next.js å’Œ Webpack ä¸Šï¼</a></p><p id="72a3" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">ä¸‹é¢æ˜¯æºä»£ç :<a class="ae kv" href="https://github.com/patrickleet/streaming-ssr-react-styled-components" rel="noopener ugc nofollow" target="_blank">https://github . com/Patrick let/streaming-SSR-react-styled-components</a></p><p id="2dd1" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">æˆ‘è¿˜æ²¡æœ‰åšä»»ä½•ä¸è®©åº”ç”¨ç¨‹åºâ€œç”Ÿäº§å°±ç»ªâ€ç›¸å…³çš„äº‹æƒ…ï¼Œæ‰€ä»¥æˆ‘ä¹Ÿå°†è°ˆè°ˆè¿™éœ€è¦ä»€ä¹ˆï¼Œå°½ç®¡è¿™å¯èƒ½éœ€è¦å¦ä¸€ç¯‡æ–‡ç« æ¥å®Œæˆâ€¦æˆ‘ä»¬å°†çœ‹åˆ°å®ƒå¦‚ä½•è¿›è¡Œã€‚æˆ‘æ˜¯å³å…´åˆ›ä½œçš„ã€‚</p><p id="ef8b" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">è®©æˆ‘ä»¬ä»ä¸€äº›è´¨é‡æ§åˆ¶å¼€å§‹ã€‚</p><p id="17a1" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ¢ç´¢æ—æŒºã€æ ¼å¼åŒ–ã€å•å…ƒæµ‹è¯•å’Œä»£ç è¦†ç›–ç‡ï¼Œå¹¶å®æ–½ä¸€äº›è´¨é‡æ ‡å‡†ã€‚</p><h1 id="8a83" class="kw kx hu bd ky kz la lb lc ld le lf lg ja lh jb li jd lj je lk jg ll jh lm ln dt translated">æ—æŒºå’Œæ ¼å¼</h1><p id="401c" class="pw-post-body-paragraph jz ka hu kb b kc lo iv ke kf lp iy kh ki lq kk kl km lr ko kp kq ls ks kt ku hn dt translated">æ ¹æ®ç»´åŸºç™¾ç§‘ï¼Œto " <strong class="kb hv"> Lint </strong>ï¼Œæˆ–<strong class="kb hv"> linter </strong>ï¼Œæ˜¯ä¸€ç§åˆ†ææºä»£ç ä»¥æ ‡è®°ç¼–ç¨‹é”™è¯¯ã€bugã€é£æ ¼é”™è¯¯å’Œå¯ç–‘ç»“æ„çš„å·¥å…·ã€‚</p><p id="29d4" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">è¿™æ„å‘³ç€å®ƒä¼šå¼ºåˆ¶æ‰§è¡Œä¸€äº›äº‹æƒ…ï¼Œæ¯”å¦‚ä½¿ç”¨ç©ºæ ¼è¿˜æ˜¯åˆ¶è¡¨ç¬¦ï¼Œæˆ–è€…ç¡®ä¿æ‚¨çš„ä»£ç ä½¿ç”¨åˆ†å·æ˜¯å¦ä¸€è‡´ã€‚</p><p id="eaca" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">ç›®å‰åœ¨æˆ‘çš„é¡¹ç›®ä¸­å¯èƒ½æœ‰å¾ˆå¤šæ—æŒºé”™è¯¯ã€‚</p><p id="435c" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘çš„ç›®æ ‡æ˜¯æ¼”ç¤ºç‰¹å®šçš„æ¦‚å¿µï¼Œè€Œè¿‡å¤šçš„å…³äºä¸åŒäº‹ç‰©çš„è¾¹æ ç¡®å®ä¼šå½±å“æ‰‹å¤´çš„æ¦‚å¿µã€‚å› æ­¤ï¼Œæˆ‘é€‰æ‹©æ”¾å¼ƒæ—æŒºï¼Œä»¥ä¿æŒå‰å‡ ç¯‡æ–‡ç« çš„é‡ç‚¹ã€‚</p><p id="9272" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">ç°åœ¨æ˜¯æ—¶å€™â€œç”Ÿäº§â€æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºäº†ï¼Œè´¨é‡æ˜¯é‡ä¸­ä¹‹é‡ã€‚</p><p id="1444" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">æˆ‘æ›´å–œæ¬¢çš„ linter æ ¼å¼æ˜¯<a class="ae kv" href="https://standardjs.com/" rel="noopener ugc nofollow" target="_blank"> StandardJS </a>ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„è®¾ç½®ã€‚ä½†æ˜¯åœ¨æˆ‘ä»¬è®¾ç½®å®ƒä¹‹å‰ï¼Œè®©æˆ‘ä»¬ä¹Ÿè®¨è®ºä¸€ä¸‹æ ¼å¼åŒ–ã€‚</p><p id="2486" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated"><strong class="kb hv">æ ¼å¼åŒ–</strong>ç±»ä¼¼äºæ—æŒºï¼Œä½†æ›´å°‘å…³æ³¨è¯­æ³•é”™è¯¯ï¼Œæ›´å¤šå…³æ³¨çš„æ˜¯è®©ä»£ç çœ‹èµ·æ¥æ›´æ¼‚äº®ï¼Œå› æ­¤è¿™ä¸ªæµè¡Œçš„åŒ…è¢«å‘½åä¸º<code class="eh lt lu lv lw b">prettier</code>ã€‚</p><p id="2be2" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">æ„Ÿè°¢ Github ä¸Šå‡ ä¸ªä»¤äººæ•¬ç•çš„å¼€æºè´¡çŒ®è€…ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ªåŒ…ä¸­ä½¿ç”¨å®ƒä»¬ã€‚æ„Ÿè°¢<a class="ae kv" href="http://sheerun.net/" rel="noopener ugc nofollow" target="_blank">äºšå½“Â·æ–¯å¦å‡¯ç»´å¥‡</a>ã€<a class="lx ly gr" href="https://medium.com/u/db72389e89d8?source=post_page-----c3b837d7ae17--------------------------------" rel="noopener" target="_blank">è‚¯ç‰¹Â·cÂ·å¤šå…¹</a>ã€<a class="ae kv" href="https://github.com/agarrharr" rel="noopener ugc nofollow" target="_blank">äºšå½“Â·åŠ å‹’ç‰¹-å“ˆé‡Œæ–¯</a>å’Œ<a class="ae kv" href="https://github.com/BenoitAverty" rel="noopener ugc nofollow" target="_blank">ä¼¯åŠªç“¦Â·é˜¿å¨æ</a>ï¼</p><p id="25a5" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">åœ¨è¿‡å»ï¼Œæˆ‘å†™è¿‡å…³äºä½¿ç”¨ husky æ¥ç¡®ä¿è§„åˆ™åœ¨æ¯æ¬¡æäº¤ä¹‹å‰è¿è¡Œã€‚æ¼‚äº®æ ‡å‡†åŒ…ä¹Ÿå»ºè®®è¿™æ ·åšï¼Œæ‰€ä»¥ç°åœ¨è®©æˆ‘ä»¬æ·»åŠ æ¼‚äº®æ ‡å‡†ã€å¥å£®å’Œ lint-stagedã€‚</p><h2 id="b45e" class="lz kx hu bd ky ma mb mc lc md me mf lg ki mg mh li km mi mj lk kq mk ml lm mm dt translated">é…ç½®æ›´æ¼‚äº®-æ ‡å‡†</h2><p id="e468" class="pw-post-body-paragraph jz ka hu kb b kc lo iv ke kf lp iy kh ki lq kk kl km lr ko kp kq ls ks kt ku hn dt translated">é¦–å…ˆå®‰è£…æ‰€éœ€çš„è½¯ä»¶åŒ…:</p><pre class="jk jl jm jn fq mn lw mo mp aw mq dt"><span id="3fe3" class="lz kx hu lw b fv mr ms l mt mu">npm i --save-dev prettier-standard husky lint-staged</span></pre><p id="7d1d" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">åœ¨<strong class="kb hv"> package.json </strong>ä¸­æ·»åŠ ä»¥ä¸‹â€œæ ¼å¼â€è„šæœ¬å’Œæ–°çš„â€œlint-stagedâ€å’Œâ€œhuskyâ€éƒ¨åˆ†:</p><pre class="jk jl jm jn fq mn lw mo mp aw mq dt"><span id="8536" class="lz kx hu lw b fv mr ms l mt mu">{<br/>  //...<br/>  "scripts": {<br/>    // ...<br/>    <strong class="lw hv">"format": "prettier-standard 'app/**/*.js' 'app/**/*.jsx' 'server/**/*.js'"<br/>  },<br/>  "lint-staged": {<br/>    "linters": {<br/>      "**/*.js": [<br/>        "prettier-standard",<br/>        "git add"<br/>      ],<br/>      "**/*.jsx": [<br/>        "prettier-standard",<br/>        "git add"<br/>      ]<br/>    }<br/>  },</strong><br/>  // ...<br/>}</span></pre><p id="6ac3" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">æˆ‘æ— æ³•è®© RegExp å·¥ä½œï¼Œæ‰€ä»¥åœ¨æ²¡æœ‰æŸ¥çœ‹æºä»£ç çš„æƒ…å†µä¸‹ï¼Œæˆ‘å‡è®¾å®ƒä½¿ç”¨çš„æ˜¯ glob è€Œä¸æ˜¯ RegExpã€‚</p><p id="0464" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">ç°åœ¨ä½ å¯ä»¥è¿è¡Œ<code class="eh lt lu lv lw b">npm run format</code>æ¥æ ¼å¼åŒ–ä½ çš„ä»£ç å¹¶æ£€æŸ¥æ—æŒºé”™è¯¯ã€‚æ­¤å¤–ï¼Œæ¯å½“æ‚¨å°è¯•æäº¤æ—¶ï¼Œå°†è°ƒç”¨ husky çš„<code class="eh lt lu lv lw b">pre-commit</code>æŒ‚é’©ï¼Œè¿™å°†ç¡®ä¿ä»»ä½•æš‚å­˜æ–‡ä»¶(<code class="eh lt lu lv lw b">git add</code>æš‚å­˜æ–‡ä»¶)åœ¨å…è®¸æäº¤ä¹‹å‰è¢«æ­£ç¡®åœ°é“¾æ¥ã€‚</p><p id="df3b" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">è®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ç¬¬ä¸€éåšå¾—æ€ä¹ˆæ ·ã€‚</p><pre class="jk jl jm jn fq mn lw mo mp aw mq dt"><span id="751f" class="lz kx hu lw b fv mr ms l mt mu">âœ  npm run format</span><span id="2a08" class="lz kx hu lw b fv mv ms l mt mu">&gt; stream-all-the-things@1.0.0 format /Users/patrick.scottgroup1001.com/dev/patrickleet/open-source-metarepo/stream-all-the-things<br/>&gt; prettier-standard 'app/**/*.js' 'app/**/*.jsx' 'server/**/*.js'</span><span id="1273" class="lz kx hu lw b fv mv ms l mt mu">app/client.js 52ms<br/>app/imported.js 11ms<br/>app/styles.js 7ms<br/>app/App.jsx 11ms<br/>app/components/Header.jsx 76ms<br/>app/components/Page.jsx 7ms<br/>app/pages/About.jsx 6ms<br/>app/pages/Error.jsx 5ms<br/>app/pages/Home.jsx 6ms<br/>app/pages/Loading.jsx 6ms<br/>server/index.js 8ms<br/>server/lib/client.js 11ms<br/>server/lib/ssr.js 17ms</span></pre><p id="b8e8" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">åŸºæœ¬ä¸Šæ¯ä¸ªæ–‡ä»¶é™¤äº†<code class="eh lt lu lv lw b">styles.js</code>éƒ½æœ‰æ—æŒºé”™è¯¯æˆ–è€…çœ‹èµ·æ¥ä¸å¤Ÿæ¼‚äº®ï¼</p><h2 id="03e1" class="lz kx hu bd ky ma mb mc lc md me mf lg ki mg mh li km mi mj lk kq mk ml lm mm dt translated">å¿½ç•¥æ–‡ä»¶çš„æ—æŒºå’Œæ ¼å¼</h2><p id="60e1" class="pw-post-body-paragraph jz ka hu kb b kc lo iv ke kf lp iy kh ki lq kk kl km lr ko kp kq ls ks kt ku hn dt translated">æœ‰ä¸€ä¸ªå°é—®é¢˜æ˜¯è¿™ä¸ªé¡¹ç›®ç‰¹æœ‰çš„â€”â€”<code class="eh lt lu lv lw b">app/imported.js</code>æ˜¯ä¸€ä¸ªç”Ÿæˆçš„æ–‡ä»¶ï¼Œlinter åº”è¯¥å¿½ç•¥å®ƒã€‚</p><p id="1ac9" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">è™½ç„¶ is åœ¨æ–‡ä»¶é¡¶ç«¯æœ‰<code class="eh lt lu lv lw b">eslint-disabled</code>ï¼Œä½†æ˜¯ prettier ä¸çŸ¥é“æ‰§è¡Œæ—æŒºè§„åˆ™ã€‚åˆ«æ‹…å¿ƒï¼Œè®©æˆ‘ä»¬æ’¤é”€å¯¹è¯¥æ–‡ä»¶çš„æ›´æ”¹ï¼Œç„¶ååˆ›å»ºä¸€ä¸ª<code class="eh lt lu lv lw b">.prettierignore</code>æ–‡ä»¶å’Œä¸€ä¸ª<code class="eh lt lu lv lw b">.eslintignore</code>æ–‡ä»¶ï¼Œä»¥ä¾¿åœ¨ä»¥åçš„è¿è¡Œä¸­æ˜¾å¼å¿½ç•¥è¯¥æ–‡ä»¶çš„æ ¼å¼åŒ–ã€‚</p><pre class="jk jl jm jn fq mn lw mo mp aw mq dt"><span id="c350" class="lz kx hu lw b fv mr ms l mt mu">git checkout -- ./app/imported.js</span></pre><p id="0979" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">å°†æ’¤æ¶ˆå¯¹è¯¥æ–‡ä»¶çš„æ›´æ”¹ã€‚</p><p id="0bee" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">ç°åœ¨ç”¨ä¸‹é¢çš„ä»£ç è¡Œåˆ›å»º<code class="eh lt lu lv lw b">.prettierignore</code>å’Œ<code class="eh lt lu lv lw b">.eslintignore</code>:</p><pre class="jk jl jm jn fq mn lw mo mp aw mq dt"><span id="1cae" class="lz kx hu lw b fv mr ms l mt mu">app/imported.js<br/>dist<br/>coverage<br/>node_modules</span></pre><p id="f852" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">ç°åœ¨å½“è¿è¡Œ<code class="eh lt lu lv lw b">npm run format</code>æ—¶ï¼Œæ–‡ä»¶<code class="eh lt lu lv lw b">app/imported.js</code>ä¿æŒä¸å˜ã€‚ç”±äºæ–‡ä»¶æ˜¯ç”Ÿæˆçš„ï¼Œä¸è§£å†³è¿™ä¸ªé—®é¢˜å¯èƒ½ä¼šæœ‰é—®é¢˜ã€‚</p><p id="9d0b" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">æœ€åï¼Œæˆ‘æåˆ°æäº¤ä¹Ÿåº”è¯¥ä½œä¸ºä¸€ä¸ª<code class="eh lt lu lv lw b">pre-commit</code>é’©å­è¿è¡Œ<code class="eh lt lu lv lw b">npm run format</code>ã€‚è®©æˆ‘ä»¬è¯•ä¸€è¯•ã€‚</p><pre class="jk jl jm jn fq mn lw mo mp aw mq dt"><span id="9bb2" class="lz kx hu lw b fv mr ms l mt mu">âœ  git commit -m 'feat: prettier-standard'<br/>husky &gt; pre-commit (node v11.6.0)<br/>  â†“ Stashing changes... [skipped]<br/>    â†’ No partially staged files found...<br/>  âœ” Running linters...</span></pre><p id="ca3b" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">ä¸‹é¢æ˜¯ Github ä¸Šçš„æäº¤ã€‚</p><h1 id="1fa9" class="kw kx hu bd ky kz la lb lc ld le lf lg ja lh jb li jd lj je lk jg ll jh lm ln dt translated">å•å…ƒæµ‹è¯•å’Œä»£ç è¦†ç›–ç‡</h1><p id="ef6f" class="pw-post-body-paragraph jz ka hu kb b kc lo iv ke kf lp iy kh ki lq kk kl km lr ko kp kq ls ks kt ku hn dt translated">ä½œä¸ºç”Ÿäº§æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºçš„ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬çœŸçš„åº”è¯¥ç¡®ä¿æˆ‘ä»¬çš„ä»£ç æ˜¯ç»è¿‡å……åˆ†æµ‹è¯•çš„ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œä½ åº”è¯¥è¿™æ ·åšï¼Œä½†æˆ‘æ˜¯ä¸€ä¸ªåäººï¼Œåœ¨è¿™ä¸ªé¡¹ç›®ä¸­å¿½ç•¥äº†è¿™ä¸€ç‚¹ã€‚</p><p id="df93" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">è®©æˆ‘ä»¬è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><h2 id="71c6" class="lz kx hu bd ky ma mb mc lc md me mf lg ki mg mh li km mi mj lk kq mk ml lm mm dt translated">å®‰è£…å’Œé…ç½® Jest</h2><p id="3155" class="pw-post-body-paragraph jz ka hu kb b kc lo iv ke kf lp iy kh ki lq kk kl km lr ko kp kq ls ks kt ku hn dt translated">é¦–å…ˆï¼Œè®©æˆ‘ä»¬å®‰è£… Jest æ¥ç¼–å†™å•å…ƒæµ‹è¯•ã€‚</p><pre class="jk jl jm jn fq mn lw mo mp aw mq dt"><span id="34e3" class="lz kx hu lw b fv mr ms l mt mu">npm i --save-dev jest babel-jest</span></pre><p id="6c81" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬æ·»åŠ ä¸€ä¸ª jest é…ç½®æ–‡ä»¶ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é…ç½® jest æ¥çŸ¥é“åœ¨å“ªé‡Œå¯ä»¥æ‰¾åˆ°æˆ‘ä»¬çš„æ–‡ä»¶ï¼Œå¹¶ä¸”èƒ½å¤Ÿä½¿ç”¨æ¼‚äº®çš„è·¯å¾„ã€‚</p><p id="2b36" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">æ·»åŠ ä»¥ä¸‹<code class="eh lt lu lv lw b">jest.json</code>æ–‡ä»¶:</p><pre class="jk jl jm jn fq mn lw mo mp aw mq dt"><span id="d038" class="lz kx hu lw b fv mr ms l mt mu">{<br/>  "roots": ["&lt;rootDir&gt;/__tests__/unit"],<br/>  "modulePaths": [<br/>    "&lt;rootDir&gt;",<br/>    "/node_modules/"<br/>  ],<br/>  "moduleFileExtensions": [<br/>    "js",<br/>    "jsx"<br/>  ],<br/>  "transform": {<br/>    "^.+\\.jsx?$": "babel-jest"<br/>  },<br/>  "<!-- -->transformIgnorePatterns": <!-- -->["/node_modules/"],<br/>  "coverageThreshold": {<br/>    "global": {<br/>      "branches": 10,<br/>      "functions": 10,<br/>      "lines": 10,<br/>      "statements": 10<br/>    }<br/>  },<br/>  "collectCoverage": true,<br/>  "collectCoverageFrom" : [<br/>    "**/*.{js,jsx}"<br/>  ]<br/>}</span></pre><p id="2a07" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">å¥½å§ï¼Œè®©æˆ‘ä»¬æ‰“å¼€å®ƒã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å°†<code class="eh lt lu lv lw b">roots</code>è®¾ç½®ä¸º<code class="eh lt lu lv lw b">&lt;rootDir&gt;/__tests__/unit</code>ã€‚æˆ‘å–œæ¬¢å°†é˜¶æ®µæµ‹è¯•æ”¾åœ¨<code class="eh lt lu lv lw b">__tests__/staging</code>ä¸­ï¼Œæ‰€ä»¥å°†æ ¹è®¾ç½®ä¸º<code class="eh lt lu lv lw b">__tests__/unit</code>å°†å…è®¸æˆ‘ä»¥åè¿™æ ·åšã€‚</p><p id="6934" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†<code class="eh lt lu lv lw b">modulePaths</code>è®¾ç½®ä¸ºæ ¹ç›®å½•ï¼Œå¹¶å°†<code class="eh lt lu lv lw b">node_modules</code>è®¾ç½®ä¸ºã€‚è¿™æ ·ï¼Œåœ¨æˆ‘ä»¬çš„æµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åªå¯¼å…¥<code class="eh lt lu lv lw b">app/*</code>æˆ–<code class="eh lt lu lv lw b">server/*</code>ï¼Œè€Œä¸æ˜¯ä½¿ç”¨åƒ<code class="eh lt lu lv lw b">../../</code>è¿™æ ·çš„ç›¸å¯¹è·¯å¾„ã€‚</p><p id="c13f" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">æ¥ä¸‹æ¥çš„ä¸¤ä¸ªé”®å‘Šè¯‰ jest ä½¿ç”¨ babel æ¥åŠ è½½æˆ‘ä»¬çš„æ–‡ä»¶ï¼Œè¿™æ ·åƒ<code class="eh lt lu lv lw b">import</code>è¿™æ ·çš„ä¸œè¥¿å°±å¯ä»¥æ­£å¸¸å·¥ä½œäº†ã€‚</p><p id="0c70" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">æœ€åï¼Œæœ€åä¸‰ä¸ªéƒ¨åˆ†å®šä¹‰äº†è¦†ç›–ç‡è®¾ç½®â€”â€”æœ€ä½é˜ˆå€¼ï¼Œéƒ½æ˜¯ 10%,ä»¥åŠä»å“ªé‡Œæ”¶é›†è¦†ç›–ç‡ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘çš„ç›®æ ‡åªæ˜¯é…ç½®å¥½å„ä¸ªéƒ¨åˆ†ã€‚åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†æŠŠè¦†ç›–ç‡é˜ˆå€¼å¢åŠ åˆ° 100%,å¹¶é€æ­¥å®Œæˆè¿™ä¸ªè¿‡ç¨‹ã€‚</p><p id="4ff2" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">ä¸ºäº†è¿è¡Œï¼Œæˆ‘ä»¬å¯ä»¥åœ¨<code class="eh lt lu lv lw b">package.json</code>çš„è„šæœ¬éƒ¨åˆ†å®šä¹‰ä¸€ä¸ª<code class="eh lt lu lv lw b">test</code>è„šæœ¬ã€‚å› ä¸ºæˆ‘ä»¬æ­£åœ¨ä½¿ç”¨ babel-jestï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿéœ€è¦æä¾›ä¸€äº› babel è®¾ç½®ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†<code class="eh lt lu lv lw b">BABEL_ENV</code>è®¾ç½®ä¸º<code class="eh lt lu lv lw b">test</code>ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹ä¸€èŠ‚ä¸­è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><pre class="jk jl jm jn fq mn lw mo mp aw mq dt"><span id="3e24" class="lz kx hu lw b fv mr ms l mt mu">"scripts": {<br/>  // ...<br/>  <strong class="lw hv">"test": "cross-env BABEL_ENV=test jest --config jest.json",<br/>  "test:watch": "cross-env BABEL_ENV=test jest --config jest.json --watch"</strong><br/>}</span></pre><h2 id="75a1" class="lz kx hu bd ky ma mb mc lc md me mf lg ki mg mh li km mi mj lk kq mk ml lm mm dt translated">ç”¨å·´åˆ«å¡”é…ç½® Jest</h2><p id="5068" class="pw-post-body-paragraph jz ka hu kb b kc lo iv ke kf lp iy kh ki lq kk kl km lr ko kp kq ls ks kt ku hn dt translated">é¦–å…ˆï¼Œä¸ºäº†è®©æµ‹è¯•å·¥ä½œï¼Œæˆ‘ä»¬éœ€è¦é…ç½®ä¸€äº›å·´åˆ«å¡”è®¾ç½®ã€‚åœ¨æ‚¨çš„<code class="eh lt lu lv lw b">.babelrc</code>æ–‡ä»¶çš„<code class="eh lt lu lv lw b">env</code>é”®ä¸­æ·»åŠ ä»¥ä¸‹éƒ¨åˆ†:</p><pre class="jk jl jm jn fq mn lw mo mp aw mq dt"><span id="dfe9" class="lz kx hu lw b fv mr ms l mt mu">{<br/>  "env": {<br/>    <strong class="lw hv">"test": {<br/>      "presets":[<br/>        ["@babel/preset-env"],<br/>        ["@babel/preset-react"],<br/>      ],<br/>      "plugins": [<br/>        ["@babel/plugin-syntax-dynamic-import"]<br/>      ]<br/>    },</strong><br/>    // ...<br/>  }<br/>}</span></pre><p id="da50" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">è®©æˆ‘ä»¬å®‰è£…æˆ‘ä»¬æåˆ°çš„æ’ä»¶å’Œé¢„ç½®:</p><pre class="jk jl jm jn fq mn lw mo mp aw mq dt"><span id="938a" class="lz kx hu lw b fv mr ms l mt mu">npm i --save-dev @babel/core @babel/preset-env @babel/preset-react @babel/plugin-syntax-dynamic-import babel-jest</span></pre><p id="c5f2" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">æˆ‘ä»¬ç›®å‰çš„è¦†ç›–ç‡ä¸º 0%ï¼Œè®©æˆ‘ä»¬ä¸ºåº”ç”¨ç¨‹åºæ·»åŠ ä¸€ä¸ªæµ‹è¯•ï¼Œå¹¶ä¸ºæœåŠ¡å™¨æ·»åŠ ä¸€ä¸ªæµ‹è¯•ï¼Œè¿™å°†ä½¿æˆ‘ä»¬è¶…è¿‡ 10%çš„ä½é˜ˆå€¼ã€‚</p><h2 id="a273" class="lz kx hu bd ky ma mb mc lc md me mf lg ki mg mh li km mi mj lk kq mk ml lm mm dt translated">ç”¨ Enzyme æµ‹è¯•å®¢æˆ·ç«¯åº”ç”¨</h2><p id="f125" class="pw-post-body-paragraph jz ka hu kb b kc lo iv ke kf lp iy kh ki lq kk kl km lr ko kp kq ls ks kt ku hn dt translated">é¦–å…ˆï¼Œæˆ‘ä»¬æ¥æµ‹è¯•ä¸€ä¸‹<code class="eh lt lu lv lw b">app</code>ä¸­çš„ä¸€ä¸ªæ–‡ä»¶ã€‚æˆ‘ä»¬å°†å¸Œæœ›åœ¨åº”ç”¨ç¨‹åºä¸­æµ…å±‚æ¸²æŸ“æˆ‘ä»¬çš„ç»„ä»¶æ¥æµ‹è¯•å®ƒä»¬ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨<code class="eh lt lu lv lw b">enzyme</code>ã€‚</p><pre class="jk jl jm jn fq mn lw mo mp aw mq dt"><span id="c163" class="lz kx hu lw b fv mr ms l mt mu">npm i --save-dev enzyme <!-- -->enzyme-adapter-react-16</span></pre><p id="3b1a" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">Enzyme æœ‰ä¸€ä¸ªè®¾ç½®æ­¥éª¤ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨æµ‹è¯•ä¸­ä½¿ç”¨å®ƒä¹‹å‰æ·»åŠ è¿™ä¸ªæ­¥éª¤ã€‚åœ¨æˆ‘ä»¬çš„<code class="eh lt lu lv lw b">jest.json</code>æ–‡ä»¶ä¸­ï¼Œæ·»åŠ ä¸€ä¸ªæ–°çš„é”®:</p><pre class="jk jl jm jn fq mn lw mo mp aw mq dt"><span id="96c5" class="lz kx hu lw b fv mr ms l mt mu">{<br/>//other settings<br/>"setupTestFrameworkScriptFile": "&lt;rootDir&gt;/__tests__/setup.js"<br/>}</span></pre><p id="93fa" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">ä»¥åŠ<code class="eh lt lu lv lw b">__tests__/unit/setup.js</code>å¤„çš„è®¾ç½®æ–‡ä»¶:</p><pre class="jk jl jm jn fq mn lw mo mp aw mq dt"><span id="1886" class="lz kx hu lw b fv mr ms l mt mu">import { configure } from 'enzyme';<br/>import Adapter from 'enzyme-adapter-react-16';</span><span id="1513" class="lz kx hu lw b fv mv ms l mt mu">configure({ adapter: new Adapter() });</span></pre><p id="0f67" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">ç°åœ¨é…ç½®å¥½é…¶ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»º<code class="eh lt lu lv lw b">__tests__/unit/app/pages/Home.jsx</code>:</p><pre class="jk jl jm jn fq mn lw mo mp aw mq dt"><span id="9904" class="lz kx hu lw b fv mr ms l mt mu">import React from 'react'<br/>import { shallow } from 'enzyme'<br/>import Home from 'app/pages/Home.jsx'</span><span id="b17a" class="lz kx hu lw b fv mv ms l mt mu">describe('app/pages/Home.jsx', () =&gt; {<br/>  it('renders style component', () =&gt; {<br/>    expect(Home).toBeDefined()<br/>    const tree = shallow(&lt;Home /&gt;)<br/>    expect(tree.find('Page')).toBeDefined()<br/>    expect(tree.find('Helmet').find('title').text()).toEqual('Home Page')<br/>    expect(tree.find('div').text()).toEqual('Follow me at <a class="ae kv" href="http://twitter.com/patrickleet" rel="noopener ugc nofollow" target="_blank">@patrickleet</a>')<br/>    expect(tree.find('div').find('a').text()).toEqual('<a class="ae kv" href="http://twitter.com/patrickleet" rel="noopener ugc nofollow" target="_blank">@patrickleet</a>')<br/>  })<br/>})</span></pre><p id="e8cd" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">ä¼¼ä¹æˆ‘ä»¬çš„ç»„ä»¶åªæ˜¯ä¸€ä¸ªå•ä¸€çš„åŠŸèƒ½ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬éœ€è¦è¾¾åˆ°è¿™ä¸ªæ–‡ä»¶ 100%çš„è¦†ç›–ç‡ã€‚</p><h2 id="ba98" class="lz kx hu bd ky ma mb mc lc md me mf lg ki mg mh li km mi mj lk kq mk ml lm mm dt translated">æœåŠ¡å™¨ç«¯æµ‹è¯•</h2><p id="6217" class="pw-post-body-paragraph jz ka hu kb b kc lo iv ke kf lp iy kh ki lq kk kl km lr ko kp kq ls ks kt ku hn dt translated">ä¸ºäº†æ›´å¥½åœ°è¡¡é‡ï¼Œè®©æˆ‘ä»¬ä¹Ÿåˆ›å»ºä¸€ä¸ªæœåŠ¡å™¨ç«¯æµ‹è¯•ã€‚</p><p id="af11" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">æˆ‘æƒ³æµ‹è¯•<code class="eh lt lu lv lw b">server/index.js</code>ï¼Œä½†åœ¨æ­¤ä¹‹å‰ï¼Œæœ‰å‡ ä¸ªé‡æ„ä¼šè®©æˆ‘ä»¬çš„ç”Ÿæ´»å˜å¾—ç¨å¾®è½»æ¾ä¸€äº›ã€‚</p><p id="a123" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">å•å…ƒæµ‹è¯•æ„å‘³ç€æµ‹è¯•å•ä¸ªå•å…ƒã€‚è¿™æ„å‘³ç€å³ä½¿æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä½¿ç”¨ expressï¼Œæˆ‘ä»¬ä¹Ÿä¸ä¼šåœ¨å•å…ƒæµ‹è¯•ä¸­æµ‹è¯• expressã€‚æˆ‘ä»¬æ­£åœ¨æµ‹è¯•æˆ‘ä»¬çš„æœåŠ¡å™¨æ˜¯å¦é…ç½®äº†é€‚å½“çš„è·¯ç”±ã€ä¸­é—´ä»¶ï¼Œä»¥åŠæ˜¯å¦è°ƒç”¨äº† listen æ¥å¯åŠ¨æœåŠ¡å™¨ã€‚express çš„å•å…ƒæµ‹è¯•å±äº express é¡¹ç›®ã€‚</p><p id="b52b" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">ä¸ºäº†åªæµ‹è¯•æˆ‘ä»¬å…³å¿ƒçš„å•ä¸ªå•å…ƒï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ mocking æ¥åˆ›å»ºè½»é‡çº§æ¥å£ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code class="eh lt lu lv lw b">jest.mock</code>æ¥è·Ÿè¸ªè¿™äº›æ¥å£ã€‚å¦‚æœæˆ‘ä»¬å°†æœåŠ¡å™¨å®ä¾‹ä»ç´¢å¼•ä¸­æå–åˆ°å®ƒè‡ªå·±çš„æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å°†èƒ½å¤Ÿæ›´å®¹æ˜“åœ°æ¨¡æ‹ŸæœåŠ¡å™¨ã€‚</p><p id="961c" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">åˆ›å»ºåŒ…å«ä»¥ä¸‹å†…å®¹çš„æ–‡ä»¶<code class="eh lt lu lv lw b">server/lib/server.js</code>:</p><pre class="jk jl jm jn fq mn lw mo mp aw mq dt"><span id="ebd7" class="lz kx hu lw b fv mr ms l mt mu">import express from 'express'</span><span id="e761" class="lz kx hu lw b fv mv ms l mt mu">export const server = express()<br/>export const serveStatic = express.static</span></pre><p id="deff" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">è¿˜æœ‰æ›´æ–°<code class="eh lt lu lv lw b">server/index.js</code>åƒè¿™æ ·:</p><pre class="jk jl jm jn fq mn lw mo mp aw mq dt"><span id="83ce" class="lz kx hu lw b fv mr ms l mt mu">import path from 'path'<br/>import log from 'llog'<br/><strong class="lw hv">import { server, serveStatic } from './lib/server'</strong><br/>import ssr from './lib/ssr'</span><span id="6720" class="lz kx hu lw b fv mv ms l mt mu">// Expose the public directory as /dist and point to the browser version<br/><strong class="lw hv">server</strong>.use(<br/>  '/dist/client',<br/>  <strong class="lw hv">serveStatic</strong>(path.resolve(process.cwd(), 'dist', 'client'))<br/>)</span><span id="ef52" class="lz kx hu lw b fv mv ms l mt mu">// Anything unresolved is serving the application and let<br/>// react-router do the routing!<br/><strong class="lw hv">server</strong>.get('/*', ssr)</span><span id="8448" class="lz kx hu lw b fv mv ms l mt mu">// Check for PORT environment variable, otherwise fallback on Parcel default port<br/>const port = process.env.PORT || 1234<br/><strong class="lw hv">server</strong>.listen(port, () =&gt; {<br/>  log.info(`Listening on port ${port}...`)<br/>})</span></pre><p id="4726" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">ç°åœ¨åœ¨æˆ‘ä»¬çš„æµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°æ¨¡ä»¿<code class="eh lt lu lv lw b">server/lib/server.js</code>ï¼Œè€Œä¸æ˜¯æ›´å¤æ‚çš„æ¨¡ä»¿<code class="eh lt lu lv lw b">express</code>ã€‚</p><p id="959b" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">è®©æˆ‘ä»¬åœ¨<code class="eh lt lu lv lw b">__tests__/unit/server/index.js</code>åˆ›å»ºæµ‹è¯•:</p><pre class="jk jl jm jn fq mn lw mo mp aw mq dt"><span id="bc81" class="lz kx hu lw b fv mr ms l mt mu">import 'server/index'</span><span id="f09d" class="lz kx hu lw b fv mv ms l mt mu">jest.mock('llog')<br/>jest.mock('server/lib/server', () =&gt; ({<br/>  server: {<br/>    use: jest.fn(),<br/>    get: jest.fn(),<br/>    listen: jest.fn()<br/>  },<br/>  serveStatic: jest.fn(() =&gt; "static/path")<br/>}))<br/>jest.mock('server/lib/ssr')</span><span id="73c1" class="lz kx hu lw b fv mv ms l mt mu">describe('server/index.js', () =&gt; {<br/>  it('main', () =&gt; {<br/>    const { server, serveStatic } = require('server/lib/server')<br/>    expect(server.use).toBeCalledWith('/dist/client', "static/path")<br/>   expect(serveStatic).toBeCalledWith(`${process.cwd()}/dist/client`)<br/>    expect(server.get).toBeCalledWith('/*', expect.any(Function))<br/>    expect(server.listen).toBeCalledWith(1234, expect.any(Function))<br/>  })<br/>})</span></pre><p id="6828" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">å¦‚æœæˆ‘ä»¬ç°åœ¨è¿è¡Œè¦†ç›–ç‡ï¼Œæˆ‘ä»¬ä¼šæ³¨æ„åˆ°<code class="eh lt lu lv lw b">server/index.js</code>çš„è¦†ç›–ç‡ä¸æ˜¯ 100%ã€‚æˆ‘ä»¬æœ‰ä¸€ä¸ªåŒ¿åå‡½æ•°ä¼ é€’ç»™ listenï¼Œè¿™ä¸ªå‡½æ•°å¾ˆéš¾è·å–ã€‚è¿™éœ€è¦ä¸€äº›å°çš„é‡æ„ã€‚</p><p id="7984" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">é‡æ„ listen è°ƒç”¨ä»¥æå–åŒ¿åå‡½æ•°ã€‚</p><pre class="jk jl jm jn fq mn lw mo mp aw mq dt"><span id="9ddf" class="lz kx hu lw b fv mr ms l mt mu">export const onListen = port =&gt; () =&gt; {<br/>  log.info(`Listening on port ${port}...`)<br/>}<br/>server.listen(port, onListen(port))</span></pre><p id="3323" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">ç°åœ¨æˆ‘ä»¬å¯ä»¥è½»æ¾æµ‹è¯•<code class="eh lt lu lv lw b">onListen</code>ã€‚</p><p id="f8e7" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">è®©æˆ‘ä»¬å‘æˆ‘ä»¬çš„<code class="eh lt lu lv lw b">server/index.js</code>å¥—ä»¶æ·»åŠ å¦ä¸€ä¸ªæµ‹è¯•æ¥è§£é‡Šå®ƒã€‚</p><pre class="jk jl jm jn fq mn lw mo mp aw mq dt"><span id="435f" class="lz kx hu lw b fv mr ms l mt mu">import <strong class="lw hv">{ onListen } from</strong> 'server/index'</span><span id="bd7d" class="lz kx hu lw b fv mv ms l mt mu">// ...</span><span id="55c4" class="lz kx hu lw b fv mv ms l mt mu">describe('server/index.js', () =&gt; {<br/>  // ...</span><span id="1c87" class="lz kx hu lw b fv mv ms l mt mu">  <strong class="lw hv">it('onListen', () =&gt; {<br/>    const log = require('llog')<br/>    onListen(4000)()<br/>    expect(log.info).toBeCalledWith('Listening on port 4000...')<br/>  })</strong><br/>})</span></pre><p id="6b05" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">æœ‰äº†è¿™äº›ï¼Œæˆ‘ä»¬å¯¹<code class="eh lt lu lv lw b">server/index.js</code>å’Œ<code class="eh lt lu lv lw b">app/pages/Home.jsx</code>æœ‰äº† 100%çš„è¦†ç›–ç‡ã€‚</p><p id="866f" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">é€šè¿‡æˆ‘ä»¬çš„ä¸¤æ¬¡æµ‹è¯•ï¼Œæˆ‘ä»¬æˆåŠŸåœ°å°†è¦†ç›–ç‡ä» 0%æé«˜åˆ°äº† 35â€“60 %,å…·ä½“å–å†³äºæŒ‡æ ‡:</p><figure class="jk jl jm jn fq jo fe ff paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="fe ff mw"><img src="../Images/3cfbc388146493889934249dc2ff7ec6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pmYql5L1HioeQLtb6gW9VA.png"/></div></div><figcaption class="jv jw fg fe ff jx jy bd b be z ek">Current Coverage</figcaption></figure><h2 id="bb82" class="lz kx hu bd ky ma mb mc lc md me mf lg ki mg mh li km mi mj lk kq mk ml lm mm dt translated">å‘é¢„æäº¤æŒ‚é’©æ·»åŠ æµ‹è¯•</h2><p id="d888" class="pw-post-body-paragraph jz ka hu kb b kc lo iv ke kf lp iy kh ki lq kk kl km lr ko kp kq ls ks kt ku hn dt translated">æœ€åï¼Œæˆ‘ä»¬åªå¸Œæœ›ç¡®ä¿æµ‹è¯•ä½œä¸ºä¸€ä¸ªé¢„æäº¤æŒ‚é’©ï¼Œä»¥é˜²æ­¢ä¸­æ–­çš„æµ‹è¯•è¿›å…¥ä»£ç ï¼Œä»¥åŠä»¥åä»»ä½•æœªæµ‹è¯•çš„ä»£ç ã€‚</p><p id="a626" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">åœ¨<code class="eh lt lu lv lw b">package.json</code>ä¸­ï¼Œå°†<code class="eh lt lu lv lw b">pre-commit</code>æ”¹ä¸º:</p><pre class="jk jl jm jn fq mn lw mo mp aw mq dt"><span id="b40e" class="lz kx hu lw b fv mr ms l mt mu">"pre-commit": "lint-staged &amp;&amp; npm run test"</span></pre><p id="2606" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">ç°åœ¨ï¼Œå½“æœ‰äººè¯•å›¾æäº¤é¡¹ç›®æ—¶ï¼Œå®ƒå°†å¼ºåˆ¶æ‰§è¡Œ Jest é…ç½®ä¸­å®šä¹‰çš„è¦†ç›–æ ‡å‡†ï¼Œå¹¶ç¡®ä¿æ‰€æœ‰æµ‹è¯•éƒ½é€šè¿‡ï¼</p><h1 id="12c0" class="kw kx hu bd ky kz la lb lc ld le lf lg ja lh jb li jd lj je lk jg ll jh lm ln dt translated">ç»“è®º</h1><p id="770d" class="pw-post-body-paragraph jz ka hu kb b kc lo iv ke kf lp iy kh ki lq kk kl km lr ko kp kq ls ks kt ku hn dt translated">å½“æ‚¨çš„åº”ç”¨ç¨‹åºç”Ÿäº§å‡†å¤‡å°±ç»ªæ—¶ï¼Œä»¥è‡ªåŠ¨åŒ–çš„æ–¹å¼æ‰§è¡Œè´¨é‡æ ‡å‡†æ˜¯éå¸¸å¿…è¦çš„ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å‘æ‚¨å±•ç¤ºäº†å¦‚ä½•è®¾ç½®å’Œé…ç½®æ—æŒºå·¥å…·å’Œæ ¼å¼åŒ–æ‚¨çš„ä»£ç ï¼Œä»¥åŠå¦‚ä½•é…ç½®æ‚¨çš„é¡¹ç›®ï¼Œä»¥ä¾¿ä½¿ç”¨ enzyme å’Œ jest è¿›è¡Œæµ‹è¯•å’Œå¼ºåˆ¶ä»£ç è¦†ç›–ã€‚</p><p id="1350" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">åœ¨ä¸‹ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†åœ¨ç»§ç»­åˆ›å»ºç”Ÿäº§å°±ç»ª Dockerfile æ–‡ä»¶ä¹‹å‰å°†è¦†ç›–ç‡æé«˜åˆ° 100%ã€‚</p><p id="0220" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">å’Œå¾€å¸¸ä¸€æ ·ï¼Œå¦‚æœä½ è§‰å¾—è¿™å¾ˆæœ‰å¸®åŠ©ï¼Œè¯·ç‚¹å‡»å¹¶æŒ‰ä½æ‹æ‰‹æŒ‰é’®ï¼Œæœ€å¤šæ‹ 50 æ¬¡ï¼Œè·Ÿæˆ‘æ¥ï¼Œå¹¶ä¸ä»–äººåˆ†äº«ï¼</p><p id="8db7" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">æœ€å¥½ï¼Œ<br/> <a class="ae kv" href="https://twitter.com/pat_scott" rel="noopener ugc nofollow" target="_blank">æé›…è¾¾Â·æ–¯ç§‘ç‰¹</a></p></div><div class="ab cl mx my hc mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="hn ho hp hq hr"><p id="0075" class="pw-post-body-paragraph jz ka hu kb b kc kd iv ke kf kg iy kh ki kj kk kl km kn ko kp kq kr ks kt ku hn dt translated">æŸ¥çœ‹æœ¬ç³»åˆ—çš„å…¶ä»–æ–‡ç« ï¼è¿™æ˜¯ç¬¬ä¸‰éƒ¨åˆ†ã€‚</p><div class="ne nf fm fo ng nh"><a href="https://hackernoon.com/move-over-next-js-and-webpack-ba367f07545" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab ej"><div class="nj ab nk cl cj nl"><h2 class="bd hv fv z el nm eo ep nn er et ht dt translated">ç¬¬ 1 éƒ¨åˆ†:è®¨è®º Next.js å’Œ WebpackğŸ¤¯</h2><div class="no l"><h3 class="bd b fv z el nm eo ep nn er et ek translated">ç®€å•æµæœåŠ¡å™¨ç«¯æ¸²æŸ“(SSR)ååº”+æ ·å¼-ç»„ä»¶ä¸åŒ…è£¹</h3></div><div class="np l"><p class="bd b gc z el nm eo ep nn er et ek translated">hackernoon.com</p></div></div><div class="nq l"><div class="nr l ns nt nu nq nv jt nh"/></div></div></a></div><div class="ne nf fm fo ng nh"><a href="https://hackernoon.com/a-better-way-to-develop-node-js-with-docker-cd29d3a0093" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab ej"><div class="nj ab nk cl cj nl"><h2 class="bd hv fv z el nm eo ep nn er et ht dt translated">ç¬¬ 2 éƒ¨åˆ†:ç”¨ Docker å¼€å‘ Node.js çš„æ›´å¥½æ–¹æ³•</h2><div class="no l"><h3 class="bd b fv z el nm eo ep nn er et ek translated">å¹¶ä¿æŒæ‚¨çš„çƒ­ä»£ç é‡è½½</h3></div><div class="np l"><p class="bd b gc z el nm eo ep nn er et ek translated">hackernoon.com</p></div></div><div class="nq l"><div class="nw l ns nt nu nq nv jt nh"/></div></div></a></div><div class="ne nf fm fo ng nh"><a href="https://hackernoon.com/the-100-code-coverage-myth-900b83d20d3d" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab ej"><div class="nj ab nk cl cj nl"><h2 class="bd hv fv z el nm eo ep nn er et ht dt translated">ç¬¬ 4 éƒ¨åˆ†:100%ä»£ç è¦†ç›–ç‡çš„ç¥è¯</h2><div class="no l"><h3 class="bd b fv z el nm eo ep nn er et ek translated">ç°åœ¨äº’è”ç½‘ä¸Šæœ‰å¾ˆå¤šå»ºè®®è¯´ 100%çš„è¦†ç›–ç‡ä¸æ˜¯ä¸€ä¸ªæœ‰ä»·å€¼çš„ç›®æ ‡ã€‚æ˜¯å—ï¼Ÿ</h3></div><div class="np l"><p class="bd b gc z el nm eo ep nn er et ek translated">hackernoon.com</p></div></div><div class="nq l"><div class="nx l ns nt nu nq nv jt nh"/></div></div></a></div><div class="ne nf fm fo ng nh"><a href="https://hackernoon.com/a-tale-of-two-docker-multi-stage-build-layers-85348a409c84" rel="noopener  ugc nofollow" target="_blank"><div class="ni ab ej"><div class="nj ab nk cl cj nl"><h2 class="bd hv fv z el nm eo ep nn er et ht dt translated">ç¬¬ 5 éƒ¨åˆ†:ä¸¤å±‚(Docker å¤šé˜¶æ®µæ„å»º)çš„æ•…äº‹</h2><div class="no l"><h3 class="bd b fv z el nm eo ep nn er et ek translated">Node.js çš„ç”Ÿäº§å°±ç»ª docker æ–‡ä»¶</h3></div><div class="np l"><p class="bd b gc z el nm eo ep nn er et ek translated">hackernoon.com</p></div></div><div class="nq l"><div class="ny l ns nt nu nq nv jt nh"/></div></div></a></div></div></div>    
</body>
</html>