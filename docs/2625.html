<html>
<head>
<title>How to Cache Bust a React App?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">å¦‚ä½•ç¼“å­˜ä¸€ä¸ªReactåº”ç”¨ï¼Ÿ</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/hackernoon/how-to-cache-bust-a-react-app-6775081e09cc?source=collection_archive---------22-----------------------#2019-04-24">https://medium.com/hackernoon/how-to-cache-bust-a-react-app-6775081e09cc?source=collection_archive---------22-----------------------#2019-04-24</a></blockquote><div><div class="ef hi hj hk hl hm"/><div class="hn ho hp hq hr"><div class=""/><p id="4647" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">è¿™ç¯‡æ–‡ç« ä¹Ÿäº¤å‰å‘è¡¨åœ¨-</p><p id="7120" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">å¼€å‘â€” <a class="ae jp" href="https://dev.to/flexdinesh/cache-busting-a-react-app-22lk" rel="noopener ugc nofollow" target="_blank">ç¼“å­˜ç ´åååº”åº”ç”¨</a></p><p id="0dfb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv"><em class="jq">TLï¼›DR</em></strong><em class="jq">â€”</em><a class="ae jp" href="https://docs.npmjs.com/about-semantic-versioning" rel="noopener ugc nofollow" target="_blank"><em class="jq">SEM ver</em></a><em class="jq">æ‚¨çš„åº”ç”¨ç¨‹åºï¼Œå¹¶åœ¨æ¯ä¸ªæ„å»ºä¸Šç”Ÿæˆä¸€ä¸ªä¸ä¼šè¢«æµè§ˆå™¨ç¼“å­˜çš„</em> <code class="eh jr js jt ju b"><em class="jq">meta.json</em></code> <em class="jq">æ–‡ä»¶ã€‚å½“ç‰ˆæœ¬ä¸åŒ¹é…æ—¶ï¼Œä½¿ç¼“å­˜æ— æ•ˆå¹¶ç¡¬é‡æ–°åŠ è½½åº”ç”¨ç¨‹åºã€‚</em> <strong class="it hv"> <em class="jq">æ³¨æ„:æœ¬å¸–ä¸­çš„ä¾‹å­å’Œè§£é‡Šéƒ½æ˜¯åŸºäºReactçš„ã€‚ä½†æ˜¯è¿™ä¸ªç­–ç•¥å°†é€‚ç”¨äºä»»ä½•webåº”ç”¨ç¨‹åº/æ¡†æ¶ã€‚</em> </strong></p><p id="9f91" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">å°½ç®¡ç¼“å­˜å¾ˆæ£’ï¼Œä½†ç¼“å­˜å¤±æ•ˆå·²ç»æ˜¯ä¸€ä¸ªé•¿æœŸçš„é—®é¢˜äº†ã€‚<strong class="it hv">ä½¿æµè§ˆå™¨<strong class="it hv">ä¸­åŠ è½½çš„ç½‘ç»œåº”ç”¨çš„<strong class="it hv">ç¼“å­˜</strong>å¤±æ•ˆæ˜¯å¾ˆéš¾çš„</strong>ã€‚ä½†æ˜¯<strong class="it hv">ä½¿</strong>ä¿å­˜åˆ°<strong class="it hv">ä¸»å±å¹•</strong>çš„ç½‘ç»œåº”ç”¨çš„<strong class="it hv">ç¼“å­˜</strong>å¤±æ•ˆ<strong class="it hv">æ›´åŠ å›°éš¾</strong>ã€‚</strong></p><p id="f0b9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">ç¼“å­˜çš„å¿«é€Ÿä»‹ç»-</p><p id="1c54" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">æœåŠ¡å™¨ç¼“å­˜:</strong> WebæœåŠ¡å™¨åœ¨ç¬¬ä¸€æ¬¡è¯·æ±‚èµ„æºæ—¶ç¼“å­˜èµ„æºã€‚ç¬¬äºŒæ¬¡ä»¥åï¼Œèµ„æºç”±æœåŠ¡å™¨ç¼“å­˜æä¾›ã€‚é™¤æ­¤ä¹‹å¤–è¿˜æœ‰å¾ˆå¤šâ€”â€”CDNã€æºæœåŠ¡å™¨ã€è¾¹ç¼˜æœåŠ¡å™¨ç­‰ï¼Œä½†æˆ‘ä»¬ä¸ä¼šä¸€ä¸€ä»‹ç»ã€‚ä½¿æœåŠ¡å™¨ç¼“å­˜å¤±æ•ˆéå¸¸ç®€å•ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥æ§åˆ¶æˆ‘ä»¬çš„æœåŠ¡å™¨ï¼Œå¹¶ä¸”åœ¨æ¯æ¬¡æ–°éƒ¨ç½²æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªåŠ¨æˆ–æ‰‹åŠ¨æ¸…é™¤æ—§ç¼“å­˜ã€‚</p><p id="ac54" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><strong class="it hv">æµè§ˆå™¨ç¼“å­˜:</strong>æµè§ˆå™¨ä¹Ÿä»¥è‡ªå·±çš„æ–¹å¼ç¼“å­˜èµ„æºã€‚å½“ä¸€ä¸ªç«™ç‚¹ç¬¬ä¸€æ¬¡è¢«åŠ è½½åˆ°ç”¨æˆ·çš„æµè§ˆå™¨ä¸­æ—¶ï¼Œæµè§ˆå™¨å†³å®šåœ¨æœ¬åœ°ç¼“å­˜ä¸€äº›èµ„æº(ä¸»è¦æ˜¯å›¾åƒã€jså’Œcssç­‰èµ„äº§),ä¸‹æ¬¡ç”¨æˆ·è®¿é—®åŒä¸€ä¸ªç«™ç‚¹æ—¶ï¼Œæµè§ˆå™¨ä»æœ¬åœ°ç¼“å­˜ä¸­æä¾›èµ„æºã€‚ç”±äºæˆ‘ä»¬æ— æ³•æ§åˆ¶ç”¨æˆ·çš„æµè§ˆå™¨ï¼Œæ‰€ä»¥åœ¨è¿‡å»æ¸…é™¤ç”¨æˆ·æµè§ˆå™¨ä¸­çš„ç¼“å­˜ä¸€ç›´æœ‰ç‚¹å›°éš¾ã€‚æœ‰äº†ç¼“å­˜å¤´å’Œåƒwebpackè¿™æ ·çš„æ„å»ºå·¥å…·ï¼Œæ¯æ¬¡æ„å»ºéƒ½ä¼šç”Ÿæˆç‹¬ç‰¹çš„å—ï¼Œè¿™å°±å˜å¾—æ›´å®¹æ˜“ç®¡ç†äº†ï¼Œä½†æ˜¯ä»ç„¶å­˜åœ¨ç¼ºé™·ã€‚</p><p id="40b1" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">ä»¥ä¸‹æ˜¯æµè§ˆå™¨ç¼“å­˜çš„ä¸€äº›é—®é¢˜-</p><ol class=""><li id="c8b3" class="jv jw hu it b iu iv iy iz jc jx jg jy jk jz jo ka kb kc kd dt translated"><strong class="it hv">æµè§ˆå™¨</strong>å€¾å‘äº<strong class="it hv">å¿½ç•¥ç¼“å­˜éªŒè¯</strong>å¦‚æœç«™ç‚¹åœ¨<strong class="it hv">åŒä¸€ä¸ªæ ‡ç­¾</strong>ä¸­è¢«åˆ·æ–°â€”â€”å¦‚æœç”¨æˆ·é”å®šæ ‡ç­¾ï¼Œå³ä½¿æœåŠ¡å™¨ç¼“å­˜è¢«æ¸…é™¤ï¼Œç«™ç‚¹ä¹Ÿå¾ˆæœ‰å¯èƒ½ä»æµè§ˆå™¨ç¼“å­˜ä¸­è¢«åŠ è½½ã€‚</li><li id="d646" class="jv jw hu it b iu ke iy kf jc kg jg kh jk ki jo ka kb kc kd dt translated">å¦‚æœä½ çš„åº”ç”¨ç¨‹åºæ­£åœ¨æ³¨å†Œä¸€ä¸ª<strong class="it hv">æœåŠ¡å·¥ä½œè€…</strong>ï¼Œé‚£ä¹ˆæœåŠ¡å·¥ä½œè€…<strong class="it hv">ç¼“å­˜</strong>å°†<strong class="it hv">å¤±æ•ˆ</strong>ï¼Œé™¤éç”¨æˆ·åœ¨<strong class="it hv">æ–°æ ‡ç­¾</strong>ä¸­æ‰“å¼€ç«™ç‚¹ã€‚å¦‚æœè¯¥é€‰é¡¹å¡ä»æœªå…³é—­ï¼Œç”¨æˆ·å°†æ°¸è¿œæ— æ³•ä½¿ç”¨æœåŠ¡å·¥ä½œäººå‘˜ç¼“å­˜ã€‚</li><li id="e981" class="jv jw hu it b iu ke iy kf jc kg jg kh jk ki jo ka kb kc kd dt translated">å¦‚æœç”¨æˆ·<strong class="it hv">å°†</strong>ç«™ç‚¹æ·»åŠ åˆ°æ‰‹æœº/å¹³æ¿ç”µè„‘çš„<strong class="it hv">ä¸»å±å¹•</strong>ï¼Œé‚£ä¹ˆåªæœ‰å½“ç”¨æˆ·æ˜ç¡®<strong class="it hv">é€€å‡ºåº”ç”¨</strong>æ—¶ï¼Œæµè§ˆå™¨<strong class="it hv">ç¼“å­˜</strong>æ‰ä¼š<strong class="it hv">å¤±æ•ˆ</strong>â€”â€”è¿™å‡ ä¹ç­‰åŒäºåœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ç›¸åŒçš„æ ‡ç­¾é¡µã€‚æˆ‘çŸ¥é“æœ‰äº›äººå‡ ä¸ªæœˆéƒ½ä¸ä¼šé€€å‡ºä»–ä»¬çš„ä¸»å±å¹•åº”ç”¨ç¨‹åºã€‚</li></ol><p id="76c3" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">ç†æƒ³æƒ…å†µä¸‹ï¼Œç¼“å­˜æœ‰åŠ©äºæ›´å¿«åœ°åŠ è½½ç½‘ç«™ã€‚ç¦ç”¨ç¼“å­˜ä¸æ˜¯ç­”æ¡ˆã€‚å®ƒä¹Ÿä¸å¯é ï¼Œå› ä¸ºä½ ä¸èƒ½æ§åˆ¶ç”¨æˆ·æµè§ˆå™¨çš„è¡Œä¸ºã€‚æˆ‘ä»¬å¸Œæœ›æ‰¾åˆ°ä¸€ç§æ–¹æ³•ï¼Œåœ¨æ¯æ¬¡æ–°ç‰ˆæœ¬çš„åº”ç”¨éƒ¨ç½²åˆ°æœåŠ¡å™¨æ—¶ï¼Œæ¸…é™¤æµè§ˆå™¨æˆ–æœåŠ¡äººå‘˜ç¼“å­˜ã€‚</p><p id="8523" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">ç®€å•è€Œæœ‰æ•ˆçš„æ–¹æ³•</p><ul class=""><li id="412b" class="jv jw hu it b iu iv iy iz jc jx jg jy jk jz jo kj kb kc kd dt translated">æ°¸è¿œä¸è¦éƒ¨ç½²</li><li id="25a2" class="jv jw hu it b iu ke iy kf jc kg jg kh jk ki jo kj kb kc kd dt translated">å°†åº”ç”¨ç‰ˆæœ¬æ†ç»‘åˆ°åº”ç”¨ä¸­</li><li id="711f" class="jv jw hu it b iu ke iy kf jc kg jg kh jk ki jo kj kb kc kd dt translated">ç”Ÿæˆä¸€ä¸ªåŒ…å«æ¯æ¬¡æ„å»ºçš„åº”ç”¨ç‰ˆæœ¬çš„<code class="eh jr js jt ju b">meta.json</code>æ–‡ä»¶</li><li id="a675" class="jv jw hu it b iu ke iy kf jc kg jg kh jk ki jo kj kb kc kd dt translated">åŠ è½½æ—¶è·å–<code class="eh jr js jt ju b">meta.json</code>å¹¶æ¯”è¾ƒç‰ˆæœ¬</li><li id="6a2d" class="jv jw hu it b iu ke iy kf jc kg jg kh jk ki jo kj kb kc kd dt translated">å½“ç‰ˆæœ¬ä¸åŒ¹é…æ—¶ï¼Œå¼ºåˆ¶æ¸…é™¤ç¼“å­˜å¹¶ç¡¬é‡æ–°åŠ è½½</li></ul><h1 id="953c" class="kk kl hu bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh dt translated">æ°¸è¿œä¸è¦éƒ¨ç½²</h1><p id="efa8" class="pw-post-body-paragraph ir is hu it b iu li iw ix iy lj ja jb jc lk je jf jg ll ji jj jk lm jm jn jo hn dt translated">ç”¨<a class="ae jp" href="https://docs.npmjs.com/about-semantic-versioning" rel="noopener ugc nofollow" target="_blank">æ°¸è¿œä¸è¦ç”¨</a>ç»™ä½ æ‰€æœ‰çš„éƒ¨ç½²ç‰ˆæœ¬ã€‚æˆ‘ä¸ªäººä½¿ç”¨è¿™ä¸‰ä¸ªnpmå‘½ä»¤æ¥è‡ªåŠ¨å¢åŠ åŒ…çš„ç‰ˆæœ¬ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªgit commitå’Œä¸€ä¸ªç›¸åº”çš„ç‰ˆæœ¬æ ‡ç­¾ã€‚</p><ul class=""><li id="752f" class="jv jw hu it b iu iv iy iz jc jx jg jy jk jz jo kj kb kc kd dt translated"><code class="eh jr js jt ju b">npm version patch</code> - <em class="jq">å¯¹äºä»…ä¿®å¤äº†é”™è¯¯çš„ç‰ˆæœ¬</em></li><li id="3352" class="jv jw hu it b iu ke iy kf jc kg jg kh jk ki jo kj kb kc kd dt translated"><code class="eh jr js jt ju b">npm version minor</code> - <em class="jq">é’ˆå¯¹å…·æœ‰æ–°åŠŸèƒ½ä¸”æœªä¿®å¤é”™è¯¯çš„ç‰ˆæœ¬</em></li><li id="5c8b" class="jv jw hu it b iu ke iy kf jc kg jg kh jk ki jo kj kb kc kd dt translated"><code class="eh jr js jt ju b">npm version major</code> - <em class="jq">ä¸»è¦ç‰ˆæœ¬æˆ–çªç ´æ€§åŠŸèƒ½</em></li></ul><p id="5ffc" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">è®°å¾—ç”¨<code class="eh jr js jt ju b">--tag</code>å±æ€§- <code class="eh jr js jt ju b">git push origin master --tags</code>æ¨é€æäº¤</p><h1 id="6f6e" class="kk kl hu bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh dt translated">å°†åº”ç”¨ç‰ˆæœ¬æ†ç»‘åˆ°åº”ç”¨ä¸­</h1><p id="8c93" class="pw-post-body-paragraph ir is hu it b iu li iw ix iy lj ja jb jc lk je jf jg ll ji jj jk lm jm jn jo hn dt translated">åœ¨webpackæ„å»º(æˆ–ç›¸å…³æ„å»ºå·¥å…·)æœŸé—´è§£æåŒ…ç‰ˆæœ¬ï¼Œå¹¶åœ¨åº”ç”¨ç¨‹åºä¸­è®¾ç½®ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œä»¥ä¾¿æ‚¨å¯ä»¥åœ¨æµè§ˆå™¨æ§åˆ¶å°ä¸­æ–¹ä¾¿åœ°æ£€æŸ¥ç‰ˆæœ¬ï¼Œå¹¶ä½¿ç”¨å®ƒä¸æœ€æ–°ç‰ˆæœ¬è¿›è¡Œæ¯”è¾ƒã€‚</p><pre class="ln lo lp lq fq lr ju ls lt aw lu dt"><span id="0df1" class="lv kl hu ju b fv lw lx l ly lz">import packageJson from '{root-dir}/package.json';<br/>global.appVersion = packageJson.version;</span></pre><p id="44da" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">ä¸€æ—¦è®¾ç½®å®Œæˆï¼Œæ‚¨å°±å¯ä»¥é€šè¿‡é”®å…¥<code class="eh jr js jt ju b">appVersion</code>åœ¨æµè§ˆå™¨æ§åˆ¶å°ä¸­æ£€æŸ¥åº”ç”¨ç¨‹åºç‰ˆæœ¬ã€‚</p><h1 id="dbde" class="kk kl hu bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh dt translated">ç”Ÿæˆä¸€ä¸ªåŒ…å«æ¯æ¬¡æ„å»ºçš„åº”ç”¨ç‰ˆæœ¬çš„<code class="eh jr js jt ju b">meta.json</code>æ–‡ä»¶</h1><p id="a29f" class="pw-post-body-paragraph ir is hu it b iu li iw ix iy lj ja jb jc lk je jf jg ll ji jj jk lm jm jn jo hn dt translated">è¿è¡Œä¸€ä¸ªè„šæœ¬ï¼Œåœ¨åº”ç”¨ç¨‹åºçš„<code class="eh jr js jt ju b">public</code>ç›®å½•ä¸­ç”Ÿæˆä¸€ä¸ª<code class="eh jr js jt ju b">meta.json</code>æ–‡ä»¶ã€‚</p><p id="eded" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">æ·»åŠ ä¸€ä¸ª<code class="eh jr js jt ju b">prebuild</code> npmè„šæœ¬ï¼Œå®ƒå°†åœ¨æ¯ä¸ª<code class="eh jr js jt ju b">build</code>ä¹‹å‰ç”Ÿæˆ<code class="eh jr js jt ju b">meta.json</code>æ–‡ä»¶ã€‚</p><pre class="ln lo lp lq fq lr ju ls lt aw lu dt"><span id="b52d" class="lv kl hu ju b fv lw lx l ly lz">/* package.json */<br/><br/>{<br/>    "scripts": {<br/>        "generate-build-version": "node generate-build-version",<br/>        "prebuild": "npm run generate-build-version",<br/>        // other scripts<br/>     }<br/>}</span><span id="5c6b" class="lv kl hu ju b fv ma lx l ly lz">/* generate-build-version.js */<br/><br/>const fs = require('fs');<br/>const packageJson = require('./package.json');<br/><br/>const appVersion = packageJson.version;<br/><br/>const jsonData = {<br/>  version: appVersion<br/>};<br/><br/>var jsonContent = JSON.stringify(jsonData);<br/><br/>fs.writeFile('./public/meta.json', jsonContent, 'utf8', function(err) {<br/>  if (err) {<br/>    console.log('An error occured while writing JSON Object to meta.json');<br/>    return console.log(err);<br/>  }<br/><br/>  console.log('meta.json file has been saved with latest version number');<br/>});</span></pre><p id="d767" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">åœ¨æ¯æ¬¡æ„å»ºä¹‹åï¼Œä¸€æ—¦éƒ¨ç½²äº†åº”ç”¨ç¨‹åºï¼Œå°±å¯ä»¥ä½¿ç”¨è·¯å¾„<code class="eh jr js jt ju b">/meta.json</code>è®¿é—®<code class="eh jr js jt ju b">meta.json</code>ï¼Œå¹¶ä¸”å¯ä»¥åƒRESTç«¯ç‚¹ä¸€æ ·è·å–jsonã€‚å®ƒä¸ä¼šè¢«æµè§ˆå™¨ç¼“å­˜ï¼Œå› ä¸ºæµè§ˆå™¨ä¸ä¼šç¼“å­˜XHRè¯·æ±‚ã€‚å› æ­¤ï¼Œå³ä½¿æ‚¨çš„åŒ…æ–‡ä»¶è¢«ç¼“å­˜ï¼Œæ‚¨ä¹Ÿå°†æ€»æ˜¯è·å¾—æœ€æ–°çš„<code class="eh jr js jt ju b">meta.json</code>æ–‡ä»¶ã€‚</p><p id="dbf9" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">å› æ­¤ï¼Œå¦‚æœæ‚¨çš„åŒ…æ–‡ä»¶ä¸­çš„<code class="eh jr js jt ju b">appVersion</code>å°äº<code class="eh jr js jt ju b">meta.json</code>ä¸­çš„<code class="eh jr js jt ju b">version</code>ï¼Œé‚£ä¹ˆæˆ‘ä»¬çŸ¥é“<strong class="it hv">æµè§ˆå™¨ç¼“å­˜æ˜¯è¿‡æ—¶çš„ï¼Œæˆ‘ä»¬å°†éœ€è¦ä½¿å…¶æ— æ•ˆ</strong>ã€‚</p><p id="7a13" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">ä½ å¯ä»¥ç”¨è¿™ä¸ªè„šæœ¬æ¥æ¯”è¾ƒè¯­ä¹‰ç‰ˆæœ¬-</p><pre class="ln lo lp lq fq lr ju ls lt aw lu dt"><span id="4bda" class="lv kl hu ju b fv lw lx l ly lz">// version from `meta.json` - first param<br/>// version in bundle file - second param<br/>const semverGreaterThan = (versionA, versionB) =&gt; {<br/>  const versionsA = versionA.split(/\./g);<br/><br/>  const versionsB = versionB.split(/\./g);<br/>  while (versionsA.length || versionsB.length) {<br/>    const a = Number(versionsA.shift());<br/><br/>    const b = Number(versionsB.shift());<br/>    // eslint-disable-next-line no-continue<br/>    if (a === b) continue;<br/>    // eslint-disable-next-line no-restricted-globals<br/>    return a &gt; b || isNaN(b);<br/>  }<br/>  return false;<br/>};</span></pre><p id="010d" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">ä½ ä¹Ÿå¯ä»¥åœ¨æˆ‘çš„<a class="ae jp" href="https://github.com/flexdinesh/cache-busting-example/blob/ad03c264e2f52c71609726104e38ea3593520e07/src/CacheBuster.js#L6" rel="noopener ugc nofollow" target="_blank"> GitHubç¤ºä¾‹</a>ä¸­æ‰¾åˆ°è¿™æ®µä»£ç </p><h1 id="cc1a" class="kk kl hu bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh dt translated">åŠ è½½æ—¶æå–<code class="eh jr js jt ju b">meta.json</code>å¹¶æ¯”è¾ƒç‰ˆæœ¬</h1><p id="4db7" class="pw-post-body-paragraph ir is hu it b iu li iw ix iy lj ja jb jc lk je jf jg ll ji jj jk lm jm jn jo hn dt translated">å®‰è£…<code class="eh jr js jt ju b">App</code>åï¼Œè¯»å–<code class="eh jr js jt ju b">meta.json</code>å¹¶å°†å½“å‰ç‰ˆæœ¬ä¸æœåŠ¡å™¨ä¸­çš„æœ€æ–°ç‰ˆæœ¬è¿›è¡Œæ¯”è¾ƒã€‚</p><p id="1ae0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">å½“å‡ºç°<strong class="it hv">ç‰ˆæœ¬ä¸åŒ¹é…æ—¶</strong> = &gt;å¼ºåˆ¶<strong class="it hv">æ¸…é™¤ç¼“å­˜</strong>å¹¶åœ¨ç‰ˆæœ¬ç›¸åŒæ—¶ç¡¬é‡æ–°åŠ è½½= &gt;æ¸²æŸ“åº”ç”¨ç¨‹åºçš„å…¶ä½™éƒ¨åˆ†</p><p id="6b91" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">æˆ‘å·²ç»æ„å»ºäº†ä¸€ä¸ª<code class="eh jr js jt ju b">CacheBuster</code>ç»„ä»¶ï¼Œå®ƒå°†å¼ºåˆ¶æ¸…é™¤ç¼“å­˜å¹¶é‡æ–°åŠ è½½ç«™ç‚¹ã€‚è¯¥é€»è¾‘å°†é€‚ç”¨äºå¤§å¤šæ•°ç½‘ç«™ï¼Œä½†å¯ä»¥æ ¹æ®åº”ç”¨ç¨‹åºçš„å®šåˆ¶æƒ…å†µè¿›è¡Œè°ƒæ•´ã€‚</p><pre class="ln lo lp lq fq lr ju ls lt aw lu dt"><span id="5bd7" class="lv kl hu ju b fv lw lx l ly lz">/* CacheBuster component */<br/>import packageJson from '../package.json';<br/>global.appVersion = packageJson.version;<br/><br/>const semverGreaterThan = (versionA, versionB) =&gt; {<br/>    // code from above snippet goes here<br/>}<br/><br/>export default class CacheBuster extends React.Component {<br/>  constructor(props) {<br/>    super(props);<br/>    this.state = {<br/>      loading: true,<br/>      isLatestVersion: false,<br/>      refreshCacheAndReload: () =&gt; {<br/>        console.log('Clearing cache and hard reloading...')<br/>        if (caches) {<br/>          // Service worker cache should be cleared with caches.delete()<br/>          caches.keys().then(function(names) {<br/>            for (let name of names) caches.delete(name);<br/>          });<br/>        }<br/>        // delete browser cache and hard reload<br/>        window.location.reload(true);<br/>      }<br/>    };<br/>  }<br/><br/>  componentDidMount() {<br/>    fetch('/meta.json')<br/>      .then((response) =&gt; response.json())<br/>      .then((meta) =&gt; {<br/>        const latestVersion = meta.version;<br/>        const currentVersion = global.appVersion;<br/><br/>        const shouldForceRefresh = semverGreaterThan(latestVersion, currentVersion);<br/>        if (shouldForceRefresh) {<br/>          console.log(`We have a new version - ${latestVersion}. Should force refresh`);<br/>          this.setState({ loading: false, isLatestVersion: false });<br/>        } else {<br/>          console.log(`You already have the latest version - ${latestVersion}. No cache refresh needed.`);<br/>          this.setState({ loading: false, isLatestVersion: true });<br/>        }<br/>      });<br/>  }<br/><br/>  render() {<br/>    const { loading, isLatestVersion, refreshCacheAndReload } = this.state;<br/>    return this.props.children({ loading, isLatestVersion, refreshCacheAndReload });<br/>  }<br/>}</span></pre><p id="1e23" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ª<code class="eh jr js jt ju b">CacheBuster</code>ç»„ä»¶æ¥æ§åˆ¶<code class="eh jr js jt ju b">App</code>ç»„ä»¶ä¸­çš„æ¸²æŸ“</p><pre class="ln lo lp lq fq lr ju ls lt aw lu dt"><span id="71da" class="lv kl hu ju b fv lw lx l ly lz">/* App component */<br/>class App extends Component {<br/>  render() {<br/>    return (<br/>      &lt;CacheBuster&gt;<br/>        {({ loading, isLatestVersion, refreshCacheAndReload }) =&gt; {<br/>          if (loading) return null;<br/>          if (!loading &amp;&amp; !isLatestVersion) {<br/>            // You can decide how and when you want to force reload<br/>            refreshCacheAndReload();<br/>          }<br/><br/>          return (<br/>            &lt;div className="App"&gt;<br/>              &lt;header className="App-header"&gt;<br/>                &lt;h1&gt;Cache Busting - Example&lt;/h1&gt;<br/>                &lt;p&gt;<br/>                  Bundle version - &lt;code&gt;v{global.appVersion}&lt;/code&gt;<br/>                &lt;/p&gt;<br/>              &lt;/header&gt;<br/>            &lt;/div&gt;<br/>          );<br/>        }}<br/>      &lt;/CacheBuster&gt;<br/>    );<br/>  }<br/>}</span></pre><p id="89d2" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">ä½ ä¹Ÿå¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°è¿™ä¸¤ä¸ªç»„ä»¶çš„ä»£ç </p><p id="825b" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">CacheBusterâ€”<a class="ae jp" href="https://github.com/flexdinesh/cache-busting-example/blob/master/src/CacheBuster.js" rel="noopener ugc nofollow" target="_blank">CacheBuster . js</a></p><h1 id="e4dc" class="kk kl hu bd km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh dt translated">å½“ç‰ˆæœ¬ä¸åŒ¹é…æ—¶ï¼Œå¼ºåˆ¶æ¸…é™¤ç¼“å­˜å¹¶ç¡¬é‡æ–°åŠ è½½</h1><p id="f472" class="pw-post-body-paragraph ir is hu it b iu li iw ix iy lj ja jb jc lk je jf jg ll ji jj jk lm jm jn jo hn dt translated">æ¯æ¬¡åŠ è½½åº”ç”¨ç¨‹åºæ—¶ï¼Œæˆ‘ä»¬éƒ½ä¼šæ£€æŸ¥æœ€æ–°ç‰ˆæœ¬ã€‚æ ¹æ®åº”ç”¨ç¨‹åºç‰ˆæœ¬æ˜¯å¦è¿‡æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å†³å®šä»¥ä¸åŒçš„æ–¹å¼æ¸…é™¤ç¼“å­˜ã€‚</p><p id="5ddf" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">ä¸¾ä¸ªä¾‹å­ï¼Œ</p><ul class=""><li id="4984" class="jv jw hu it b iu iv iy iz jc jx jg jy jk jz jo kj kb kc kd dt translated">æ‚¨å¯ä»¥åœ¨æ¸²æŸ“åº”ç”¨ç¨‹åºä¹‹å‰è¿›è¡Œç¡¬é‡æ–°åŠ è½½</li><li id="d84f" class="jv jw hu it b iu ke iy kf jc kg jg kh jk ki jo kj kb kc kd dt translated">ä½ å¯ä»¥æ˜¾ç¤ºä¸€ä¸ªæ¨¡å¼/å¼¹å‡ºçª—å£ï¼Œè¦æ±‚ç”¨æˆ·ç‚¹å‡»ä¸€ä¸ªæŒ‰é’®å¹¶è§¦å‘ä¸€ä¸ªç¡¬é‡è½½</li><li id="0e0b" class="jv jw hu it b iu ke iy kf jc kg jg kh jk ki jo kj kb kc kd dt translated">å½“åº”ç”¨ç¨‹åºç©ºé—²æ—¶ï¼Œä½ å¯ä»¥ç¡¬åŠ è½½</li><li id="b182" class="jv jw hu it b iu ke iy kf jc kg jg kh jk ki jo kj kb kc kd dt translated">æ‚¨å¯ä»¥åœ¨å‡ ç§’é’Ÿåç”¨<code class="eh jr js jt ju b">setTimeout()</code>ç¡¬é‡æ–°åŠ è½½</li></ul><p id="2de0" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">ä½ å¯ä»¥ä»è¿™ç¯‡æ–‡ç« ä¸­æ‰¾åˆ°å®Œæ•´çš„ä»£ç ï¼Œä»¥åŠè¿™ä¸ªæŠ¥å‘Šä¸­çš„ä¸€ä¸ªå·¥ä½œç¤ºä¾‹â€” <a class="ae jp" href="https://github.com/flexdinesh/cache-busting-example" rel="noopener ugc nofollow" target="_blank">ç¼“å­˜ç ´åç¤ºä¾‹</a></p><p id="70c7" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">è¿™æ˜¯æ‰€æœ‰çš„ä¹¡äº²ã€‚å¦‚æœä½ å¯¹è¿™ç§æ–¹æ³•æœ‰ä»»ä½•åé¦ˆ(å¥½çš„å’Œåçš„)ï¼Œè¯·åœ¨è¯„è®ºä¸­å‘Šè¯‰æˆ‘ã€‚</p><p id="efcb" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated">ç ´åç¼“å­˜å¾ˆæœ‰è¶£ã€‚ğŸ‰</p></div><div class="ab cl mb mc hc md" role="separator"><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg mh"/><span class="me bw bk mf mg"/></div><div class="hn ho hp hq hr"><p id="dc1f" class="pw-post-body-paragraph ir is hu it b iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo hn dt translated"><em class="jq">æœ€åˆå‘è¡¨äº</em><a class="ae jp" href="https://dineshpandiyan.com/cache-busting" rel="noopener ugc nofollow" target="_blank"><em class="jq"/></a><em class="jq">ã€‚</em></p><figure class="ln lo lp lq fq mi"><div class="bz el l di"><div class="mj mk l"/></div></figure></div></div>    
</body>
</html>