# åœ¨ Tezos ä¸­å®ç°å¤šç­¾åæ™ºèƒ½åˆåŒï¼›ä½¿ç”¨åŸå› 

> åŸæ–‡ï¼š<https://medium.com/hackernoon/implementing-a-multi-sig-smart-contract-in-tezos-using-reasonml-1066d080eb68>

## æœ¬æ–‡å°†å¸¦æ‚¨ä¸º tezos å»ºç«‹ä¸€ä¸ªæ™ºèƒ½å¥‘çº¦å¼€å‘ç¯å¢ƒã€‚åŒæ—¶è§£é‡Šå¦‚ä½•ä½¿ç”¨ ReasonML & Liquidity è®¾è®¡å’Œå®ç°ä¸€ä¸ªç²¾ç›Šçš„å¤šç­¾åæ™ºèƒ½å¥‘çº¦ã€‚

![](img/acb2dc81cd649e4f1e2a1c045cbcde5d.png)

# å…ˆå†³æ¡ä»¶

è¿™ç¯‡æ–‡ç« å‡è®¾è‡³å°‘å¯¹åŒºå—é“¾æŠ€æœ¯çš„å·¥ä½œåŸç†æœ‰ä¸€ä¸ªåŸºæœ¬çš„äº†è§£ã€‚æˆ‘ä»¬å°†ä½¿ç”¨æ²™ç›’ Tezos [ç½‘ç»œ](https://hackernoon.com/tagged/ne)æ¥å¼€å‘æˆ‘ä»¬çš„æ™ºèƒ½åˆçº¦ï¼Œä½†åŒæ ·çš„è¿‡ç¨‹ä¹Ÿé€‚ç”¨äºå…¶ä»–ç½‘ç»œï¼Œå¦‚ Alphanet æˆ– Mainnetã€‚æˆ‘ä»¬å¼€å§‹å§ï¼

> **ğŸš¨å…è´£å£°æ˜**
> 
> ä»¥ä¸‹åˆåŒä»…ç”¨äºæ•™è‚²ç›®çš„ï¼Œæœªç»å®¡è®¡æˆ–å®¡æŸ¥ï¼Œè¯·è°¨æ…ä½¿ç”¨ã€‚
> 
> å¦‚æœä½ æƒ³å¿«è¿›ä¸€ç‚¹ï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°æœ€ç»ˆæ™ºèƒ½åˆçº¦çš„æºä»£ç ã€‚*ğŸ*

# ä»€ä¹ˆæ˜¯å¤šé‡ç­¾åï¼Ÿ

å¤šé‡ç­¾åæ˜¯ä¸€ä¸ªèŒƒä¾‹ï¼Œç”¨äº**åˆ’åˆ†èµ„é‡‘** **çš„è´£ä»»ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›ä¸¤ä¸ªç”¨æˆ·å…±äº«å¯¹ä»–ä»¬çš„êœ©çš„æ§åˆ¶æƒã€‚**

# è®¾ç½® sanboxed ç¯å¢ƒ

ä¸ºäº†å¼€å‘æˆ‘ä»¬çš„æ™ºèƒ½åˆåŒï¼Œæˆ‘ä»¬å°†ä»è®¾ç½®[tezos-environment-manager](https://github.com/maht0rz/tezos-environment-manager)å¼€å§‹ã€‚

> ä½ å¯ä»¥åœ¨è¿™é‡Œé˜…è¯»å¯¹ tezos-ç¯å¢ƒç®¡ç†å™¨[æ›´è¯¦ç»†çš„ä»‹ç»ã€‚*ğŸ‘ˆ*](https://hackernoon.com/tezos-smart-contracts-with-reasonml-docker-and-a-sandboxed-node-89df929ca1cf)

è®¾ç½®éå¸¸ç®€å•:

1.  å…‹éš†[ä»“åº“](https://github.com/maht0rz/tezos-environment-manager)
2.  é€‰æ‹©ä¸€ä¸ªç¯å¢ƒ
3.  æ„å»ºå›¾åƒ
4.  å¯åŠ¨èŠ‚ç‚¹ï¼Œ*å¯åŠ¨*å¤§çº¦éœ€è¦ 30 ç§’
5.  å¯åŠ¨å®¢æˆ·ç«¯

> *â°åœ¨æ„å»ºæ‚¨çš„ docker æ˜ åƒæ—¶ï¼Œè¯·è€å¿ƒç­‰å¾…ï¼Œåœ¨æœªæ¥çš„ç‰ˆæœ¬ä¸­ï¼Œè¿™äº›æ˜ åƒå°†åœ¨ hub.docker.com å¯ç”¨*

Setting up [tezos-environment-manager](https://github.com/maht0rz/tezos-environment-manager)

# è®¾è®¡æˆ‘ä»¬çš„æ™ºèƒ½åˆåŒ

è¦å®ç°å¤šç­¾ååŠŸèƒ½ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦çŸ¥é“**è°æ§åˆ¶è´¦æˆ·(åˆåŒ)**ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œåº”è¯¥æ˜¯ä¸¤ä¸ªä¸åŒçš„è´¦æˆ·(ä¹Ÿå°±æ˜¯é’±åŒ…)ã€‚æˆ‘ä»¬çš„æ²™ç›’ç¯å¢ƒå·²ç»æä¾›äº†ä¸€äº›å¯ç”¨çš„å¸å·ï¼Œå®ƒä»¬çš„åˆ«åæ˜¯ **bootstrap1** åˆ° **bootstrap5ã€‚**

![](img/9f7cc413078f566dd9eee847f19c1ab2.png)

Account aliased as bootstrap1 and itâ€™s keys

![](img/7f565be7ee6debf546f2a759e2dc432f.png)

Account aliased as bootstrap2 and itâ€™s keys

æˆ‘ä»¬çš„æ‰€æœ‰è€…åº”è¯¥æ˜¯**bootstrap 1&bootstrap 2**ï¼Œï¼Œå®é™…ä¸Šï¼Œè¿™æ„å‘³ç€è¿™äº›å¸æˆ·(ç§é’¥)é€šå¸¸ç”±ä¸¤ä¸ªä¸åŒçš„äººæŒæœ‰ï¼Œä»–ä»¬å¯ä»¥é€šè¿‡æˆ‘ä»¬æ­£åœ¨å¼€å‘çš„æ™ºèƒ½åˆçº¦ä¸€èµ·å‚ä¸å¤šç­¾åäº¤æ˜“ã€‚

> âš ï¸:æˆ‘ä»¬èªæ˜çš„å¥‘çº¦æ˜¯ç”¨ç†æ€§å†™æˆçš„ï¼Œä½†å®ƒè¢«è½¬åŒ–ä¸ºæµåŠ¨æ€§ï¼Œå¹¶ä»é‚£é‡Œç¼–è¯‘æˆè¿ˆå…‹å°”é€Š

## å…¥å£ç‚¹

æˆ‘ä»¬å°†åœ¨åˆåŒä¸­å…¬å¼€å››ä¸ªå…¥å£ç‚¹:`create_proposition`ã€`sign_proposition`ã€`delete_proposition`ã€`execute_proposition`ã€‚éšç€æ•™ç¨‹çš„æ·±å…¥ï¼Œæˆ‘ä»¬å°†é€ä¸€ä»‹ç»ã€‚

æµç¨‹åº”è¯¥å¦‚ä¸‹è¿›è¡Œ:

1.  æå‡ºæ–°çš„äº¤æ˜“
2.  ä¸æ‰€æœ‰åˆåŒæ‰€æœ‰äººç­¾ç½²æè®®çš„äº¤æ˜“(ä¸ªäººåˆ‡å…¥ç‚¹ç”µè¯)
3.  ä¸€æ—¦æ‰€æœ‰äººéƒ½ç­¾å­—äº†ï¼Œå°±æ‰§è¡Œè¿™ä¸ªæè®®ã€‚

æˆ–è€…ï¼Œæ‚¨å¯ä»¥åœ¨æµç¨‹ä¸­é€”åˆ é™¤ä¸€ä¸ªæè®®ï¼Œä»¥ä¾¿èƒ½å¤Ÿåˆ›å»ºä¸€ä¸ªæ–°çš„æè®®ã€‚

## ä»“åº“

æ™ºèƒ½åˆçº¦å¯ä»¥**é€šè¿‡å…¶å­˜å‚¨å°†æ•°æ®å­˜å‚¨åœ¨é“¾**ä¸Šï¼Œå­˜å‚¨è¢«å®šä¹‰ä¸ºç±»å‹ï¼Œå¹¶ä¸”åœ¨éƒ¨ç½²ä¹‹å‰ç”¨é»˜è®¤å€¼ **åˆå§‹åŒ–**ã€‚****

è¿™ä½¿æˆ‘ä»¬èƒ½å¤Ÿéƒ¨ç½²æ— æ•°çš„å¤šç­¾ç½²åˆåŒï¼Œè¿™äº›åˆåŒç”±ä¸åŒçš„å¸æˆ·ç»„åˆæ‹¥æœ‰ã€‚

æˆ‘ä»¬çš„å­˜å‚¨å°†ç”±ä»¥ä¸‹å±æ€§ç»„æˆ:

1.  ä¸€ç»„æ‰€æœ‰è€…â€”åŸºæœ¬ä¸Šæ˜¯ä¸€ç»„åœ°å€ï¼Œå¯ä»¥æ“ä½œæˆ‘ä»¬çš„æ™ºèƒ½åˆåŒ
2.  æè®®â€”â€”ç”±åˆåŒæ‰€æœ‰äººä¹‹ä¸€æå‡ºçš„äº¤æ˜“å»ºè®®ï¼ŒæŒ‡æ˜åº”å‘é€çš„é‡‘é¢å’Œå‘é€å¯¹è±¡ã€‚*(ç›®çš„åœ°ï¼Œé‡‘é¢)*
3.  ä¸€ç»„æ‰€æœ‰è€…ï¼Œä»–ä»¬ç­¾ç½²äº†ç°æœ‰æè®®â€”åŒæ ·æ˜¯â€œä¸€ç»„â€å¸æˆ·ï¼Œä»–ä»¬æ˜¯æ™ºèƒ½åˆåŒçš„æ‰€æœ‰è€…ï¼Œåœ¨åˆåŒä¸­æˆåŠŸæå‡ºäº¤æ˜“åï¼Œä»–ä»¬ç­¾ç½²äº†æè®®çš„äº¤æ˜“ã€‚

> *ğŸ”¬é¡ºä¾¿è¯´ä¸€å¥â€”â€”æ¯ä»½åˆåŒéƒ½å¿…é¡»æŒ‡å®šå®ƒæ‰€ä½¿ç”¨çš„ Liquidty è¯­è¨€çš„ç‰ˆæœ¬ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±åœ¨æ–‡ä»¶çš„é¡¶éƒ¨è¿™æ ·åšå§*

è®©æˆ‘ä»¬ä»åœ¨`src/contracts`ä¸‹åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¼€å§‹ç¼–ç ï¼Œæˆ‘ä»¬å¯ä»¥ç§°å®ƒä¸º`multisig.re`ã€‚ä»¥ä¸‹æ‰€æœ‰ä¸åˆåŒç›¸å…³çš„ä»£ç éƒ½åº”è¯¥åœ¨æˆ‘ä»¬çš„åˆåŒæ–‡ä»¶ä¸­ç»“æŸã€‚

Each contract specifies the Liquidity version itâ€™s written in at the top

Contracts can store data in storage, which is of a certain type.

ä¸ºäº†ç®€å•èµ·è§ï¼Œè®©æˆ‘ä»¬ä¹Ÿç«‹å³åˆå§‹åŒ–æˆ‘ä»¬çš„å­˜å‚¨ã€‚æˆ‘ä»¬å°†ä½¿ç”¨`bootstrap1` & `bootstrap2`æ¥è®¾ç½®æˆ‘ä»¬çš„å­˜å‚¨å™¨ä¸­çš„`owners`ã€‚æˆ‘ä»¬å°†çœå»å…¶ä»–å­˜å‚¨å±æ€§â€œç©ºç™½â€ï¼Œå› æ­¤æœ‰ä¸€ä¸ªå˜é‡`None`å’Œä¸€ä¸ªç©ºçš„`Set`ã€‚

Storage can be initialised, in our case with predefined owner addresses

# ACL â€”è®¿é—®æ§åˆ¶é”

æˆ‘ä»¬çš„æ™ºèƒ½åˆåŒéœ€è¦**é™åˆ¶å¯¹æŸäº›å…¥å£ç‚¹çš„è®¿é—®ã€‚**æˆ‘ä»¬å¯ä»¥é€šè¿‡å°†é€šè¿‡äº‹åŠ¡è°ƒç”¨æˆ‘ä»¬çš„åˆåŒçš„äººçš„**åœ°å€ä¸æˆ‘ä»¬æŒ‡å®šä¸ºåˆå§‹å­˜å‚¨çš„æ‰€æœ‰è€…**çš„**åœ°å€è¿›è¡Œæ¯”è¾ƒã€‚**

è®©æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå¯ä»¥é‡ç”¨çš„æ–¹æ³•ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º`can_call`ï¼Œå®ƒæ¥å—ä¸€ä¸ªå‚æ•°ï¼Œå³å½“å‰çš„å­˜å‚¨å€¼ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬å°†å®ç°ä¸€ä¸ªåŠ©æ‰‹æ–¹æ³•`fail_with_wrong_ownership`ï¼Œå®ƒä½¿å½“å‰çš„å¥‘çº¦äº‹åŠ¡å¤±è´¥â€”â€”æˆ‘ä»¬å°†åœ¨`can_call`è¯„ä¼°ä¸º`false`æ—¶ä½¿ç”¨å®ƒã€‚

# æè®®å¤šç­¾åäº¤æ˜“

ä¸ºäº†åœ¨æˆ‘ä»¬çš„å¤šç­¾åå¥‘çº¦ä¸­æå‡ºä¸€ä¸ªæ–°çš„äº‹åŠ¡ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªå«åš`create_proposition`çš„æ–¹æ³•ï¼Œå®ƒæœ‰ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯ç±»å‹`proposition`çš„ï¼Œå¦ä¸€ä¸ªæ˜¯ç±»å‹`storage`çš„ã€‚

è¯¥æ–¹æ³•çš„æµç¨‹ç›¸å¯¹ç®€å•ï¼Œé¦–å…ˆæ£€æŸ¥å½“å‰äº‹åŠ¡æ˜¯å¦æ˜¯ç”±æ‰€æœ‰è€…ä¹‹ä¸€å‘èµ·çš„ï¼Œå¦‚æœä¸æ˜¯ï¼Œåˆ™å› ä¸ºæ‰€æœ‰æƒé—®é¢˜è€Œå¤±è´¥ã€‚å¦‚æœä¸€ä¸ªå®é™…çš„å¤šç­¾ç½²åˆåŒæ‰€æœ‰è€…è°ƒç”¨è¿™ä¸ªå…¥å£ç‚¹ï¼Œæ£€æŸ¥æ˜¯å¦å·²ç»æœ‰ä¸€ä¸ªç°æœ‰çš„æè®®ï¼Œå¦‚æœæœ‰ï¼Œå¤±è´¥ï¼Œå› ä¸ºæˆ‘ä»¬ä¸æƒ³è¦†ç›–å®ƒå’Œä¸¢å¤±å®ƒçš„æ•°æ®ã€‚å¦‚æœæ²¡æœ‰ç°æœ‰çš„å‘½é¢˜ï¼Œå°†æˆ‘ä»¬çš„æ–°å‘½é¢˜ä¿å­˜ä¸ºå½“å‰å‘½é¢˜ã€‚

# åˆ é™¤å¤šç­¾åå‘½é¢˜

æœ‰å‡ºè·¯æ€»æ˜¯å¥½çš„ï¼Œåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å…è®¸é¢„å®šä¹‰çš„æ‰€æœ‰è€…åœ¨åˆ›å»ºä¸€ä¸ªæ–°çš„å‘½é¢˜ä¹‹å‰åˆ é™¤ä¸€ä¸ªæœªå†³çš„å‘½é¢˜ã€‚æˆ‘ä»¬çš„`delete_proposition`å…¥å£ç‚¹æ²¡æœ‰å‚æ•°ï¼Œå› æ­¤æˆ‘ä»¬ä½¿ç”¨`unit`ã€‚

æˆ‘ä»¬å†æ¬¡æ£€æŸ¥è°åœ¨è°ƒç”¨å¥‘çº¦å…¥å£ç‚¹ï¼Œå¦‚æœæˆ‘ä»¬çš„ ACL é€šè¿‡ï¼Œæˆ‘ä»¬åˆ é™¤ç°æœ‰çš„æœªå†³å‘½é¢˜ï¼Œå¦‚æœæ²¡æœ‰ï¼Œæˆ‘ä»¬ä¸­æ­¢æ“ä½œã€‚

# ç­¾ç½²å¤šç­¾åææ¡ˆ

ä¸ºäº†æ‰§è¡Œæè®®çš„äº¤æ˜“ï¼Œæˆ‘ä»¬å¿…é¡»å…ˆç­¾å­—ã€‚æˆ‘ä»¬å°†æœ‰ä¸€ä¸ªå…¥å£ç‚¹æ¥å®ç°è¿™ä¸€ç‚¹ï¼Œå®ƒå°†ç”±æ¯ä¸ªæ‰€æœ‰è€…ç‹¬ç«‹è°ƒç”¨ï¼Œä»¥æä¾›æ‰€æœ‰è€…ç‹¬æœ‰çš„å‘½é¢˜ç­¾åã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬åƒåœ¨`delete_proposition`ä¸­ä¸€æ ·æ£€æŸ¥ ACLï¼Œå¦‚æœé€šè¿‡ï¼Œæˆ‘ä»¬å°†æ·»åŠ ä¸€ä¸ªåŸºäº`Current.sender()`çš„ç­¾åï¼ŒT10 æ˜¯è°ƒç”¨æˆ‘ä»¬äº‹åŠ¡å…¥å£ç‚¹çš„å¸æˆ·çš„åœ°å€ï¼Œå®ƒæ˜¯åˆåŒæ‰€æœ‰è€…ä¹‹ä¸€ã€‚

> `*Set.add*`ä»…åœ¨å€¼æ˜¯å”¯ä¸€çš„æƒ…å†µä¸‹å°†å€¼æ·»åŠ åˆ°é›†åˆä¸­ï¼Œè¿™æ„å‘³ç€å¦‚æœæ‚¨å¤šæ¬¡è°ƒç”¨`*sign_proposition*`å…¥å£ç‚¹ï¼Œç”±åŒä¸€ä¸ªæ‰€æœ‰è€…ç­¾ç½²å¥‘çº¦è°ƒç”¨äº‹åŠ¡ï¼Œæ‚¨å°†ä¸ä¼šåˆ›å»ºç¬¬äºŒä¸ªç­¾åï¼Œå› ä¸ºæˆ‘ä»¬é›†åˆä¸­çš„åœ°å€æ˜¯å”¯ä¸€çš„ã€‚

# æ‰§è¡Œå¤šç­¾åææ¡ˆ

åœ¨æ‰€æœ‰çš„æ‰€æœ‰è€…éƒ½ç­¾ç½²äº†ææ¡ˆä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‰§è¡Œææ¡ˆäº†ã€‚

æˆ‘ä»¬é¦–å…ˆéªŒè¯æˆ‘ä»¬çš„ ACLï¼Œå¦‚æœé€šè¿‡ï¼Œæˆ‘ä»¬æ£€æŸ¥ç°æœ‰ç­¾åçš„æ•°é‡æ˜¯å¦ä¸å¤šç­¾ååˆåŒæ‰€æœ‰è€…çš„æ•°é‡ç›¸åŒ¹é…ã€‚å¦‚æœæˆ‘ä»¬æœ‰è¶³å¤Ÿçš„(100%)ç­¾åè¦†ç›–ç‡ï¼Œæˆ‘ä»¬ç»§ç»­åˆ›å»ºä¸€ä¸ª`Account.transfer`äº¤æ˜“ï¼Œç›®çš„åœ°&é‡‘é¢å–è‡ªæˆ‘ä»¬æè®®çš„äº¤æ˜“ã€‚

æˆ‘ä»¬é€šè¿‡è¿”å›ä¸€ä¸ªæ¸…ç†è¿‡çš„å­˜å‚¨æ¥ç»“æŸå…¥å£ç‚¹æ‰§è¡Œï¼Œè¿™è¦æ„Ÿè°¢å‰é¢å®šä¹‰çš„`delete_proposition`å¸®åŠ©å‡½æ•°ï¼Œå®ƒå°†æˆ‘ä»¬çš„å­˜å‚¨é‡ç½®å›æ²¡æœ‰ç°æœ‰å‘½é¢˜&ç­¾åçš„åˆå§‹çŠ¶æ€ã€‚æˆ‘ä»¬æŒ‡å®šä¸€ä¸ªè¦ä½œä¸ºè°ƒç”¨ç»“æœæ‰§è¡Œçš„äº¤æ˜“/æ“ä½œâ€”â€”è¿™æ˜¯ä¸€ä¸ªç»™å®šé‡‘é¢çš„å¯¹ç›®æ ‡å¸æˆ·çš„å»ºè®®äº¤æ˜“ã€‚

**ğŸ‰æ­å–œæ‚¨ï¼Œæ‚¨çš„æ™ºèƒ½åˆåŒç°å·²å‡†å¤‡å¥½éƒ¨ç½²åˆ°åŒºå—é“¾ï¼ğŸ‰**

*æ‚¨å¯ä»¥åœ¨è¿™é‡Œ* *æ‰¾åˆ°* [*å…¨åˆåŒçš„æ¥æºã€‚*](https://github.com/maht0rz/tezos-environment-manager/blob/master/src/contracts/multisig.re)

# éƒ¨ç½²æˆ‘ä»¬çš„æ™ºèƒ½åˆåŒ

æˆ‘ä»¬ç°åœ¨å°†å›åˆ°æˆ‘ä»¬çš„å®¢æˆ·ç«¯å¤–å£³ï¼Œæˆ‘ä»¬å·²ç»å¼€å§‹è¿è¡Œ`make client`ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬å¿…é¡»å°†æˆ‘ä»¬çš„ ReasonML ä»£ç è½¬æ¢/ç¿»è¯‘æˆ Liquidity ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨`refmt`æ¥åšåˆ°è¿™ä¸€ç‚¹ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨äºå°† ReasonML è½¬æ¢æˆ OCaml çš„å·¥å…·ï¼Œåä¹‹äº¦ç„¶ï¼Œç”±äº Liquidity æ˜¯ OCaml çš„å­é›†ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨æˆ‘ä»¬çš„åˆåŒä¸­ä½¿ç”¨å®ƒã€‚

Converting ReasonML to Liquidity

> ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªåä¸º`multisig.liq`çš„æ–‡ä»¶ï¼Œä½ å¯ä»¥ç”¨ä½ çš„ç¼–è¾‘å™¨æ£€æŸ¥å®ƒï¼Œè¯­æ³•åº”è¯¥æ˜¯ OCamlï¼Œæ‰€ä»¥å¦‚æœå®ƒä¸èƒ½é©¬ä¸Šè¯†åˆ«`.liq`ï¼Œä¸è¦å¿˜è®°é…ç½®ä½ çš„ç¼–è¾‘å™¨

## ä¼ªé€ éƒ¨ç½²è¡ŒåŠ¨

æˆ‘ä»¬ç°åœ¨å°†**ä¼ªé€ ä¸€ä¸ªæˆ‘ä»¬å¯ä»¥ç­¾ç½²çš„éƒ¨ç½²æ“ä½œ**ã€‚åœ¨æˆ‘ä»¬è¿™æ ·åšä¹‹å‰ï¼Œè®©æˆ‘ä»¬æ£€æŸ¥ä¸€ä¸‹åˆ°åº•ä¼šå‘ç”Ÿä»€ä¹ˆã€‚

æˆ‘ä»¬ä½¿ç”¨ Liquidity çš„ CLIï¼Œæœ¬åœ°æ²™ç›’èŠ‚ç‚¹ä¸º`$NODE_URL`

åœ¨æ‰§è¡Œæè®®çš„äº¤æ˜“æ—¶ï¼Œæˆ‘ä»¬çš„åˆåŒå°†æ¶ˆè€—`1000tz`çš„é‡‘é¢ã€‚

æŒ‡å®šè´¹ç”¨`1tz`ï¼Œä½œä¸ºé¢åŒ…å¸ˆå°†æˆ‘ä»¬çš„ç»è¥çº³å…¥æ–°è¡—åŒºçš„æ¿€åŠ±ã€‚

Source æ˜¯ä¿ƒè¿›éƒ¨ç½²çš„å¸æˆ·åœ°å€â€”â€”åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯`bootstrap1`,ä»–ä¹Ÿæ˜¯å¤šç­¾ååˆåŒçš„æ‰€æœ‰è€…å’Œæˆ‘ä»¬æ²™ç›’ç¯å¢ƒä¸­çš„é¢åŒ…å¸ˆã€‚

## ç­¾ç½²éƒ¨ç½²æ“ä½œ

æˆ‘ä»¬ç°åœ¨æœ‰äº†è¦ç­¾åçš„æ“ä½œå­—èŠ‚ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬é€šè¿‡è¿è¡Œä¸‹é¢çš„å‘½ä»¤æ¥å®Œæˆå®ƒã€‚æˆ‘ä»¬ä¼šç­¾ä¸º`bootstrap1`ã€‚

ç¡®ä¿ä¿å­˜ç”Ÿæˆçš„ç­¾åï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹ä¸€æ­¥ä¸­ä½¿ç”¨å®ƒã€‚

![](img/2e68a3ccbd2bebdd306e4e56f88c6952.png)

## ç”¨ç­¾åæ³¨å…¥éƒ¨ç½²æ“ä½œ

éƒ¨ç½²è¿‡ç¨‹çš„ä¸‹ä¸€æ­¥æ˜¯æ³¨å…¥ä¸€ä¸ªæ“ä½œï¼Œä½¿ç”¨å‰é¢ç”Ÿæˆçš„å­—èŠ‚å’Œç­¾åã€‚

> è¯·æ³¨æ„ï¼Œæ‚¨ç”Ÿæˆçš„ç­¾åå¯èƒ½ä¼šæœ‰æ‰€ä¸åŒï¼Œè¯·ç¡®ä¿å°†çœŸæ­£çš„ç­¾å**å¤åˆ¶åˆ°ä¸‹é¢çš„å‘½ä»¤ä¸­ã€‚**

![](img/f259d8848977d5f5becbfb3d55bd7637.png)

## åœ¨ TzScan æŸ¥æ‰¾æˆ‘ä»¬çš„åˆåŒ

æ­¤æ—¶ï¼Œæˆ‘ä»¬çš„åˆåŒå°šæœªåŒ…å«åœ¨æ–°çš„å—ä¸­ï¼Œå› ä¸ºæˆ‘ä»¬è‡ªå·±å°šæœªçƒ˜ç„™æ–°çš„å—ã€‚è®©æˆ‘ä»¬é€šè¿‡åœ¨æ‚¨çš„æµè§ˆå™¨ä¸­è®¿é—®[http://localhost:8000/contracts](http://localhost:8000/contracts)æ¥ç¡®ä¿æˆ‘ä»¬è¿˜ä¸èƒ½åœ¨ TzScan ä¸Šçœ‹åˆ°æˆ‘ä»¬çš„åˆåŒã€‚

![](img/a327dab3b122d4ccddae5aa3f585d6b1.png)

No contracts available at this time

## çƒ˜ç„™ä¸€ä¸ªæ–°çš„å—æ¥åŒ…å«æˆ‘ä»¬çš„éƒ¨ç½²æ“ä½œ

ä¸ºäº†åœ¨æˆ‘ä»¬çš„æ²™ç›’ç¯å¢ƒä¸­å®Œæˆéƒ¨ç½²è¿‡ç¨‹ï¼Œæˆ‘ä»¬å¿…é¡»çƒ˜ç„™ä¸€ä¸ªæ–°çš„å—ï¼Œä»¥ä¾¿åŒ…æ‹¬éƒ¨ç½²æ“ä½œã€‚

![](img/aa1db07cc8f708a97539a88e63ce2cff.png)

New block has been baked, including our smart contract.

**ğŸ‰æ‚¨ç°åœ¨å¯ä»¥å†æ¬¡æ£€æŸ¥ TzScanï¼Œæ‚¨å°†çœ‹åˆ°æˆ‘ä»¬çš„å¤šç­¾ååˆåŒå·²éƒ¨ç½²ğŸ‰**

![](img/5d2de82a7a2971789aba4dfb400d0c6a.png)

Contract has been deployed successfully

# ä¸æˆ‘ä»¬çš„æ™ºèƒ½åˆåŒå¯¹è¯

åœ¨æˆ‘ä»¬å¼€å§‹ä¸æˆ‘ä»¬çš„æ™ºèƒ½åˆçº¦äº¤äº’ä¹‹å‰ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å®ƒåœ¨ TzScan ä¸Šæ˜¯ä»€ä¹ˆæ ·å­çš„ã€‚

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„åˆåŒçš„å½“å‰å­˜å‚¨çŠ¶æ€ï¼Œç°åœ¨é™¤äº†æˆ‘ä»¬é¢„å®šä¹‰çš„ä¸€ç»„æ‰€æœ‰è€…â€” `bootstrap1` & `bootstrap2`ä¹‹å¤–ï¼Œä»€ä¹ˆä¹Ÿæ²¡æœ‰ã€‚

![](img/f1874751ab744a06453c42756e78a489.png)

Storage is initialised correctly

![](img/9ac318ebe75cb6e8c51061a3c702b8c6.png)

There are no transactions yet, and the balance is 1000tz

## åˆ›å»ºä¸€ä¸ªå¤šç­¾åææ¡ˆï¼Œç”±ä¸€ä¸ªä¸å…¬æ­£çš„æ‰€æœ‰è€…ç­¾å

ä¸æˆ‘ä»¬çš„æ™ºèƒ½åˆçº¦çš„ä¸€ä¸ªå¯èƒ½çš„äº¤äº’æ˜¯ä½¿ç”¨ä¸€ä¸ªå¸æˆ·è°ƒç”¨ä¸€ä¸ªå…¥å£ç‚¹ï¼Œè¯¥å¸æˆ·åœ¨æˆ‘ä»¬çš„åˆçº¦ä¸­æ²¡æœ‰è¢«åˆ—ä¸ºæ‰€æœ‰è€…ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ç»“æŸï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æˆ‘ä»¬çš„å®¢æˆ·çš„`bootstrap3`å¸æˆ·ï¼Œè¿™åœ¨æˆ‘ä»¬çš„åˆåŒä¸­æ²¡æœ‰ä½¿ç”¨ã€‚

![](img/7871c5a92bc731e210cb069d6e65ebdf.png)

Retrieving the keys for bootstrap3

ç„¶åï¼Œæˆ‘ä»¬ä»è¿™é‡Œå¤åˆ¶æˆ‘ä»¬éƒ¨ç½²çš„æ™ºèƒ½åˆåŒçš„åœ°å€:

![](img/b197a17cb4ab94bce33723566e97e064.png)

åœ¨æˆ‘çš„æƒ…å†µä¸‹ï¼ŒåˆåŒåœ°å€æ˜¯`KT1Fm94xt2ujgtpYSJKvc54thx8Aq5pk7RkK`ã€‚

æˆ‘ä»¬ç°åœ¨å¯ä»¥ä½¿ç”¨`bootstrap3`çš„é”®å’Œæˆ‘ä»¬çš„æ™ºèƒ½å¥‘çº¦åœ°å€æ¥æ‰§è¡Œå¥‘çº¦å…¥å£ç‚¹è°ƒç”¨ã€‚æˆ‘ä»¬å°†å‘`bootstrap4` â†’ `tz1b7tUupMgCNw2cCLpKTkSD1NZzB5TkP2sv`æå‡ºä¸€ç¬”é‡‘é¢ä¸º`0.01tz`çš„äº¤æ˜“ã€‚

> âš ï¸åœ¨è°ƒç”¨`create_proposition`æ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå¿…é¡»æŒ‡å®šå‚æ•°ï¼Œåœ¨æœ¬ä¾‹ä¸­æ˜¯æˆ‘ä»¬çš„`new_proposition`ã€‚ç”¨äºæŒ‡å®šå‚æ•°å€¼çš„è¯­æ³•æ˜¯ Liquidity/Ocamlã€‚

![](img/61acf6e38f1c657c64888fbf7627fab6.png)

Failed contract call

è¿™ä¸ªè°ƒç”¨å°†ä¸å¯é¿å…åœ°å¤±è´¥ï¼Œå› ä¸ºæˆ‘ä»¬çš„ ACL é€»è¾‘å°±æ˜¯è¿™æ ·è®¾ç½®çš„â€”â€”é™¤äº†é¢„å®šä¹‰çš„æ‰€æœ‰è€…ä¹‹å¤–ï¼Œä¸å…è®¸ä»»ä½•äººåˆ›å»ºäº‹åŠ¡æè®®ã€‚

## åˆ›å»ºç”±åˆæ³•æ‰€æœ‰è€…ç­¾åçš„å¤šç­¾åæè®®

å¦‚æœæˆ‘ä»¬ä½¿ç”¨`bootstrap1`çš„é’¥åŒ™ç­¾ç½²æˆ‘ä»¬çš„å‘¼å«ï¼Œæˆ‘ä»¬å°±èƒ½å¤ŸæˆåŠŸåœ°å‘¼å«åˆåŒå¹¶åˆ›å»ºä¸€ä¸ªæè®®ã€‚

![](img/a4a4fb1509460c764a1b3605cd27926b.png)

Successful contract call

ä¸ºäº†è®©æˆ‘ä»¬çš„å¥‘çº¦è°ƒç”¨ç”Ÿæ•ˆï¼Œæˆ‘ä»¬å¿…é¡»å†æ¬¡åœ¨æˆ‘ä»¬çš„æ²™ç›’ç¯å¢ƒä¸­çƒ˜ç„™ä¸€ä¸ªæ–°çš„å—:`tezos-client bake for bootstrap1`ã€‚

![](img/c2573797fe4776f6476a416daa00fbd4.png)

Baking a new block to include our contract call

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ TzScan éªŒè¯æˆ‘ä»¬çš„å‘¼å«/äº¤æ˜“æ˜¯å¦åŒ…å«åœ¨é“¾ä¸­:

![](img/214fffc47485952023ee385d2bc69cb5.png)

Transaction has been included

![](img/f1f97ba1af07779db0c7503b40941149.png)

Storage has been updated with the proposed transaction

## åˆåŒæ‰€æœ‰äººç­¾ç½²å»ºè®®ä¹¦

åœ¨æˆ‘ä»¬å¯ä»¥æ‰§è¡Œæˆ‘ä»¬æè®®çš„äº¤æ˜“ä¹‹å‰ï¼Œæˆ‘ä»¬å¿…é¡»ç”±åˆåŒæ‰€æœ‰äººç­¾å­—ï¼Œè®©æˆ‘ä»¬åˆ†ä¸¤æ¬¡ç»™`sign_proposition`æ‰“ç”µè¯ï¼Œç”±ä¸åŒçš„æ‰€æœ‰äººç­¾å­—å¹¶ç›–ç« æˆ‘ä»¬çš„æè®®ã€‚æˆ‘ä»¬å°†ä½¿ç”¨`bootstrap1`å’Œ`bootstrap2`æ¥ç­¾ç½²æˆ‘ä»¬çš„æè®®ã€‚

> *ğŸ‘‰*å¦‚æœä½ æƒ³å†’é™©ï¼Œä½ å¯ä»¥è¯•ç€ç”¨ä¸€ä¸ªè´¦æˆ·ç»™`sign_proposition`æ‰“ç”µè¯ï¼Œè¿™ä¸ªè´¦æˆ·ä¸æ˜¯æŒ‡å®šçš„æ‰€æœ‰è€…ã€‚ç”±äºæˆ‘ä»¬çš„ ACL é™åˆ¶ï¼Œå®ƒåº”è¯¥ä¼šå¤±è´¥ã€‚

![](img/e6a182b1d47fa34a6e69f26fff043d17.png)

Two independent sign_proposition calls successfully executed

ç°åœ¨æˆ‘ä»¬åªéœ€è¦çƒ˜ç„™ä¸€ä¸ªæ–°çš„å—ï¼Œæ¥åŒ…å«æˆ‘ä»¬çš„è°ƒç”¨ã€‚

![](img/a91889cd06aa192f8f9cd4726ee2ff43.png)

è¿”å› TzScan ä»¥éªŒè¯æˆ‘ä»¬çš„é€šè¯æ˜¯å¦åŒ…å«åœ¨å†…:

![](img/2a8b36ef529768041feb89de1bc188a7.png)

Two new transactions are visible, one for each sign_proposition call

![](img/2efe8d6b39ddc8faad5585bae1c34e9f.png)

Two signatures have been added to our contractâ€™s storage

## æ‰§è¡Œæè®®çš„äº¤æ˜“

å°±æ˜¯è¿™æ ·ï¼Œæ—¶é—´ç»ˆäºåˆ°äº†ã€‚æˆ‘ä»¬å°†æ‰§è¡Œä¸€é¡¹äº¤æ˜“ï¼Œè¯¥äº¤æ˜“å·²ç”±å¤šç­¾ååˆåŒçš„æ‰€æœ‰äººç­¾åã€‚æˆ‘ä»¬å°†ä½¿ç”¨`bootstrap1`æ¥å®Œæˆäº¤æ˜“ï¼Œå¹¶å°†åˆåŒæäº¤ç»™`execute_proposition`ã€‚

Executing the proposed transaction

![](img/7d6eca6b46221c61ed84e17d819cace7.png)

Successful call to execute_proposition

å†æ¬¡çƒ˜ç„™ä¸€ä¸ªæ–°çš„å—æ¥åŒ…å«æˆ‘ä»¬çš„æ“ä½œã€‚

![](img/d31fc0f81bd464b8fc27df69ae29d8e3.png)

å›åˆ° TzScanï¼Œæˆ‘ä»¬ä¼šæ³¨æ„åˆ°åˆåŒçš„å­˜å‚¨å›åˆ°äº†åŸå§‹çŠ¶æ€ï¼Œåªå®šä¹‰äº†æ‰€æœ‰è€…ï¼Œå¹¶ä¸”`0.01tz`å·²ç»ä»æˆ‘ä»¬çš„åˆåŒè½¬ç§»åˆ°äº†`bootstrap4`ã€‚

![](img/78a8113458eb987b5d93a70bed502430.png)

Contract storage has been reset

![](img/66fd7d93adbd710329692de7c397c8f0.png)

0.01tz has been transferred to tz1b7tUupMgCNw2cCLpKTkSD1NZzB5TkP2sv â†’ bootstrap4

![](img/8d440efbcea43a44a234f50a318f9734.png)

Bootstrap4 has indeed received our multi-sig transaction

**ğŸ‰å°±æ˜¯è¿™æ ·ï¼æˆ‘ä»¬å·²ç»æˆåŠŸéƒ¨ç½²äº†ä¸€ä¸ªå¤šç­¾åæ™ºèƒ½åˆåŒï¼Œå¹¶ä¸”èƒ½å¤Ÿä½¿ç”¨å®ƒæ¥æè®®äº¤æ˜“ã€ç­¾åå¹¶æ‰§è¡Œäº¤æ˜“ï¼Œä»è€Œæ›´æ–°æˆ‘ä»¬çš„åˆåŒå’Œç›®æ ‡å®¢æˆ·çš„ä½™é¢ã€‚ğŸ‰**

## è®©æˆ‘çŸ¥é“ä½ çš„æƒ³æ³•

ä½ æœ‰ä»»ä½•é—®é¢˜æˆ–æ„è§å—ï¼Ÿè¿è¡Œä»£ç æœ‰é—®é¢˜å—ï¼Ÿä½ å‘ç°é”™è¯¯äº†å—ï¼Ÿ

æˆ‘å¾ˆæƒ³å¬å¬ä½ çš„æƒ³æ³•ï¼Œä½ å¯ä»¥é€šè¿‡ t.me/maht0rz æˆ– matej.sima@gmail.com è”ç³»æˆ‘

> ***å¯ä»¥åœ¨:***
> ETH:0x 56 ba 1a 8681 db 66 DD 7 f 3158 a5e 2623577 D2 Fe 7 EC 2 ææ¬¾ã€‚
> 
> **BTC**:BC 1 qcc 7j 72 wl 7 l 8 mue pr 3 rewjfn 3 HDZ q 7h 9j 4 RPR 50
> 
> XTZ:tz 1 njgqajnlk 6 axrpj 78 fdwtjc 68y 9 clcrvf

***ç¼–è¾‘:*** *æ„Ÿè°¢**[*äºšç‘ŸÂ·å¸ƒè±ç‰¹æ›¼*](https://medium.com/u/50f422e6e1a9?source=post_page-----1066d080eb68--------------------------------) *å¯¹äºæŒ‡å‡ºåˆåŒä¸­å¯èƒ½å­˜åœ¨çš„æ¼æ´ï¼Œå¯ä»¥åœ¨æ­¤å¤„* *æŸ¥çœ‹ä¿®è®¢å†å²* [ã€‚](https://gist.github.com/maht0rz/2bb5469d58ee71a07ea449fcbd0e4a97/revisions)*

# *é¢å¤–èµ„æº*

***è¯æ±‡:**https://zeronet.tzscan.io/glossary*

***åŸå›  ML æ–‡æ¡£:**[https://reasonml.github.io/docs/en/what-and-why](https://reasonml.github.io/docs/en/what-and-why)*

***TQGroup çš„å­¦ä¹ :**[https://learn.tqgroup.io/](https://learn.tqgroup.io/)*

***æµåŠ¨æ€§å‚è€ƒ:**[http://www.liquidity-lang.org/doc/reference/liquidity.html](http://www.liquidity-lang.org/doc/reference/liquidity.html)*