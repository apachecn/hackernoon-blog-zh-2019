# æ¥ä¸‹æ¥å¦‚ä½•æ•´åˆã€‚Js å’Œå“ˆè‹æ‹‰

> åŸæ–‡ï¼š<https://medium.com/hackernoon/how-to-integrate-next-js-and-hasura-4a964424db6d>

![](img/7e8858aa241c4ec9978d30be42b384cb.png)

åœ¨æ‚¨å¼€å§‹è¿™ä¸ªé¡¹ç›®ä¹‹å‰ï¼Œæˆ‘å‡è®¾æ‚¨å¯¹ Next.js å’Œ Hasura æœ‰åŸºæœ¬çš„äº†è§£ã€‚åœ¨è¿™ç¯‡åšå®¢ä¸­ï¼Œæˆ‘å°†å±•ç¤ºå¦‚ä½•æ•´åˆ Next.js å’Œ Hasuraã€‚

# æ¥ä¸‹æ¥æ˜¯ä»€ä¹ˆã€‚Jsï¼Ÿ

**Next.js** æ˜¯ç”± [Zeit](https://zeit.co/) åˆ›å»ºçš„ JavaScript æ¡†æ¶ã€‚å®ƒå…è®¸æ‚¨ä½¿ç”¨ React æ„å»ºæœåŠ¡å™¨ç«¯å‘ˆç°å’Œé™æ€ web åº”ç”¨ç¨‹åºã€‚è¿™æ˜¯å»ºç«‹ä½ ä¸‹ä¸€ä¸ªç½‘ç«™çš„å¥½å·¥å…·ã€‚å®ƒæœ‰è®¸å¤šå¾ˆæ£’çš„ç‰¹æ€§å’Œä¼˜ç‚¹ï¼Œå¯ä»¥è®© Nextjs æˆä¸ºæ„å»ºä¸‹ä¸€ä¸ª web åº”ç”¨ç¨‹åºçš„é¦–é€‰ã€‚

å¼€å§‹ä½¿ç”¨ Next.js ä¸éœ€è¦ä»»ä½• webpack æˆ–ç±»ä¼¼çš„é…ç½®ï¼Œå®ƒè‡ªå¸¦é…ç½®ã€‚æ‚¨æ‰€éœ€è¦çš„å°±æ˜¯è¿è¡Œ`yarn run dev`å¹¶å¼€å§‹æ„å»ºæ‚¨çš„åº”ç”¨ç¨‹åºğŸ˜ƒã€‚

æ—¢ç„¶ä½ å·²ç»å‡†å¤‡å¥½äº†ï¼Œè®©æˆ‘ä»¬å¼€å§‹å§ï¼

![](img/1b807ad418d5be37863a54120a49cab8.png)

# å¦‚ä½•å»ºç«‹ä¸‹ä¸€ä¸ªï¼ŸJs appï¼Ÿ

æˆ‘å¸Œæœ›ä½ çŸ¥é“ create-react-appï¼Œå°±åƒæˆ‘ä»¬æœ‰ create-next-app ä¸€æ ·ï¼Œå®ƒå°†å®Œæˆè®¾ç½® Next.js é¡¹ç›®æ‰€éœ€çš„æ‰€æœ‰å·¥ä½œğŸ˜‰ã€‚

å¦‚æœæ‚¨ä½¿ç”¨ yarn æˆ– npxï¼Œæœ‰ä¸€ä¸ªå†…ç½®çš„è½¯ä»¶åŒ…å¯ä»¥åˆ›å»º next.js åº”ç”¨ç¨‹åºï¼Œå®ƒä»¬æ˜¯:

```
yarn create next-app my-appnpx create-next-app my-app
```

å¦‚æœæ‚¨ä½¿ç”¨ npmï¼Œé‚£ä¹ˆåº”è¯¥å®‰è£… **create-next-app** åŒ…ï¼Œä½¿ç”¨è¯¥åŒ…å¯ä»¥è®¾ç½®ä¸€ä¸ªæ–°é¡¹ç›®ã€‚

```
npm install -g create-next-appcreate-next-app my-app
```

![](img/e4e8cf9e9b4de0da2002695142cd1c2e.png)

create-next-app

æ­£å¦‚æ‚¨åœ¨å›¾åƒä¸­çœ‹åˆ°çš„ï¼Œä½¿ç”¨ä¸€ä¸ªå‘½ä»¤ï¼Œæ‰€æœ‰çš„é¡¹ç›®æ–‡ä»¶éƒ½å·²å‡†å¤‡å°±ç»ªã€‚ä¸€æ—¦é¡¹ç›®è®¾ç½®å®Œæ¯•ï¼Œå°†ä¼šæ˜¾ç¤ºå¯åŠ¨å’Œæ„å»ºé¡¹ç›®æ‰€éœ€çš„å‘½ä»¤ã€‚

æ„å»ºé¡¹ç›®è¿è¡Œ`yarn build`

è¦å¯åŠ¨æœ¬åœ°æœåŠ¡å™¨ï¼Œè¯·è¿è¡Œ`yarn dev`

åœ¨ç”Ÿäº§è¿è¡Œä¸­å¯åŠ¨æœåŠ¡å™¨`yarn start`

ç°åœ¨æˆ‘ä»¬å·²ç»å‡†å¤‡å¥½äº†åŸºæœ¬é¡¹ç›®ï¼Œè®©æˆ‘ä»¬å®‰è£… hasura graphQL å¼•æ“ã€‚

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨[ä¸€é”®å¼](https://heroku.com/deploy?template=https://github.com/hasura/graphql-engine-heroku)éƒ¨ç½²é€‰é¡¹è½»æ¾è®¾ç½® hasura-graphQL å¼•æ“ã€‚ä¸€æ—¦å®ƒè¢«éƒ¨ç½²ï¼Œä½ å¯ä»¥å»éƒ¨ç½²çš„ç½‘å€ï¼Œä½ ä¼šæœ‰è¿™æ ·çš„ä¸œè¥¿ã€‚

![](img/02b802ea0c30419903bff4c7837a4d73.png)

åœ¨ä¸»é¡µé¡¶éƒ¨è®°ä¸‹ç½‘å€ã€‚

```
[https://hasuragraphql-engine.herokuapp.com/v1alpha1/graphql](https://hasuragraphql-engine.herokuapp.com/v1alpha1/graphql)
```

å•å‡»é¡¶éƒ¨æ ä¸­çš„æ•°æ®ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªæ–°è¡¨ï¼Œå¦‚ä¸‹æ‰€ç¤º

![](img/f60af9de68c21e7e35d432193b7315b3.png)

author table

åœ¨è¡¨ä¸­æ·»åŠ ä¸€ä¸ªè™šæ‹Ÿæ•°æ®

![](img/d7e06c7275e8538c312c857142433eab.png)

Adding a dummy author

ä¸€æ—¦ hasura å¼•æ“å®‰è£…å®Œæ¯•ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç»§ç»­è¿æ¥ Hasura å’Œ Next.js äº†ã€‚

ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¿…é¡»å®‰è£… **graphql-tag** ã€ **next-apollo** å’Œ **react-apolloã€‚**

```
yarn add graphql-tag next-apollo react-apollo
```

ä¸€æ—¦å®‰è£…äº†ä¸Šé¢çš„åŒ…ï¼Œåœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª config.js æ–‡ä»¶ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹ä»£ç 

![](img/12761257044af4b9afd11fd553120c2f.png)

å°† uri æ›¿æ¢ä¸ºæ‚¨éƒ¨ç½²çš„å¼•æ“æ‰€æŒ‡å‘çš„ urlã€‚è¿™å°†ä¸º`withData`é…ç½®ä¸€ä¸ª`httpLink`æ¥è¿æ¥åˆ°ä¸€ä¸ªæœ‰æ•ˆçš„ GraphQL æœåŠ¡å™¨ URLã€‚

ä¸‹ä¸€ä¸ªä»»åŠ¡æ˜¯ç”¨æ¥è‡ª`react-apollo`çš„`Query`ç»„ä»¶åŒ…è£…æ‚¨çš„é¡µé¢ç»„ä»¶ï¼Œä»¥ä¾¿åœ¨æœåŠ¡å™¨ç«¯å‘ˆç°é¡µé¢æ—¶å¯ä»¥è·å–é€‚å½“çš„æ•°æ®ã€‚

## GraphQL æŸ¥è¯¢

```
const query = gql`
   query {
    author {
     id
     name
    }
   }
`
```

## ç”¨æŸ¥è¯¢åŒ…è£…ç»„ä»¶

```
<Query query={ query } fetchPolicy={ 'cache-and-network' }>
    {({ loading, data: { author:authors }}) => {
      return (
        <div>
          <div>
           {authors.map((a, i) => (
              <div key={i}>
               <h2>{a.name}</h2>
              </div>
           ))}
          </div>
        </div>
      );
    }}
</Query>
```

ä¸€æ—¦è¿™äº›ä»£ç è¢«ç»„åˆèµ·æ¥ï¼Œæˆ‘ä»¬å°†å¾—åˆ°ç±»ä¼¼è¿™æ ·ä¸œè¥¿ğŸ‘‡ã€‚

![](img/a7a449bad9fb3ea989ce308448622df2.png)

è¿è¡Œ`yarn run dev`,ä½ çš„ hasura-next.js åº”ç”¨å°±å¯åŠ¨å¹¶è¿è¡Œäº†ã€‚

åœ¨ä½ çš„æµè§ˆå™¨ä¸­æ‰“å¼€[**http://localhost:3000**](http://localhost:3000)ï¼Œä½ ä¼šåœ¨ä¸»é¡µä¸­çœ‹åˆ°æˆ‘ä»¬åœ¨ hasura å¼•æ“ä¸­åˆ›å»ºçš„ä½œè€…ã€‚

![](img/29e8b8272b4fff802c4793d1a4e2ee2d.png)

Authors page

![](img/b2b47e232ce7d8a22a87568974d4792b.png)

å°±æ˜¯è¿™æ ·ï¼Œä½¿ç”¨ Hasura Graphql å¼•æ“åˆ›å»º Next.js åº”ç”¨ç¨‹åºæ˜¯å¦‚æ­¤ç®€å•ğŸ™Œã€‚æ‚¨å¯ä»¥æ‰©å±•å®ƒä»¥åŒ…æ‹¬æ›´å¤šçš„åŠŸèƒ½å’Œæ›´å¥½çš„å¤–è§‚å’Œæ„Ÿè§‰ã€‚ä½¿ç”¨`yarn build`éƒ¨ç½²æ‚¨çš„åº”ç”¨ç¨‹åºï¼Œè¿™å°†ä¸ºæ‚¨æä¾›é™æ€ç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨ Github æˆ– Netlify è½»æ¾éƒ¨ç½²ã€‚

# å…³äºæˆ‘

æˆ‘å« **Aswin VB** ã€‚æˆ‘æ˜¯é˜¿æ‹‰å“ˆå·´å¾·å°åº¦ä¿¡æ¯æŠ€æœ¯å­¦é™¢çš„ä¸€åæœ¬ç§‘ç”Ÿï¼Œæ­£åœ¨æ”»è¯»ä¿¡æ¯æŠ€æœ¯çš„å­¦å£«å­¦ä½ã€‚

æˆ‘å–œæ¬¢åˆ›é€ å’Œå­¦ä¹ æ–°äº‹ç‰©ï¼Œå½“æˆ‘æœ‰ç©ºçš„æ—¶å€™æˆ‘æ€»æ˜¯è¿™æ ·åšã€‚æˆ‘å–œæ¬¢ç”¨ J **avaScript å’Œ Python** ç¼–å†™ä»£ç ã€‚

ä½ å¯ä»¥åœ¨ [Twitter](https://twitter.com/aswinvb1) å’Œ [GitHub](https://github.com/aswinzz) ä¸Šå…³æ³¨æˆ‘ã€‚