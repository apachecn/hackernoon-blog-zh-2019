# ğŸ“¡Web 3.0 éªŒè¯å™¨èŠ‚ç‚¹çš„æ— æœåŠ¡å™¨æ•…éšœè½¬ç§»è§£å†³æ–¹æ¡ˆğŸ¤– ğŸ”§

> åŸæ–‡ï¼š<https://medium.com/hackernoon/a-serverless-failover-solution-for-web-3-0-validator-nodes-e26b9d24c71d>

åœ¨ Web 2 åŸºç¡€è®¾æ–½ä¸Šå»ºç«‹è‡ªåŠ¨åŒ–èŠ‚ç‚¹æ•…éšœè½¬ç§»è§£å†³æ–¹æ¡ˆéå¸¸å®¹æ˜“ã€‚å®ƒæœ‰ä¸¤ä¸ªå†…å®¹ç›¸åŒçš„èŠ‚ç‚¹ã€‚å¤–éƒ¨æœåŠ¡å™¨ç›‘æ§ä¸»èŠ‚ç‚¹å¹¶æ£€æµ‹æ˜¯å¦æœ‰é—®é¢˜ã€‚å¦‚æœæ˜¯è¿™æ ·ï¼Œæ‚¨ç«™ç‚¹çš„å†…éƒ¨ DNS ä¼šè‡ªåŠ¨æ›´æ–°ï¼Œä»¥ä¾¿æµé‡ä¼šè¢«é‡å®šå‘åˆ°æ‚¨çš„è¾…åŠ©èŠ‚ç‚¹ã€‚ä¸€æ—¦æ‚¨çš„ä¸»èŠ‚ç‚¹æ¢å¤å·¥ä½œï¼Œæµé‡å°†è¿”å›åˆ°æ‚¨çš„ä¸»èŠ‚ç‚¹ã€‚

æ ¹æ®æœ€ç»ˆé…ç½®ï¼Œæ­¤è§£å†³æ–¹æ¡ˆå¯èƒ½ä¼šå¸¦æ¥é«˜å†—ä½™ã€‚ç„¶è€Œï¼Œå®ƒå¹¶ä¸ä¾¿å®œï¼›å®ƒéœ€è¦ä¸‰å°æœåŠ¡å™¨ï¼Œå³ä½¿å®ƒä»¬æ²¡æœ‰åšå¤ªå¤šå·¥ä½œï¼Œä¹Ÿä¼šæŒç»­æ¶ˆè€—å¤§é‡èµ„æºã€‚

æœ¬æ•™ç¨‹çš„ä¸»è¦ç›®æ ‡ä¹‹ä¸€æ˜¯é™ä½æˆæœ¬ã€‚è™šæ‹Ÿäº‘æä¾›å•†æœ‰è®¸å¤šå·¥å…·æ¥ç®¡ç†äº‘åŸºç¡€æ¶æ„ï¼Œè®©æˆ‘ä»¬èƒ½å¤Ÿæ›´å¥½åœ°æ§åˆ¶é¢„ç®—ã€‚

åœ¨ Web 3.0 åŸºç¡€è®¾æ–½ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ›´å¤æ‚çš„è§£å†³æ–¹æ¡ˆæ¥åˆ›å»ºç±»ä¼¼çš„æ–¹æ³•ã€‚ç®¡ç†å¯¹ç­‰è¿æ¥å’Œé‡å®šå‘æµé‡è¦å¤æ‚å¾—å¤šã€‚

æˆ‘ä»¬å°†åœ¨æœ¬æ•™ç¨‹ä¸­æ¢ç´¢çš„å¦ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯ï¼Œåªæœ‰å½“æˆ‘ä»¬çš„ä¸»èŠ‚ç‚¹å…³é—­æ—¶ï¼Œæ‰å¯åŠ¨è¾…åŠ©éªŒè¯èŠ‚ç‚¹ã€‚æˆ‘ä»¬å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ªâ€œåº”æ€¥ç”µåŠ›ç³»ç»Ÿâ€

![](img/5359e66100b66d9faca5ed1f4392b707.png)

ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ª AWS EC2 å®ä¾‹æ¥æ›¿æ¢ä¸»èŠ‚ç‚¹ï¼Œä»¥é˜²å‡ºç°æ•…éšœã€‚ä¸»èŠ‚ç‚¹å¯ä»¥åœ¨æ‚¨çš„åŠå…¬å®¤ã€å®¶ä¸­æˆ–ä»»ä½•äº‘æä¾›å•†çš„ä½ç½®ã€‚é€šè¿‡ä½¿ç”¨ç®€å•çš„å‘å¸ƒ/è®¢é˜…è®¾ç½®ï¼Œè¯¥èŠ‚ç‚¹å°†é€šè¿‡ AWS ç‰©è”ç½‘ç½‘å…³è¿æ¥åˆ° AWS äº‘ã€‚

# ä»€ä¹ˆæ˜¯ AWS IoTï¼Ÿ

AWS IoT æ˜¯ä¸€ä¸ªé«˜æ•ˆç®¡ç†â€œç‰©è”ç½‘â€è®¾å¤‡çš„å¹³å°ï¼Œä¹Ÿç§°ä¸ºâ€œä¸œè¥¿â€ã€‚AWS ç‰©è”ç½‘å¯ä»¥è¿æ¥åˆ° AWS äº‘ä¸­çš„å…¶ä»–åº”ç”¨ç¨‹åºï¼Œå¦‚ Lambda å‡½æ•°ï¼Œè¿™æ˜¯æ— æœåŠ¡å™¨åŸºç¡€è®¾æ–½çš„ä¸€ä¸ªæ–¹ä¾¿å·¥å…·ã€‚

ä¸œè¥¿é€šè¿‡ç‰©è”ç½‘ç½‘å…³ä¼ è¾“æ•°æ®ï¼Œç§°ä¸ºæ¶ˆæ¯ï¼Œåœ¨é‚£é‡Œå®ƒä»¬æ›´æ–°ä¸€ä¸ª**ä¸œè¥¿å½±å­**æˆ–åˆ°è¾¾ä¸€ä¸ª**è§„åˆ™å¼•æ“**ã€‚äº‹ç‰©é˜´å½±æ˜¯ä¸€ä¸ª(JSON)å¯¹è±¡ï¼Œå®ƒåŒ…å«å½“äº‹ç‰©/è®¾å¤‡çš„çŠ¶æ€æ”¹å˜æ—¶æ›´æ–°çš„å…³äºè®¾å¤‡çš„ä¿¡æ¯ã€‚å®ƒå…è®¸æˆ‘ä»¬è®¾ç½®ã€å­˜å‚¨å’ŒåŒæ­¥äº‹ç‰©çŠ¶æ€åŠå…¶äº‘è¡¨ç¤ºã€‚
è§„åˆ™å¼•æ“ï¼Œé¡¾åæ€ä¹‰ï¼Œæ˜¯ä¸€ç»„è§„åˆ™ï¼Œä½¿æ¶ˆæ¯èƒ½å¤Ÿä¸ä»ç‰©è”ç½‘ç½‘å…³åˆ°å°‘æ•°ä¸‹æ¸¸ AWS æœåŠ¡çš„ SQL ç±»å‹è¯­å¥è¿›è¡Œäº¤äº’ã€‚
æˆ‘ä»¬å°†å…³æ³¨è§„åˆ™å¼•æ“ï¼Œå› ä¸ºæˆ‘ä»¬å¸Œæœ›å°†æˆ‘ä»¬çš„ä¸œè¥¿/è®¾å¤‡è¿æ¥åˆ° Lambda å‡½æ•°ã€‚

> æ¶ˆæ¯é˜Ÿåˆ—é¥æµ‹ä¼ è¾“( **MQTT** )æ˜¯ä¸€ä¸ªå®¢æˆ·ç«¯-æœåŠ¡å™¨å‘å¸ƒ/è®¢é˜…æ¶ˆæ¯ä¼ è¾“åè®®ã€‚å®ƒæ˜¯è½»é‡çº§çš„ã€å¼€æ”¾çš„ã€ç®€å•çš„ï¼Œå¹¶ä¸”è¢«è®¾è®¡æˆæ˜“äºå®ç°ã€‚è¿™äº›ç‰¹æ€§ä½¿å®ƒéå¸¸é€‚åˆåœ¨è®¸å¤šæƒ…å†µä¸‹ä½¿ç”¨ï¼ŒåŒ…æ‹¬å—é™ç¯å¢ƒï¼Œå¦‚æœºå™¨å¯¹æœºå™¨(M2M)å’Œç‰©è”ç½‘(IoT)ç¯å¢ƒä¸­çš„é€šä¿¡ï¼Œåœ¨è¿™äº›ç¯å¢ƒä¸­éœ€è¦å°‘é‡ä»£ç å’Œ/æˆ–ç½‘ç»œå¸¦å®½éå¸¸å®è´µã€‚å®ƒå¯ç”¨äº†ä¸€ç§åœ¨å‘ç”Ÿå¼‚å¸¸æ–­å¼€æ—¶é€šçŸ¥ç›¸å…³æ–¹çš„æœºåˆ¶ã€‚
> è¯¥åè®®è¿è¡Œåœ¨ TCP/IP æˆ–å…¶ä»–æä¾›æœ‰åºã€æ— æŸã€åŒå‘è¿æ¥çš„ç½‘ç»œåè®®ä¸Šã€‚â€”â€”[http://mqtt.org/](http://mqtt.org/)

**ç‰©è”ç½‘ç½‘å…³**ä½œä¸º **MQTT** **ä»£ç†**å·¥ä½œï¼Œä»¥å…è®¸è®¾å¤‡-äº‘é€šä¿¡ã€‚

![](img/fef1e8c101bfbb15fa548aa6b5c50315.png)

[http://micrasystems.com/real-time-messaging-using-mqtt/](http://micrasystems.com/real-time-messaging-using-mqtt/)

1.  è®¢æˆ·(äº‹ç‰©/æœåŠ¡)è¿æ¥åˆ°ä»£ç†ã€‚å®ƒå¯ä»¥è®¢é˜…ä»£ç†ä¸­çš„ä»»ä½•æ¶ˆæ¯â€œä¸»é¢˜â€ã€‚
2.  å‘å¸ƒè€…(å®¢æˆ·ç«¯/äº‹ç‰©)é€šè¿‡å‘ä»£ç†å‘é€æ¶ˆæ¯å’Œä¸»é¢˜æ¥å‘å¸ƒä¸»é¢˜ä¸‹çš„æ¶ˆæ¯ã€‚å¯¹äºæ•æ„Ÿæ¶ˆæ¯ï¼Œæ­¤è¿æ¥å°†è¢«åŠ å¯†ã€‚
3.  ç„¶åï¼Œä»£ç†(IoT MQTT ä»£ç†)å°†æ¶ˆæ¯è½¬å‘ç»™è®¢é˜…è¯¥ä¸»é¢˜çš„æ‰€æœ‰äº‹ç‰©/æœåŠ¡ã€‚

# ä»€ä¹ˆæ˜¯ Lambda å‡½æ•°ï¼Ÿ

AWS Lambda æ˜¯ä¸€ä¸ªäº‹ä»¶é©±åŠ¨çš„è®¡ç®—å¹³å°ï¼ŒæŒ‰éœ€æ‰§è¡Œä»£ç ã€‚æ­¤åŠŸèƒ½æ”¯æŒä»»ä½•åº”ç”¨ç¨‹åºçš„æ— æœåŠ¡å™¨æ¶æ„ã€‚

è§¦å‘ AWS Lambda å‡½æ•°çš„ä¸€ç§å¸¸è§æ–¹å¼æ˜¯é€šè¿‡ä¸»é¢˜ä½¿ç”¨è§„åˆ™ã€‚æˆ‘ä»¬ä¹‹å‰æåˆ°è¿‡ AWS ç‰©è”ç½‘è§„åˆ™å¼•æ“ï¼›æˆ‘ä»¬å°†ä½¿ç”¨å®ƒä½œä¸ºä» MQTT ä»£ç†è§¦å‘è§„åˆ™çš„å·¥å…·ã€‚è¿™æ˜¯ä¸€ç§åˆ†ç¦»æ¶ˆæ¯å‘å¸ƒè€…å’Œè®¢é˜…è€…çš„ä»¤äººä¿¡æœçš„æ–¹å¼ï¼Œå¹¶ä¸”æ¶ˆé™¤äº†è½®è¯¢æ–°æ¶ˆæ¯çš„éœ€è¦ã€‚

æˆ‘ä»¬å°†è®¾ç½®ä¸€ä¸ªè§„åˆ™ï¼Œå¹¶è®¢é˜…ä¸€ä¸ª Lambda å‡½æ•°ï¼Œä»¥ä¾¿åœ¨æ¯æ¬¡ä¸»é¢˜æ”¶åˆ°æ¶ˆæ¯æ—¶å¯åŠ¨/åœæ­¢ EC2 å®ä¾‹ã€‚è¿™ä¸ªè§„åˆ™è¿˜ä¼šè§¦å‘ä¸€ä¸ª SNS è¯é¢˜é€šè¿‡é‚®ä»¶é€šçŸ¥æˆ‘ä»¬ã€‚

# äº‘çš„å½¢æˆ

CloudFormation æ˜¯ä¸€ä¸ª AWS å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ¯«ä¸è´¹åŠ›åœ°å»ºç«‹äº‘åŸºç¡€è®¾æ–½ã€‚æˆ‘ä»¬å®šä¹‰ AWS åº”è¯¥æ„å»ºåˆ°æ¨¡æ¿æ–‡æ¡£ä¸­çš„æ‰€æœ‰èµ„æºï¼Œç‚¹å‡»ä¸€ä¸ªæŒ‰é’®ï¼ŒAWS å°±ç¥å¥‡åœ°åˆ›å»ºäº†ä¸€åˆ‡ã€‚

![](img/0e9ce28ff18ee9a53ee07d530c0cd046.png)

[https://aws.amazon.com/cloudformation/](https://aws.amazon.com/cloudformation/)

æˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªæ¨¡æ¿æ¥åˆ›å»ºæˆ‘ä»¬çš„ç‰©è”ç½‘ï¼Œé…ç½®è§„åˆ™å¼•æ“ï¼Œåˆ›å»º Python Lambda å‡½æ•°ï¼Œæœ€åè®¾ç½®ç›¸å…³çš„äº‹ä»¶ã€è§’è‰²å’Œç­–ç•¥ã€‚

# æˆ‘ä»¬æ¥å»ºå§ï¼

æ— æœåŠ¡å™¨æ¶æ„å°†å¤„ç† EC2 å®ä¾‹çš„å¯åŠ¨å’Œåœæ­¢ã€‚æœ¬æ•™ç¨‹è¦æ±‚æ‚¨å·²ç»æ‹¥æœ‰ä¸€ä¸ªå¸¦æœ‰ [polkadot å®¢æˆ·ç«¯](http://wiki.polkadot.network/en/latest/polkadot/node/guides/how-to-validate/)å¹¶é…ç½®æœ‰ [systemd æœåŠ¡](http://wiki.polkadot.network/en/latest/polkadot/node/guides/how-to-systemd/)çš„ EC2 å®ä¾‹éªŒè¯å™¨èŠ‚ç‚¹ã€‚å®ƒä»ç„¶æ˜¯è¿™ä¸ªå †æ ˆçš„ä¸€ä¸ªç‹¬ç«‹ç»„ä»¶ã€‚

æˆ‘ä»¬éœ€è¦ X.509 è¯ä¹¦å’Œç§é’¥æ¥å»ºç«‹å®‰å…¨çš„ AWS ç‰©è”ç½‘è¿æ¥ã€‚å‡ºäºå®‰å…¨åŸå› å’Œéµå¾ªæœ€ä½³å®è·µï¼Œæˆ‘ä»¬ä¸ä¼šåœ¨ CloudFormation ä¸Šåˆ›å»ºå®ƒã€‚

åœ¨ç‰©è”ç½‘æ ¸å¿ƒæ§åˆ¶å°ä¸Šï¼Œè¿›å…¥**å®‰å…¨**->è¯ä¹¦ã€‚ç‚¹å‡»**åˆ›å»º**å¹¶é€‰æ‹©**æ¨èçš„** **ä¸€é”®é€‰æ‹©**åˆ›å»ºè¯ä¹¦ã€‚

![](img/b9e8bad751268a7be6f2f3f12f30d274.png)

å®Œæˆåï¼Œå°†æ‰€æœ‰è¯ä¹¦ä¸‹è½½åˆ°æ‚¨çš„æœ¬åœ°å·¥ä½œåŒºæ–‡ä»¶å¤¹ä¸­ï¼Œç„¶åå•å‡»**æ¿€æ´»**ã€‚

![](img/1708c571ad303a56376692bfd7f2df38.png)

ä¸è¦å¿˜è®°ä¸‹è½½é€šç”¨æ ¹è¯ä¹¦æ¥éªŒè¯ AWS æœåŠ¡å™¨çš„è¿æ¥ã€‚AWS IoT çš„æ ¹ CA[**ä¸‹è½½**](https://docs.aws.amazon.com/iot/latest/developerguide/managing-device-certs.html#server-authentication) **ã€‚**

![](img/23beb1abfe86c59b7b441fd00488edb5.png)

[https://docs.aws.amazon.com/iot/latest/developerguide/managing-device-certs.html#server-authentication](https://docs.aws.amazon.com/iot/latest/developerguide/managing-device-certs.html#server-authentication)

å°†ä¸‹ä¸€ä¸ªæ¨¡æ¿ä¸‹è½½æˆ–å¤åˆ¶åˆ°æœ¬åœ°å·¥ä½œåŒºæ–‡ä»¶å¤¹ä¸­ã€‚æˆ‘ä»¬ä¼šæŠŠå®ƒä¸Šä¼ åˆ°äº‘å½¢æˆæ§åˆ¶å°ã€‚

åœ¨åˆ›å»ºæˆ‘ä»¬çš„ ClourFormation å †æ ˆä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦è·å¾— IoT è¯ä¹¦ ID å’Œ EC2 å®ä¾‹ IDã€‚

åœ¨ç‰©è”ç½‘æ ¸å¿ƒæ§åˆ¶å°ä¸Šï¼Œè¿›å…¥**å®‰å…¨**->-**è¯ä¹¦**ã€‚ç‚¹å‡»è¯ä¹¦å¹¶å¤åˆ¶ IDã€‚

![](img/5f0c89635f367a2a86b2d8f04d229d8f.png)

ä» EC2 å®ä¾‹æ§åˆ¶å°ï¼Œå¤åˆ¶æ‚¨çš„éªŒè¯å™¨çš„å®ä¾‹ IDã€‚

![](img/19167afe2c86e417cbab456592636ee1.png)

æ˜¯æ—¶å€™æ„å»ºæˆ‘ä»¬çš„æ— æœåŠ¡å™¨åŸºç¡€æ¶æ„äº†ã€‚è¿›å…¥ [**äº‘å½¢æˆæ§åˆ¶å°**](https://console.aws.amazon.com/cloudformation/home) å¹¶ç‚¹å‡»**åˆ›å»ºå †æ ˆ**ã€‚

![](img/58c1f83ad4350f31c95ecac3d7c6e418.png)

æˆ‘ä»¬å°†è¢«è¦æ±‚é€‰æ‹©ä¸€ä¸ªæ¨¡æ¿æˆ–ä¸Šä¼ ä¸€ä¸ªã€‚é€‰æ‹©**ä¸Šä¼ æ¨¡æ¿**é€‰é¡¹ï¼Œå¹¶ä½¿ç”¨æˆ‘ä»¬ä¹‹å‰å­˜å‚¨åœ¨æœ¬åœ°å·¥ä½œåŒºçš„**basicserverlessfvalidator . yml**æ–‡ä»¶ã€‚

![](img/3933dea213b86db2cba58e31b99eb8e7.png)

å¡«å†™æ‰€æœ‰å¿…å¡«å­—æ®µ(å †æ ˆåç§°ã€è¯ä¹¦ IDã€ç”µå­é‚®ä»¶ã€å®ä¾‹ ID)ã€‚

![](img/883e7410d01ea702bc5a18ac11c12854.png)

ç‚¹å‡»**ä¸‹ä¸€ä¸ª**ä¸¤æ¬¡ï¼Œè·³è¿‡åˆ›å»ºå †æ ˆå®šåˆ¶ï¼Œç›´åˆ°åˆ°è¾¾åˆ›å»ºå †æ ˆé€‰é¡¹ã€‚å‹¾é€‰å¤é€‰æ¡†**ç¡®è®¤**æˆ‘ä»¬çš„æ— æœåŠ¡å™¨å †æ ˆä½¿ç”¨çš„è§’è‰²å’Œç­–ç•¥æ‰€éœ€çš„ IAM èµ„æºçš„åˆ›å»ºã€‚

![](img/c8c883ebb6336342f1b04f65c1e9397a.png)

ç‚¹å‡»**åˆ›å»ºå †æ ˆ**å¹¶ç­‰å¾…åˆ›å»ºå®Œæˆã€‚

![](img/835eea5dd3847dc42dc688807bc94b5d.png)

æˆ‘ä»¬å·²ç»åˆ›å»ºäº†æ— æœåŠ¡å™¨äº‘åŸºç¡€æ¶æ„ã€‚ğŸ‰

é‡è¦æç¤º:æ‚¨éœ€è¦éªŒè¯è§¦å‘å™¨å·²ç»åœ¨ Lambda å‡½æ•°ä¸­æ³¨å†Œã€‚æœ‰æ—¶ï¼Œç”±äºäº‘å½¢æˆä¸­çš„ç«äº‰æ¡ä»¶ï¼Œå®ƒä»¬ä¸ä¼šå‡ºç°åœ¨ Lambda å‡½æ•°ä¸­ã€‚

![](img/44ff37a278da405be42c914b26f424bf.png)

è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ‚¨åªéœ€è¦æ›´æ–°è§¦å‘äº‹ä»¶ï¼Œè€Œä¸éœ€è¦åšä»»ä½•æ›´æ”¹ã€‚ç„¶åå®ƒå°†å‡ºç°åœ¨ Lambda å‡½æ•°è§¦å‘å™¨ä¸Šã€‚å¯¹ 3 ä¸ªç‰©è”ç½‘è§„åˆ™é‡å¤æ­¤æ­¥éª¤(ValidatorNodeDisconnectedã€ValidatorNodeStartã€ValidatorNodeStop)ã€‚

![](img/ddd12a880b47c490d82ea4db3a061e7c.png)![](img/d5649616cfdb06308f238820f9f10ade.png)

æ›´æ–°åï¼Œæ‚¨å¯ä»¥éªŒè¯è§¦å‘å™¨æ˜¯å¦åœ¨ Lambda å‡½æ•°ä¸Šæ³¨å†Œã€‚

![](img/2785a3793cf6ca145cea60df80c23309.png)

# ä¸»éªŒè¯å™¨èŠ‚ç‚¹

ç°åœ¨ï¼Œæˆ‘ä»¬å·²ç»å‡†å¤‡å¥½äº†æ— æœåŠ¡å™¨äº‘åŸºç¡€æ¶æ„ã€‚æˆ‘ä»¬éœ€è¦åœ¨æˆ‘ä»¬çš„éªŒè¯å™¨èŠ‚ç‚¹(Thing)å’Œ AWS ç‰©è”ç½‘ç½‘å…³ä¹‹é—´å»ºç«‹æ•°æ®è¿æ¥ã€‚

å°†ä¸‹ä¸€ä¸ª python è„šæœ¬ä¸‹è½½æˆ–å¤åˆ¶åˆ°ä¸»éªŒè¯å™¨èŠ‚ç‚¹ä¸­ã€‚

å®‰è£…ä½¿ç”¨ Python è„šæœ¬æ‰€éœ€çš„ä¾èµ–é¡¹ã€‚

```
**$** python3 -m pip install AWSIoTPythonSDK pystemd
```

æˆ‘ä»¬éœ€è¦ç”¨æˆ‘ä»¬çš„è¯ä¹¦å’Œç§é’¥æ–‡ä»¶æ›¿æ¢ Python è„šæœ¬ä¸Šçš„é…ç½®å‚æ•°ã€‚

åœ¨ç‰©è”ç½‘æ ¸å¿ƒæ§åˆ¶å°ä¸­ï¼Œç‚¹å‡»æˆ‘ä»¬åˆ›å»ºçš„ä¸œè¥¿â€œValidatorNodeThingâ€ã€‚é€‰æ‹©**äº¤äº’**é€‰é¡¹å¡ï¼Œå¤åˆ¶ HTTPS ç‰©è”ç½‘ Rest API ç«¯ç‚¹åœ°å€ã€‚ç”¨æ­¤åœ°å€æ›¿æ¢ host_name å€¼ã€‚

ä¾‹å¦‚-â€œä¸»æœºåâ€:â€œ[a1yfesihws3xl1-ats.iot.eu-west-1.amazonaws.com](http://a1yfesihws3xl1ats.iot.eu-west-1.amazonaws.com/)â€

![](img/45b4b65d9dd4b7f940d21b91354ae1c6.png)

*' root _ ca ':/absolute-path-to-file/amazonrootca 1 . PEM "*

*' private _ key ':/absolute-path-to-file/yourkeyid-private . PEM . key "*

*' cert _ file ':/absolute-path-to-file/yourkeyid-certificate . PEM . CRT "*

å‡ºäºå®‰å…¨åŸå› ï¼ŒAWS ä¸ä½¿ç”¨å…·æœ‰æ‰“å¼€æƒé™çš„æ–‡ä»¶ã€‚æ›´æ”¹æ–‡ä»¶æƒé™ä»¥å¯ç”¨åªè¯»è®¿é—®ã€‚

```
***$*** *chmod 440 /path-to-downloaded-files/**
```

# å°† Python è„šæœ¬æ³¨å†Œä¸º Linux systemd æœåŠ¡

å‡†å¤‡å¥½ Python è„šæœ¬åï¼Œæ¥ä¸‹æ¥è¦åšçš„äº‹æƒ…æ˜¯åˆ›å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå‘Šè¯‰ systemd æˆ‘ä»¬å¸Œæœ›å®ƒåšä»€ä¹ˆã€‚

```
**$** sudo vi /lib/systemd/system/polkadot-node-iot.service
```

è¯¥æ–‡ä»¶éœ€è¦åŒ…å«ä»¥ä¸‹æ–‡æœ¬(æ›¿æ¢**è„šæœ¬è·¯å¾„**):

```
[Unit]
Description=Python script for the ValidatorNodeThing connection.
After=multi-user.target[Service]
Restart=always
ExecStart=/usr/bin/python3 /**path-to-script**/[BasicValidatorNode.py](https://gist.github.com/riusricardo/4f9143a1dd9b9ca069b36280be6e492a)[Install]
WantedBy=multi-user.target
```

å°†æ–‡ä»¶æƒé™æ›´æ–°ä¸º 644:

```
**$** sudo chmod 644 /lib/systemd/system/polkadot-node-iot.service
```

é…ç½®ç³»ç»Ÿ d:

```
**$** sudo systemctl daemon-reload
```

å¯åŠ¨æ—¶å¯ç”¨æœåŠ¡è‡ªåŠ¨å¯åŠ¨:

```
**$** sudo systemctl enable polkadot-node-iot.service
```

> æˆ‘ä»¬çš„æ— æœåŠ¡å™¨æ•…éšœè½¬ç§»è§£å†³æ–¹æ¡ˆå·²ç»å®Œæˆï¼ï¼ğŸŠ ğŸ‰

æ¯å½“æˆ‘ä»¬çš„ä¸»èŠ‚ç‚¹æ–­å¼€è¿æ¥æˆ– polkadot-validator.service å…³é—­æ—¶ï¼›æˆ‘ä»¬çš„æ— æœåŠ¡å™¨åŸºç¡€è®¾æ–½å°†è´Ÿè´£ç®¡ç†è¾…åŠ©éªŒè¯å™¨ã€‚

å…³æ³¨ **Github** repoï¼Œäº†è§£æ›´å¤šé«˜çº§è§£å†³æ–¹æ¡ˆçš„æœ€æ–°æˆæœã€‚

github:*T15[https://github.com/riusricardo/validator-failover](https://github.com/riusricardo/validator-failover)*