# å¦‚ä½•åšä¸€ä¸ªåƒ WhatsApp ä¸€æ ·çš„ä¸ªäººèŠå¤©åº”ç”¨

> åŸæ–‡ï¼š<https://medium.com/hackernoon/how-to-make-a-personal-chat-application-like-whatsapp-fda6dd4bcb5b>

è®©æˆ‘ä»¬åˆ¶ä½œä¸€ä¸ªåƒ WhatsApp ä¸€æ ·çš„ä¸ªäººåŒ–ã€å®‰å…¨çš„ android åº”ç”¨ç¨‹åºğŸ˜ã€‚

ä½ ç”¨**WhatsApp/Facebook Messenger**å—ï¼Ÿä½ å¯¹ **Java æˆ–è€…å®‰å“**æ„Ÿå…´è¶£å—ï¼Ÿä½ æœ‰å…´è¶£åšä¸€ä¸ªåƒ WhatsApp è¿™æ ·çš„ä¸ªäººèŠå¤©åº”ç”¨å—ï¼Ÿ

å¦‚æœæ˜¯ï¼Œé‚£ä¹ˆä½ å°±åœ¨**å®Œç¾åœ°ç‚¹**ã€‚

![](img/61e942f2011a3ecd3233494cfb024491.png)

Personal Messaging app

è¿™å°†æ˜¯ä½ è‡ªå·±çš„åº”ç”¨ï¼Œæ²¡æœ‰å¹¿å‘Šï¼Œæ²¡æœ‰éšç§é—®é¢˜ï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰ã€‚ä½ å‡ ä¹å¯ä»¥å®Œå…¨æ§åˆ¶ T8ã€‚

å› æ­¤ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å°†å­¦ä¹ åˆ¶ä½œä¸€ä¸ªç®€å•çš„èŠå¤©åº”ç”¨ç¨‹åºï¼Œå®ƒå…·æœ‰ç™»å½•/æ³¨å†ŒåŠŸèƒ½å’ŒèŠå¤©æ¶ˆæ¯å®ç°åŠŸèƒ½ï¼Œä½ å¯ä»¥å‘é€èŠå¤©æ¶ˆæ¯ä¸ä½ çš„æœ‹å‹èŠå¤©ã€‚

ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨**Firebase-real time-Database**ä½œä¸ºåç«¯æ¥å­˜å‚¨èŠå¤©è®°å½•å¹¶å°†å…¶å‘é€åˆ°å…¶ä»–è®¾å¤‡ã€‚

ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°è¿™ä¸ªåº”ç”¨çš„å…¨éƒ¨ä»£ç ã€‚

é¦–å…ˆï¼Œè®©æˆ‘ä»¬ç”¨ä¸€ä¸ªç®€å•çš„æµç¨‹å›¾æ¥ç†è§£æˆ‘ä»¬çš„åº”ç”¨**ï¼Œå¦‚æœæˆ‘ä»¬åœ¨æŸä¸€ç‚¹ä¸Šé‡åˆ°å›°éš¾ï¼Œè¿™å°†å¸®åŠ©æˆ‘ä»¬ã€‚**

æˆ‘ä»¬çš„ android åº”ç”¨ç¨‹åºâ†’ç”¨æˆ·æ³¨å†Œæˆ–ç™»å½•â†’ç”¨æˆ·å¯ä»¥é€‰æ‹©ä»–æƒ³è¦å‘é€æ¶ˆæ¯ç»™çš„æœ‹å‹â†’ç”¨æˆ·å¯ä»¥é”®å…¥å¹¶å‘é€æ¶ˆæ¯â†’æœ‹å‹å°†åœ¨ä»–çš„è®¾å¤‡ä¸Šæ¥æ”¶æ¶ˆæ¯ã€‚

åœ¨å†…éƒ¨ï¼Œæˆ‘ä»¬å°†æ¶ˆæ¯å­˜å‚¨åœ¨æˆ‘ä»¬çš„æ•°æ®åº“ä¸­ï¼Œç„¶åå‘é€ç»™æœŸæœ›çš„ç”¨æˆ·ã€‚

è¿™æ˜¯ä¸€ä¸ª**æ¼”ç¤ºç”¨é€”çš„åº”ç”¨**ï¼Œæ‰€ä»¥æˆ‘ä»¬åªä¼šåšè¿™ä¹ˆå¤šã€‚ä½†æ˜¯ä½ å¯ä»¥åœ¨åº”ç”¨ç¨‹åºä¸­æ·»åŠ æ›´å¤šæ›´é…·çš„æ–¹é¢ï¼Œä¸€æ—¦ä½ å®Œæˆäº†è¿™äº›ã€‚

Firebase æä¾›äº†å¤§é‡ä»¤äººæƒŠå¹çš„å·¥å…·ï¼Œä½ å¯ä»¥åœ¨ä½ çš„åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ï¼Œæ¯”å¦‚ **ML å·¥å…·åŒ…ã€å®æ—¶é€šçŸ¥ç­‰ç­‰**ã€‚

# **è®¾ç½®ç‡ƒçƒ§åŸº**

é¦–å…ˆåˆ›å»ºä¸€ä¸ª firebase è´¦å·ã€‚éµå¾ªä»¥ä¸‹æ­¥éª¤:

è¿™é‡Œçš„åå­—æ˜¯ä¸ºäº†æ¼”ç¤ºçš„ç›®çš„ï¼Œä½ å¯ä»¥ä½¿ç”¨ä»»ä½•ä½ æƒ³è¦çš„åå­—æˆ–å¤´è¡”ï¼Œéšä½ ä¾¿ã€‚

1.  ä» [**è¿™ä¸ªé“¾æ¥**](https://firebase.google.com) è¿›å…¥ firebase ç½‘ç«™ï¼Œåˆ›å»ºä¸€ä¸ª Firebase è´¦å·å¼€å§‹ã€‚è½¬åˆ° Firebase æ§åˆ¶å°ï¼Œç‚¹å‡»â€œ**åˆ›å»ºæ–°é¡¹ç›®**â€æŒ‰é’®åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚

![](img/95abd2c7fe462c1a62b4c5a6caf18112.png)

Firebase

2.ç»™å‡ºé¡¹ç›®åç§°å’Œæ‚¨å½“å‰æ‰€åœ¨çš„å›½å®¶ï¼Œå®Œæˆåç‚¹å‡»â€œ**åˆ›å»ºé¡¹ç›®**â€æŒ‰é’®ã€‚

![](img/dea522caf97962dc1e40d74b2ea7561b.png)

Project

3.åœ¨ä¸‹ä¸€ä¸ªå±å¹•ä¸­ï¼Œé€‰æ‹©â€œå°† Firebase æ·»åŠ åˆ°æ‚¨çš„ Android åº”ç”¨ç¨‹åºâ€ï¼Œç„¶åæ·»åŠ åŒ…ç»†èŠ‚å’Œè°ƒè¯•ç­¾åè¯ä¹¦ SHA-1 å¯†é’¥(å¦‚æœæ‚¨æƒ³è¦å¯ç”¨æŸäº›åŠŸèƒ½ï¼Œå¦‚åŠ¨æ€é“¾æ¥ã€é‚€è¯·å’Œè°·æ­Œç™»å½•ç­‰ï¼Œè¿™æ˜¯å¿…éœ€çš„)ã€‚å¦åˆ™å®ƒæ˜¯å¯é€‰å­—æ®µ)ã€‚

![](img/5e6a85a9ccfb8d92f75b5f8a22ddae85.png)

Android chatting app

è¿™å°†ä¸‹è½½ google-services.json æ–‡ä»¶ã€‚ä¸‹è½½åˆ°ä½ çš„ç”µè„‘ä¸Šã€‚æˆ‘ä»¬ç¨åä¼šå°†å®ƒæ·»åŠ åˆ°æˆ‘ä»¬çš„ android åº”ç”¨ç¨‹åºä¸­ã€‚

è¿™æ˜¯å¿…éœ€çš„ï¼Œå› ä¸º Android Firebase çš„é»˜è®¤å®‰å…¨è§„åˆ™åªå…è®¸ç»è¿‡èº«ä»½éªŒè¯çš„ç”¨æˆ·è¯»å†™ã€‚

ç„¶åå•å‡» Firebase èœå•ä¸­çš„ Database é€‰é¡¹å¡ã€‚

å®ƒæ˜¾ç¤ºäº† **JSON æ ‘**çš„æ ¹ï¼Œæˆ‘ä»¬å°†æ·»åŠ ä¸€ä¸ªåä¸º listItems çš„å­èŠ‚ç‚¹ï¼Œç„¶åå°†åœ¨å®ƒä¸‹é¢æ·»åŠ æ¯ä¸ªé¡¹ç›®ã€‚

å½“æˆ‘ä»¬å‘ JSON æ ‘ä¸­æ·»åŠ æ•°æ®æ—¶ï¼Œå®ƒå°†æˆä¸ºç°æœ‰ JSON ç»“æ„ä¸­çš„ä¸€ä¸ªæ–°èŠ‚ç‚¹ï¼Œå¹¶å¸¦æœ‰ä¸€ä¸ªç›¸å…³çš„é”®ã€‚

å¦å¤–**å¤åˆ¶æ•°æ®åº“çš„ URL**ã€‚åˆ«å¿˜äº†åœ¨ä¸‹é¢çš„ä»£ç ä¸­ä¿®æ”¹å®ƒä»¬ã€‚

æ‚¨å¯ä»¥æ£€æŸ¥ Rules é€‰é¡¹å¡ï¼ŒæŸ¥çœ‹æˆ–æ›´æ”¹åœ¨ Android Firebase æ•°æ®åº“ä¸Šè¯»å†™çš„å®‰å…¨è§„åˆ™ã€‚ä¸‹å›¾æ˜¾ç¤ºäº†é»˜è®¤è®¾ç½®ã€‚

![](img/2b76b0472aa87964f47030bdb6e7b2ee.png)

Firebase rules

å¦‚æœæ‚¨å¸Œæœ›å¯¹ Firebase è¿›è¡Œè‡ªç”±çš„æœªç»éªŒè¯çš„è®¿é—®ï¼Œæ‚¨å¯ä»¥å°†è¿™äº›è®¾ç½®æ›´æ”¹ä¸º trueã€‚

ä¸€æ—¦ä½ å®Œæˆäº†è¿™äº›ï¼Œè®©æˆ‘ä»¬åˆ›å»ºæˆ‘ä»¬çš„ **Android èŠå¤©åº”ç”¨**ï¼Œå®ƒå°†è¿æ¥åˆ°æˆ‘ä»¬åˆšåˆšåˆ›å»ºçš„ **Firebase æ•°æ®åº“**ã€‚

æ—¢ç„¶æˆ‘ä»¬å‡ ä¹å·²ç»å®Œæˆäº† Firebase çš„è®¾ç½®ï¼Œè®©æˆ‘ä»¬æ·±å…¥ä¸€äº› android ä»£ç ã€‚

é¦–å…ˆåƒ android studio ä¸€æ ·åœ¨ä½ çš„ IDE ä¸­åšä¸€ä¸ª**æ–°çš„ Android é¡¹ç›®ï¼Œå¹¶å°†ä½ çš„ç¬¬ä¸€ä¸ªæ´»åŠ¨å‘½åä¸º Registerã€‚**

ä¸ç”¨è¯´ï¼Œæˆ‘ä»¬è¿™æ ·å‘½åè¿™ä¸ªæ´»åŠ¨ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨åº”ç”¨ç¨‹åºä¸­æœ‰æ›´å¤šçš„**æ´»åŠ¨**å…·æœ‰ä¸åŒçš„åŠŸèƒ½ã€‚

å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ°æ‚¨çš„**æ³¨å†Œ**æ´»åŠ¨ä¸­ã€‚

```
public class Register extends AppCompatActivity {
    EditText username, password;
    Button registerButton;
    String user, pass;
    TextView login;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_register);

        username = (EditText)findViewById(R.id.username);
        password = (EditText)findViewById(R.id.password);
        registerButton = (Button)findViewById(R.id.registerButton);
        login = (TextView)findViewById(R.id.login);

        Firebase.*setAndroidContext*(this);

        login.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                startActivity(new Intent(Register.this, Login.class));
            }
        });

        registerButton.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                user = username.getText().toString();
                pass = password.getText().toString();

                if(user.equals("")){
                    username.setError("can't be blank");
                }
                else if(pass.equals("")){
                    password.setError("can't be blank");
                }
                else if(!user.matches("[A-Za-z0-9]+")){
                    username.setError("only alphabet or number allowed");
                }
                else if(user.length()<5){
                    username.setError("at least 5 characters long");
                }
                else if(pass.length()<5){
                    password.setError("at least 5 characters long");
                }
                else {
                    final ProgressDialog pd = new ProgressDialog(Register.this);
                    pd.setMessage("Loading...");
                    pd.show();

                    String url = "https://chatapp-60323.firebaseio.com/users.json";

                    StringRequest request = new StringRequest(Request.Method.*GET*, url, new Response.Listener<String>(){
                        @Override
                        public void onResponse(String s) {
                            Firebase reference = new Firebase("https://chatapp-60323.firebaseio.com/users");

                            if(s.equals("null")) {
                                reference.child(user).child("password").setValue(pass);
                                Toast.*makeText*(Register.this, "registration successful", Toast.*LENGTH_LONG*).show();
                            }
                            else {
                                try {
                                    JSONObject obj = new JSONObject(s);

                                    if (!obj.has(user)) {
                                        reference.child(user).child("password").setValue(pass);
                                        Toast.*makeText*(Register.this, "registration successful", Toast.*LENGTH_LONG*).show();
                                    } else {
                                        Toast.*makeText*(Register.this, "username already exists", Toast.*LENGTH_LONG*).show();
                                    }

                                } catch (JSONException e) {
                                    e.printStackTrace();
                                }
                            }

                            pd.dismiss();
                        }

                    },new Response.ErrorListener(){
                        @Override
                        public void onErrorResponse(VolleyError volleyError) {
                            System.*out*.println("" + volleyError );
                            pd.dismiss();
                        }
                    });

                    RequestQueue rQueue = Volley.*newRequestQueue*(Register.this);
                    rQueue.add(request);
                }
            }
        });
    }
}
```

è¿™æ®µä»£ç è®¾ç½®æ‚¨åœ¨ firebase æ•°æ®åº“ä¸­çš„æ³¨å†Œã€‚

æ­£å¦‚ä½ å¯èƒ½æƒ³çŸ¥é“çš„é‚£æ ·ï¼Œ **Firebase æ•°æ®åº“æ˜¯ä¸€ä¸ª NoSQL** ,æœ¬è´¨ä¸Šæ„å‘³ç€ï¼Œä½ ä¸éœ€è¦ä½¿ç”¨ SQL æŸ¥è¯¢ä¸œè¥¿ã€‚

Firebase ä½¿ç”¨å¼•ç”¨æ–¹æ³•æ¥æ£€ç´¢å’Œæ”¾ç½®å€¼ã€‚

å› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»å†³å®šä»€ä¹ˆå’Œå¦‚ä½•ä½¿æˆ‘ä»¬çš„æ•°æ®åº“ç»“æ„ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬è¿˜å°†è®©ç”¨æˆ·æ³¨å†Œå¹¶ä½¿ç”¨è‡ªå®šä¹‰ç”¨æˆ·åå’Œå¯†ç ç™»å½•ï¼Œå› æ­¤æˆ‘ä»¬ä¹Ÿè¦è®°ä½è¿™ä¸€ç‚¹ã€‚

æˆ‘ä¸ºè¿™ä¸ªåº”ç”¨ç¨‹åºè®¾è®¡çš„æ•°æ®åº“ç»“æ„æ˜¯åŸºäºç®€å•æ€§ã€‚æˆ‘ä»¬å°†èº«ä»½éªŒè¯ç»†èŠ‚ä¿å­˜åœ¨åä¸ºâ€œusersâ€çš„çˆ¶èŠ‚ç‚¹ä¸­ï¼Œå°†æ¶ˆæ¯ä¿å­˜åœ¨å¦ä¸€ä¸ªåä¸ºâ€œmessagesâ€çš„çˆ¶èŠ‚ç‚¹ä¸­ã€‚

åœ¨å†…éƒ¨æ¶ˆæ¯ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿé€šè¿‡ç”¨æˆ·åçš„é¡ºåºæ¥è·Ÿè¸ªè°ç»™è°å‘äº†æ¶ˆæ¯ã€‚

æ‰€ä»¥åœ¨å›¾åƒä¸­ï¼Œ**è¿™ä¸ªç»“æ„çœ‹èµ·æ¥å°±åƒè¿™ä¸ª**ä¸€æ ·ã€‚

> **ç”¨äºè®¤è¯:**

![](img/21f7c6685850910bd1eac43b839cd995.png)

Users database structure

> **ç”¨äºæ¶ˆæ¯ä¼ é€’:**

![](img/427314955733420ca41358261980349a.png)

Messages database structure

è¯·è®°ä½ï¼Œ**è¿™æ˜¯ä¸€ä¸ªç”¨äºæ•™ç¨‹ç›®çš„çš„æ¼”ç¤ºåº”ç”¨**ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œæˆ‘æ²¡æœ‰ä½¿ç”¨ä»»ä½•æ–¹æ³•æ¥ä¿æŒè¿™ä¸ªå®‰å…¨ã€‚ä½†æ˜¯ä½¿ç”¨ Firebase å¯ä»¥ä½¿å®ƒå˜å¾—éå¸¸å®‰å…¨ï¼Œä½ å¯ä»¥åœ¨è‡ªå·±å®Œæˆæ„å»ºä¹‹åå†è¿™æ ·åšã€‚

è®©æˆ‘ä»¬å†æ¬¡å›åˆ°æˆ‘ä»¬çš„ android ä»£ç ã€‚æ‰€ä»¥æ˜¯çš„ï¼Œé”™è¯¯ã€‚

åœ¨ register æ´»åŠ¨ä¸­æ·»åŠ ä»£ç åï¼Œæ‚¨æ˜¯å¦åœ¨é¡¹ç›®ä¸­çœ‹åˆ°äº†é”™è¯¯å’Œå¤§é‡çº¢çº¿ï¼Ÿ

åˆ«æ‹…å¿ƒï¼Œæˆ‘ä¸æ˜¯åœ¨ç‚«è€€ä»€ä¹ˆã€‚é”™è¯¯å°†ä¼šæ¶ˆå¤±ã€‚

é¦–å…ˆè®©æˆ‘ä»¬æ·»åŠ æˆ‘ä»¬çš„**ä¾èµ–å…³ç³»**ã€‚ä½ å¯èƒ½è¿˜æƒ³å°†ä½ çš„åº”ç”¨ç¨‹åºè¿æ¥åˆ°ä½ åˆ›å»ºçš„ firebase å¸æˆ·ã€‚

è¦å°†å…¶è¿æ¥åˆ°æ‚¨çš„ firebase é¡¹ç›®ï¼Œ**è¿›å…¥å·¥å…·â†’ Firebase â†’å®æ—¶æ•°æ®åº“â†’ä¿å­˜å’Œæ£€ç´¢æ•°æ®â†’å°†æ‚¨çš„åº”ç”¨ç¨‹åºè¿æ¥åˆ° Firebaseã€‚**

åªéœ€å†æ¬¡ç™»å½•å¹¶é€‰æ‹©æ‚¨çš„é¡¹ç›®ï¼Œå®ƒåº”è¯¥ä¼šè¿æ¥ã€‚æ‚¨å¯èƒ½è¿˜æƒ³åœ¨åŒä¸€ä¸ªé€‰é¡¹å¡ä¸­æ‰§è¡Œå…¶ä»–æ­¥éª¤ï¼Œä¾‹å¦‚å°†æ•°æ®åº“æ·»åŠ åˆ°æ‚¨çš„åº”ç”¨ç¨‹åºä¸­ã€‚

æˆ–è€…ï¼Œä½ å¯ä»¥åªå¤åˆ¶ç²˜è´´**è¿™äº›ä¾èµ–é›†**åœ¨ä½ çš„é¡¹ç›®çš„æ¨¡å— app ä¸­ã€‚

```
dependencies {
    implementation fileTree(dir: 'libs', include: ['*.jar'])
    implementation 'com.android.support:appcompat-v7:28.0.0'
    implementation 'com.firebase:firebase-client-android:2.5.2'
    implementation 'com.android.volley:volley:1.0.0'
    implementation 'com.android.support.constraint:constraint-layout:1.1.3'
    implementation 'com.google.firebase:firebase-database:16.0.5'
    implementation 'com.google.firebase:firebase-auth:16.1.0'
    testImplementation 'junit:junit:4.12'
    androidTestImplementation 'com.android.support.test:runner:1.0.2'
    androidTestImplementation 'com.android.support.test.espresso:espresso-core:3.0.2'
}
```

ç°åœ¨ï¼Œ**åªè¦åœ¨é”™è¯¯ä¸ŠæŒ‰ alt+Enterï¼Œå¤§å¤šæ•°é”™è¯¯å°±ä¼šæ¶ˆå¤±**ã€‚éšç€æˆ‘ä»¬çš„è¿›å±•ï¼Œå…¶ä»–äººä¹Ÿä¼šè¿™æ ·åšã€‚

è®©æˆ‘ä»¬æ·»åŠ **ç™»å½•**æ´»åŠ¨ä»£ç ï¼Œçœ‹èµ·æ¥åƒè¿™æ ·:

```
public class Login extends AppCompatActivity {
    TextView registerUser;
    EditText username, password;
    Button loginButton;
    String user, pass;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_login);

        registerUser = findViewById(R.id.register);
        username = findViewById(R.id.username);
        password = findViewById(R.id.password);
        loginButton = findViewById(R.id.loginButton);

        registerUser.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                startActivity(new Intent(Login.this, Register.class));
            }
        });

        loginButton.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                user = username.getText().toString();
                pass = password.getText().toString();

                if(user.equals("")){
                    username.setError("can't be blank");
                }
                else if(pass.equals("")){
                    password.setError("can't be blank");
                }
                else{
                    String url = "https://chatapp-60323.firebaseio.com/users.json";
                    final ProgressDialog pd = new ProgressDialog(Login.this);
                    pd.setMessage("Loading...");
                    pd.show();

                    StringRequest request = new StringRequest(Request.Method.*GET*, url, new Response.Listener<String>(){
                        @Override
                        public void onResponse(String s) {
                            if(s.equals("null")){
                                Toast.*makeText*(Login.this, "user not found", Toast.*LENGTH_LONG*).show();
                            }
                            else{
                                try {
                                    JSONObject obj = new JSONObject(s);

                                    if(!obj.has(user)){
                                        Toast.*makeText*(Login.this, "user not found", Toast.*LENGTH_LONG*).show();
                                    }
                                    else if(obj.getJSONObject(user).getString("password").equals(pass)){
                                        UserDetails.*username* = user;
                                        UserDetails.*password* = pass;
                                        startActivity(new Intent(Login.this, Users.class));
                                    }
                                    else {
                                        Toast.*makeText*(Login.this, "incorrect password", Toast.*LENGTH_LONG*).show();
                                    }
                                } catch (JSONException e) {
                                    e.printStackTrace();
                                }
                            }

                            pd.dismiss();
                        }
                    },new Response.ErrorListener(){
                        @Override
                        public void onErrorResponse(VolleyError volleyError) {
                            System.*out*.println("" + volleyError);
                            pd.dismiss();
                        }
                    });

                    RequestQueue rQueue = Volley.*newRequestQueue*(Login.this);
                    rQueue.add(request);
                }

            }
        });
    }
}
```

æˆ‘ä»¬ç°åœ¨è¿˜å¯ä»¥æ·»åŠ æˆ‘ä»¬çš„**èŠå¤©**æ´»åŠ¨ä»£ç ï¼Œè¿™å°†æ˜¯èŠå¤©è¢«çœ‹åˆ°çš„åœ°æ–¹ã€‚

```
public class Chat extends AppCompatActivity {
    LinearLayout layout;
    RelativeLayout layout_2;
    ImageView sendButton;
    EditText messageArea;
    ScrollView scrollView;
    Firebase reference1, reference2;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_chat);

        layout = findViewById(R.id.layout1);
        layout_2 = findViewById(R.id.layout2);
        sendButton = findViewById(R.id.sendButton);
        messageArea = findViewById(R.id.messageArea);
        scrollView = findViewById(R.id.scrollView);

        Firebase.*setAndroidContext*(this);
        reference1 = new Firebase("https://chatapp-60323.firebaseio.com/messages/" + UserDetails.*username* + "_" + UserDetails.*chatWith*);
        reference2 = new Firebase("https://chatapp-60323.firebaseio.com/messages/" + UserDetails.*chatWith* + "_" + UserDetails.*username*);

        sendButton.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                String messageText = messageArea.getText().toString();

                if(!messageText.equals("")){
                    Map<String, String> map = new HashMap<String, String>();
                    map.put("message", messageText);
                    map.put("user", UserDetails.*username*);
                    reference1.push().setValue(map);
                    reference2.push().setValue(map);
                    messageArea.setText("");
                }
            }
        });

        reference1.addChildEventListener(new ChildEventListener() {
            @Override
            public void onChildAdded(DataSnapshot dataSnapshot, String s) {
                Map map = dataSnapshot.getValue(Map.class);
                String message = map.get("message").toString();
                String userName = map.get("user").toString();

                if(userName.equals(UserDetails.*username*)){
                    addMessageBox(message, 1);
                }
                else{
                    addMessageBox(message, 2);
                }
            }

            @Override
            public void onChildChanged(DataSnapshot dataSnapshot, String s) {

            }

            @Override
            public void onChildRemoved(DataSnapshot dataSnapshot) {

            }

            @Override
            public void onChildMoved(DataSnapshot dataSnapshot, String s) {

            }

            @Override
            public void onCancelled(FirebaseError firebaseError) {

            }
        });
    }

    public void addMessageBox(String message, int type){
        TextView textView = new TextView(Chat.this);
        textView.setText(message);

        LinearLayout.LayoutParams lp2 = new LinearLayout.LayoutParams(ViewGroup.LayoutParams.*WRAP_CONTENT*, ViewGroup.LayoutParams.*WRAP_CONTENT*);
        lp2.weight = 7.0f;

        if(type == 1) {
            lp2.gravity = Gravity.*LEFT*;
            textView.setBackgroundResource(R.drawable.bubble_in);
        }
        else{
            lp2.gravity = Gravity.*RIGHT*;
            textView.setBackgroundResource(R.drawable.bubble_out);
        }
        textView.setLayoutParams(lp2);
        layout.addView(textView);
        scrollView.fullScroll(View.*FOCUS_DOWN*);
    }
}
```

æ­¤å¤–ï¼Œåœ¨è¯¥æ´»åŠ¨ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°è¯¥åº”ç”¨ç¨‹åºçš„**ç”¨æˆ·**åˆ—è¡¨ã€‚

```
public class Users extends AppCompatActivity {
    ListView usersList;
    TextView noUsersText;
    ArrayList<String> al = new ArrayList<>();
    int totalUsers = 0;
    ProgressDialog pd;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_users);

        usersList = (ListView)findViewById(R.id.usersList);
        noUsersText = (TextView)findViewById(R.id.noUsersText);

        pd = new ProgressDialog(Users.this);
        pd.setMessage("Loading...");
        pd.show();

        String url = "https://chatapp-60323.firebaseio.com/users.json";

        StringRequest request = new StringRequest(Request.Method.*GET*, url, new Response.Listener<String>(){
            @Override
            public void onResponse(String s) {
                doOnSuccess(s);
            }
        },new Response.ErrorListener(){
            @Override
            public void onErrorResponse(VolleyError volleyError) {
                System.*out*.println("" + volleyError);
            }
        });

        RequestQueue rQueue = Volley.*newRequestQueue*(Users.this);
        rQueue.add(request);

        usersList.setOnItemClickListener(new AdapterView.OnItemClickListener() {
            @Override
            public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
                UserDetails.*chatWith* = al.get(position);
                startActivity(new Intent(Users.this, Chat.class));
            }
        });
    }

    public void doOnSuccess(String s){
        try {
            JSONObject obj = new JSONObject(s);

            Iterator i = obj.keys();
            String key = "";

            while(i.hasNext()){
                key = i.next().toString();

                if(!key.equals(UserDetails.*username*)) {
                    al.add(key);
                }

                totalUsers++;
            }

        } catch (JSONException e) {
            e.printStackTrace();
        }

        if(totalUsers <=1){
            noUsersText.setVisibility(View.*VISIBLE*);
            usersList.setVisibility(View.*GONE*);
        }
        else{
            noUsersText.setVisibility(View.*GONE*);
            usersList.setVisibility(View.*VISIBLE*);
            usersList.setAdapter(new ArrayAdapter<String>(this, android.R.layout.*simple_list_item_1*, al));
        }

        pd.dismiss();
    }
}
```

ç°åœ¨è®©æˆ‘ä»¬åˆ¶ä½œä¸€ä¸ª**ç®€å•çš„ Java** ç±»æ¥å¸®åŠ©ä»¥æ›´å¥½çš„æ–¹å¼è·å–ç»†èŠ‚ï¼Œå³:

```
public class UserDetails {
    static String *username* = "";
    static String *password* = "";
    static String *chatWith* = "";
}
```

æ˜¯çš„ï¼Œæˆ‘ä»¬éƒ½å®Œæˆäº†æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºâ€¦

å“¦ï¼Œç­‰ç­‰ï¼Œä½ è¿˜æ˜¯ä¼šå‡ºé”™ï¼Ÿ

è¿™ä¸åº”è¯¥å‘ç”Ÿï¼Œæˆ‘ä¸çŸ¥é“å“ªé‡Œå‡ºé”™äº†â€¦

ä¸ï¼Œåªæ˜¯å¼€ç©ç¬‘ğŸ˜†

æˆ‘ä»¬è¿˜æ²¡æœ‰æ·»åŠ  UI ä»£ç ï¼Œè¿™ä¹Ÿå¯èƒ½æ˜¯é”™è¯¯çš„é™ˆè¿°ã€‚

æ‰€ä»¥è®©æˆ‘ä»¬å…ˆä¸º register æ´»åŠ¨æ·»åŠ  **UI ä»£ç ã€‚**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@drawable/back"
    android:paddingBottom="@dimen/activity_vertical_margin"
    android:paddingLeft="@dimen/activity_horizontal_margin"
    android:paddingRight="@dimen/activity_horizontal_margin"
    android:paddingTop="@dimen/activity_vertical_margin"
    tools:context="com.pd.chatapp.Register"
    android:orientation="vertical"
    android:gravity="center">

    <TextView
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="@string/register"
        android:textSize="30sp"
        android:gravity="center"
        android:layout_marginBottom="20dp"/>

    <EditText
        android:id="@+id/username"
        android:layout_width="365dp"
        android:layout_height="49dp"
        android:layout_marginBottom="10dp"
        android:background="#000000"
        android:hint="@string/enter_username"
        android:inputType="text"
        android:maxLines="1"
        android:textColor="#ffffff" />

    <EditText
        android:id="@+id/password"
        android:layout_width="363dp"
        android:layout_height="50dp"
        android:layout_marginBottom="10dp"
        android:background="#000000"
        android:hint="@string/enter_password"
        android:inputType="textPassword"
        android:maxLines="1"
        android:textColor="#ffffff" />

    <Button
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="@string/register"
        android:id="@+id/registerButton"
        android:layout_marginBottom="20dp"/>

    <TextView
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="@string/click_here_to_login"
        android:textSize="20sp"
        android:gravity="center"
        android:id="@+id/login"/>

</LinearLayout>
```

å‚åŠ **èŠå¤©**æ´»åŠ¨ã€‚

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@drawable/back"
    android:paddingBottom="@dimen/activity_vertical_margin"
    android:paddingLeft="@dimen/activity_horizontal_margin"
    android:paddingRight="@dimen/activity_horizontal_margin"
    android:paddingTop="@dimen/activity_vertical_margin"
    android:orientation="vertical"
    tools:context="com.pd.chatapp.Chat">

    <ScrollView
        android:layout_width="match_parent"
        android:layout_weight="20"
        android:layout_height="0dp"
        android:id="@+id/scrollView">
        <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
            android:id="@+id/layout2"
            android:layout_width="match_parent"
            android:layout_height="wrap_content">
            <LinearLayout
                android:layout_width="match_parent"
                android:layout_height="wrap_content"
                android:orientation="vertical"
                android:id="@+id/layout1">
            </LinearLayout>
        </RelativeLayout>
    </ScrollView>

    <include
        layout="@layout/message_place"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:gravity="bottom"
        android:layout_marginTop="5dp"/>
</LinearLayout>
```

ä¹Ÿä¸ºäº†æˆ‘ä»¬çš„**ç™»å½•**æ´»åŠ¨ã€‚

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:paddingBottom="@dimen/activity_vertical_margin"
    android:paddingLeft="@dimen/activity_horizontal_margin"
    android:paddingRight="@dimen/activity_horizontal_margin"
    android:background="@drawable/back"
    android:paddingTop="@dimen/activity_vertical_margin"
    tools:context="com.pd.chatapp.Login"
    android:orientation="vertical"
    android:gravity="center">

    <TextView
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_marginBottom="20dp"
        android:gravity="center"
        android:text="@string/login"
        android:textSize="30sp" />

    <EditText
        android:id="@+id/username"
        android:layout_width="362dp"
        android:layout_height="49dp"
        android:layout_marginBottom="10dp"
        android:background="#000000"
        android:hint="@string/enter_username"
        android:inputType="text"
        android:maxLines="1"
        android:textColor="#ffffff" />

    <EditText
        android:id="@+id/password"
        android:layout_width="358dp"
        android:layout_height="49dp"
        android:layout_marginBottom="10dp"
        android:background="#000000"
        android:hint="@string/enter_password"
        android:inputType="textPassword"
        android:maxLines="1"
        android:textColor="#ffffff" />

    <Button
        android:id="@+id/loginButton"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_marginBottom="20dp"
        android:text="@string/login" />

    <TextView
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="@string/click_here_to_register"
        android:textSize="20sp"
        android:gravity="center"
        android:id="@+id/register"/>

</LinearLayout>
```

è¿˜æœ‰åˆ«å¿˜äº†**ç”¨æˆ·ä½**æ´»åŠ¨ã€‚

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:paddingBottom="@dimen/activity_vertical_margin"
    android:paddingLeft="@dimen/activity_horizontal_margin"
    android:paddingRight="@dimen/activity_horizontal_margin"
    android:paddingTop="@dimen/activity_vertical_margin"
    tools:context="com.pd.chatapp.Users"
    android:orientation="vertical">

    <TextView
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="@string/no_users_found"
        android:id="@+id/noUsersText"
        android:visibility="gone"/>

    <ListView
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:id="@+id/usersList"/>
</LinearLayout>
```

åŒæ ·ä¸ºäº†æ›´å¥½çš„è§‚çœ‹ï¼Œæˆ‘ä»¬åœ¨ä¸€ä¸ªä¸åŒçš„å¸ƒå±€æ–‡ä»¶ä¸­åˆ¶ä½œäº†æ¶ˆæ¯åŒºåŸŸã€‚å› æ­¤ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„ xml æ–‡ä»¶ï¼Œåä¸º **message_place.xml** ã€‚

å¹¶å‘å…¶ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç ã€‚

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:gravity="bottom"
    android:orientation="horizontal">

    <EditText
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:textColorHint="#CFD8DC"
        android:textColor="#CFD8DC"
        android:hint="@string/write_a_message"
        android:id="@+id/messageArea"
        android:maxHeight="80dp"
        />

    <ImageView
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_weight="4"
        android:padding="4dp"
        android:src="@android:drawable/ic_menu_send"
        android:id="@+id/sendButton"/>
</LinearLayout>
```

**ä»€ä¹ˆï¼Ÿä½ ä»ç„¶å¾—åˆ°ä¸€äº›é”™è¯¯ï¼Ÿ**

ä¸è¦æ‹…å¿ƒï¼Œé‚£æ˜¯å› ä¸ºä½ é—æ¼äº†èƒŒæ™¯å’Œæˆ‘ä»¬ä½¿ç”¨è¿‡çš„å…¶ä»–å›¾åƒæˆ–èµ„æºã€‚ä½ å¯ä»¥åœ¨æˆ‘çš„ GitHub è´¦æˆ·åº“ä¸­æ‰¾åˆ°å®ƒä»¬ã€‚

[**app çš„æºä»£ç **ã€‚](https://github.com/Pradyuman7/LetsChat)

åœ°ç‹±ï¼Œæ˜¯çš„ï¼ç°åœ¨**æˆ‘ä»¬çœŸçš„å®Œå…¨å®Œæˆäº†**ã€‚å®Œå…¨å®Œæˆçš„åº”ç”¨ç¨‹åºåº”è¯¥ä¼šå‡ºç°è¿™æ ·çš„å±å¹•:

![](img/fdc3c1dc1e24c1e7d64644d81741138c.png)

Android app

è®©ä¸€åˆ‡**éƒ½å€¼å¾—åŠªåŠ›**ï¼Œå¯¹å—ï¼Ÿ

ç°åœ¨ä½ è¿˜åœ¨ç­‰ä»€ä¹ˆï¼Ÿ**ä½¿ç”¨è‡ªå·±çš„åº”ç”¨ç¨‹åº**ä¸æœ‹å‹èŠå¤©ã€‚

**å»ç‚«è€€å§ï¼ï¼**

[**é˜…è¯»æˆ‘ä¹‹å‰çš„å¸–å­ï¼Œå…³äºä»å¤´å¼€å§‹åˆ¶ä½œä¸€ä¸ªæœºå™¨å­¦ä¹  android æ¸¸æˆã€‚**](https://hackernoon.com/how-to-make-a-machine-learning-android-game-from-scratch-82d9406a7635)